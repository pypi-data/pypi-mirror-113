(()=>{"use strict";var e,t,r,n={77955:(e,t,r)=>{var n=r(32735),a=r(12788),s=r(53514),i=r(70242),l=r(33348),o=r.n(l),c=r(59090);const u="SET_KEYWORD",d="SET_FILTER",p="SET_PAGE",m="UPDATE_ENTRIES",g="FETCH_STARTED",h="FETCH_FAILED",y="SET_DETAILED_VIEW",E="SET_METADATA_QUERY";function f(e){return{type:p,currentPage:e}}function b(e){return{type:y,currentViewIndex:e}}function v(e){return{type:E,metadataQuery:e}}function w(){return async(e,t)=>{e({type:g});const{logs:{filters:r,keyword:n,currentPage:a,metadataQuery:s},staticData:{fetchLogsUrl:i}}=t(),l={page:a,filters:[],meta:s};let u;n&&(l.q=n),Object.entries(r).forEach((e=>{let[t,r]=e;r&&l.filters.push(t)}));try{u=await c.l2.get(i,{params:l,paramsSerializer:e=>o().stringify(e,{arrayFormat:"repeat",allowDots:!0})})}catch(t){return(0,c.zZ)(t),void e({type:h})}const{entries:d,pages:p,total_page_count:y}=u.data;e(function(e,t,r){return{type:m,entries:e,pages:t,totalPageCount:r}}(d,p,y))}}var P=r(19306),x=r(89178),N=r(53806),O=r.n(N),D=r(60216),j=r.n(D),C=r(69184),_=r(72865),R=r(28106);class T extends n.Component{constructor(e){super(e),this.modal=void 0,this.onClose=this.onClose.bind(this),this.prevEntry=this.prevEntry.bind(this),this.nextEntry=this.nextEntry.bind(this),this.relatedEntries=this.relatedEntries.bind(this)}componentDidUpdate(){const{currentViewIndex:e}=this.props;null!==e&&this.open()}open(){this.modal.open()}onClose(){const{setDetailedView:e}=this.props;e(null)}prevEntry(){const{prevEntry:e}=this.props;e()}nextEntry(){const{nextEntry:e}=this.props;e()}relatedEntries(){const{relatedEntries:e}=this.props;e()}_isFirstEntry(){const{currentPage:e,currentViewIndex:t}=this.props;return 1===e&&0===t}_isLastEntry(){const{currentPage:e,totalPageCount:t,currentViewIndex:r,entries:n}=this.props;return e===t&&r===n.length-1}_hasRelatedEntries(){const{currentViewIndex:e,entries:t}=this.props,r=t[e];return 0!==Object.keys(r.meta).length}render(){const{currentViewIndex:e,entries:t}=this.props;if(null===e)return"";const{description:r,html:a,user:{fullName:s},time:i}=t[e];return n.createElement(_.u_,{title:r,ref:e=>{this.modal=e},onClose:this.onClose,contentLabel:"Details about log entry",fixedFooter:!0},n.createElement(R.g7,null,n.createElement("table",{className:"i-table log-modal-details",dangerouslySetInnerHTML:{__html:a}}),n.createElement("div",{className:"text-superfluous log-modal-author-info flexrow f-j-end"},n.createElement("span",null,s&&n.createElement("span",{className:"log-modal-user"},s," "),"on",n.createElement("span",{className:"log-modal-time"}," ",O()(i).format("ddd, D/M/YYYY HH:mm"))))),n.createElement(R.g7,{name:"footer"},n.createElement("div",{className:"group flexrow f-j-space-between"},n.createElement(_.Lp,{title:"Previous",icon:"prev",onClick:this.prevEntry,disabled:this._isFirstEntry()},n.createElement(P.vN,null,"Previous")),n.createElement(_.Lp,{onClick:this.relatedEntries,disabled:!this._hasRelatedEntries()},n.createElement(P.vN,null,"Related entries")),n.createElement(_.Lp,{title:"Next",classes:{next:!0},highlight:!0,onClick:this.nextEntry,disabled:this._isLastEntry()},n.createElement(P.vN,null,"Next")))))}}(0,x.Z)(T,"propTypes",{entries:j().array.isRequired,currentViewIndex:j().number,setDetailedView:j().func.isRequired,prevEntry:j().func.isRequired,nextEntry:j().func.isRequired,relatedEntries:j().func.isRequired,currentPage:j().number.isRequired,totalPageCount:j().number.isRequired}),(0,x.Z)(T,"defaultProps",{currentViewIndex:null});const S=(0,s.connect)((e=>{let{logs:t}=e;return{currentViewIndex:t.currentViewIndex,currentPage:t.currentPage,totalPageCount:t.totalPageCount}}),(e=>({setDetailedView:t=>{e(b(t))},prevEntry:()=>{e((async(e,t)=>{const{staticData:{pageSize:r},logs:{currentViewIndex:n,currentPage:a}}=t();0===n?0===a||(await e(f(a-1)),await e(w()),await e(b(r-1))):e({type:y,currentViewIndex:n-1})}))},nextEntry:()=>{e((async(e,t)=>{const{staticData:{pageSize:r},logs:{currentViewIndex:n,currentPage:a,pages:s}}=t();n===r-1?a===s[s.length-1]||(await e(f(a+1)),await e(b(0)),await e(w())):e({type:y,currentViewIndex:n+1})}))},relatedEntries:()=>{e(((e,t)=>{const{logs:{entries:r,currentViewIndex:n}}=t(),a=r[n],s=o().stringify({meta:a.meta},{allowDots:!0});e(v(a.meta)),e(f(1)),e(b(null)),e(w()),history.replaceState({},null,`${location.pathname}?${s}`)}))}})))(T);class k extends n.PureComponent{constructor(e){super(e),this.openDetails=this.openDetails.bind(this)}openDetails(e){const{setDetailedView:t}=this.props;t(e)}iconProps(e){if("email"===e.type)switch(e.payload.state){case"pending":return{className:"log-icon semantic-text warning",title:P.vN.string("This email is pending and will be sent soon."),"data-qtip-style":"warning"};case"sent":return{className:"log-icon semantic-text success",title:P.vN.string("This email has been sent."),"data-qtip-style":"success"};case"failed":return{className:"log-icon semantic-text error",title:P.vN.string("Sending this email failed."),"data-qtip-style":"danger"}}return{className:"log-icon"}}entryKind(e){if("email"!==e.type)return e.kind;return{pending:"change",sent:"positive",failed:"negative"}[e.payload.state]||"other"}render(){const{entry:e}=this.props;return n.createElement("li",{className:`log-realm-${e.realm} log-kind-${this.entryKind(e)}`},n.createElement("span",{className:"log-module"},n.createElement("span",this.iconProps(e),n.createElement("i",{className:"log-realm"}),n.createElement("i",{className:"log-kind icon-circle-small"})),n.createElement("span",{className:"bold"},e.module)),n.createElement(_.Tm,null,n.createElement("span",{className:"log-entry-description",onClick:()=>this.openDetails(e.index)},e.description)),n.createElement("span",{className:"log-entry-details"},n.createElement("span",{className:"logged-time",title:O()(e.time).format("DD/MM/YYYY HH:mm")},n.createElement("time",{dateTime:e.time},O()(e.time).fromNow())),e.user.avatarURL?n.createElement(C.Z,{avatar:!0,title:e.user.fullName,src:e.user.avatarURL,className:"user-picture ui-qtip"}):""))}}(0,x.Z)(k,"propTypes",{entry:j().object.isRequired,setDetailedView:j().func.isRequired});class V extends n.PureComponent{renderEmpty(){return n.createElement(_._p,{type:"info"},"No logs to show")}renderSpinner(){return n.createElement("div",{className:"event-log-list-spinner"},n.createElement("div",{className:"i-spinner"}))}renderList(){const{entries:e,pages:t,currentPage:r,changePage:a,isFetching:s,setDetailedView:i}=this.props;return n.createElement(n.Fragment,null,s&&this.renderSpinner(),n.createElement("ul",{className:"event-log-list "+(s?"loading":"")},e.map((e=>n.createElement(k,{key:e.id,entry:e,setDetailedView:i})))),!s&&n.createElement(_.Ds,{currentPage:r,pages:t,changePage:a}),n.createElement(S,{entries:e}))}render(){const{entries:e,isFetching:t}=this.props;return 0===e.length?t?this.renderSpinner():this.renderEmpty():this.renderList()}}(0,x.Z)(V,"propTypes",{entries:j().array.isRequired,currentPage:j().number.isRequired,pages:j().array.isRequired,changePage:j().func.isRequired,isFetching:j().bool.isRequired,setDetailedView:j().func.isRequired});const q=(0,s.connect)((e=>{let{logs:t}=e;return{entries:t.entries,currentPage:t.currentPage,pages:t.pages,isFetching:t.isFetching}}),(e=>({changePage:t=>{e(f(t)),e(w())},setDetailedView:t=>{e(b(t))}})))(V);class F extends n.Component{render(){const{realms:e,filters:t,setFilter:r}=this.props;return n.createElement("div",{className:"toolbar"},n.createElement("div",{className:"group i-selection "+(e.length<=1?"hidden":"")},n.createElement("span",{className:"i-button label"},n.createElement(P.vN,null,"Show")),Object.keys(e).sort().map((a=>n.createElement(n.Fragment,{key:a},n.createElement("input",{type:"checkbox",id:`realm-${a}`,"data-realm":a,defaultChecked:t[a],onChange:e=>r({[a]:e.target.checked})}),n.createElement("label",{htmlFor:`realm-${a}`,className:"i-button"},e[a]))))))}}(0,x.Z)(F,"propTypes",{realms:j().object.isRequired,filters:j().object.isRequired,setFilter:j().func.isRequired});const I=(0,s.connect)((e=>{let{logs:t}=e;return{filters:t.filters}}),(e=>({setFilter:t=>{e(function(e){return{type:d,filter:e}}(t)),e(f(1)),e(w())}})))(F);var L=r(45750),Z=r.n(L);class Y extends n.Component{render(){const{setKeyword:e}=this.props;return n.createElement("div",{className:"toolbar"},n.createElement("div",{className:"group"},n.createElement("span",{className:"i-button label"},n.createElement("span",{className:"icon-search"})),n.createElement("input",{type:"text",onChange:t=>e(t.target.value.trim())})))}}(0,x.Z)(Y,"propTypes",{setKeyword:j().func.isRequired});const M=(0,s.connect)(null,(e=>({setKeyword:Z()((t=>{e(function(e){return{type:u,keyword:e}}(t)),e(f(1)),e(w())}),250)})))(Y);class U extends n.Component{render(){const{realms:e}=this.props;return n.createElement("div",{className:"toolbars"},n.createElement(I,{realms:e}),n.createElement(M,null))}}(0,x.Z)(U,"propTypes",{realms:j().object.isRequired});const A=(0,s.connect)((e=>{let{staticData:t}=e;return{realms:t.realms}}))(U);function Q(){const e=(0,s.useDispatch)();return n.createElement("div",{className:"highlight-message-box"},n.createElement("span",{className:"icon"}),n.createElement("div",{className:"message-text"},n.createElement(P.vN,null,"Log entries are currently filtered by URL."," ",n.createElement(P.dO,{name:"link",wrapper:n.createElement("a",{onClick:()=>{e((e=>{e(v({})),e(f(1)),e(b(null)),e(w()),history.replaceState({},null,location.pathname)}))}})},"Click here")," ","to disable the filter.")))}function H(){const e=(0,s.useSelector)((e=>e.logs.metadataQuery));return n.createElement(n.Fragment,null,0!==Object.keys(e).length&&n.createElement(Q,null),n.createElement(A,null),n.createElement(q,null))}function K(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function $(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?K(Object(r),!0).forEach((function(t){(0,x.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}Q.propTypes={};const z={entries:[],keyword:null,currentPage:1,isFetching:!1,metadataQuery:{},filters:{event:!0,management:!0,emails:!0,participants:!0,reviewing:!0},pages:[],totalPageCount:0,currentViewIndex:null};function J(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case u:return $($({},e),{},{keyword:t.keyword});case d:return $($({},e),{},{filters:$($({},e.filters),t.filter)});case p:return $($({},e),{},{currentPage:t.currentPage});case m:return $($({},e),{},{entries:t.entries,pages:t.pages,totalPageCount:t.totalPageCount,isFetching:!1});case g:return $($({},e),{},{isFetching:!0});case h:return $($({},e),{},{isFetching:!1});case y:return $($({},e),{},{currentViewIndex:t.currentViewIndex});case E:return $($({},e),{},{metadataQuery:t.metadataQuery});default:return e}}window.addEventListener("load",(()=>{const e=document.querySelector(".event-log"),t={staticData:{fetchLogsUrl:e.dataset.fetchLogsUrl,realms:JSON.parse(e.dataset.realms),pageSize:15}},r=(0,i.ZP)("event-logs",{logs:J},t);r.dispatch(v(JSON.parse(e.dataset.metadataQuery))),a.render(n.createElement(s.Provider,{store:r},n.createElement(H,null)),e),r.dispatch(w())}))}},a={};function s(e){var t=a[e];if(void 0!==t)return t.exports;var r=a[e]={id:e,loaded:!1,exports:{}};return n[e].call(r.exports,r,r.exports,s),r.loaded=!0,r.exports}s.m=n,e=[],s.O=(t,r,n,a)=>{if(!r){var i=1/0;for(c=0;c<e.length;c++){for(var[r,n,a]=e[c],l=!0,o=0;o<r.length;o++)(!1&a||i>=a)&&Object.keys(s.O).every((e=>s.O[e](r[o])))?r.splice(o--,1):(l=!1,a<i&&(i=a));l&&(e.splice(c--,1),t=n())}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[r,n,a]},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},r=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,s.t=function(e,n){if(1&n&&(e=this(e)),8&n)return e;if("object"==typeof e&&e){if(4&n&&e.__esModule)return e;if(16&n&&"function"==typeof e.then)return e}var a=Object.create(null);s.r(a);var i={};t=t||[null,r({}),r([]),r(r)];for(var l=2&n&&e;"object"==typeof l&&!~t.indexOf(l);l=r(l))Object.getOwnPropertyNames(l).forEach((t=>i[t]=()=>e[t]));return i.default=()=>e,s.d(a,i),a},s.d=(e,t)=>{for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},s.e=()=>Promise.resolve(),s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),s.j=38,(()=>{var e={38:0};s.O.j=t=>0===e[t];var t=(t,r)=>{var n,a,[i,l,o]=r,c=0;for(n in l)s.o(l,n)&&(s.m[n]=l[n]);if(o)var u=o(s);for(t&&t(r);c<i.length;c++)a=i[c],s.o(e,a)&&e[a]&&e[a][0](),e[i[c]]=0;return s.O(u)},r=self.webpackChunk=self.webpackChunk||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var i=s.O(void 0,[5514,3044,8592],(()=>s(77955)));i=s.O(i)})();
//# sourceMappingURL=module_events.logs.7863a55f.bundle.js.map