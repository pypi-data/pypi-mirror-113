{"version":3,"sources":["webpack:///./app/components/well.tsx","webpack:///./app/components/avatarCropper.tsx","webpack:///./app/components/avatarChooser.tsx","webpack:///./app/views/settings/components/forms/formPanel.tsx","webpack:///./app/views/settings/components/forms/jsonForm.tsx","webpack:///../node_modules/core-js/internals/date-to-primitive.js","webpack:///../node_modules/core-js/modules/es.date.to-primitive.js","webpack:///../node_modules/core-js/modules/es.symbol.to-primitive.js"],"names":["p","theme","border","backgroundSecondary","hasImage","centered","resizerPositions","nw","ne","se","sw","AvatarCropper","file","objectURL","mousePosition","pageX","pageY","resizeDimensions","top","left","size","resizeDirection","React","ev","target","files","test","type","revokeObjectUrl","updateDataUrlState","props","window","URL","createObjectURL","setState","savedDataUrl","addErrorMessage","t","state","revokeObjectURL","error","validateImage","image","current","Math","min","clientHeight","clientWidth","drawToCanvas","cropContainer","preventDefault","document","addEventListener","updateDimensions","onMouseUp","removeEventListener","direction","stopPropagation","updateSize","stopResize","yDiff","xDiff","getNewDimensions","container","oldDimensions","diff","toUpperCase","height","width","editingTop","editingLeft","newDimensions","maxSize","MIN_DIMENSION","click","this","img","naturalWidth","naturalHeight","tct","MAX_DIMENSION","canvas","ratio","getContext","drawImage","dataUrl","toDataURL","model","uuid","avatar","avatarUuid","photoUrl","AVATAR_URL_MAP","src","imageSrc","style","ImageCropper","CropContainer","ref","onLoad","onImageLoad","onDragStart","e","Cropper","onMouseDown","Object","keys","map","pos","Resizer","position","startResize","bind","upload","onClick","uploadClick","uploader","HiddenCanvas","renderImageCrop","className","UploadInput","accept","ALLOWED_MIMETYPES","onChange","onSelectFile","background","gray300","AvatarChooser","hasError","endpoint","api","data","avatarType","undefined","avatar_photo","split","avatar_type","request","method","success","resp","handleSuccess","handleError","id","updateState","nextProps","msg","onSave","addSuccessMessage","allowGravatar","allowUpload","allowLetter","isUser","disabled","isLetter","isTeam","isOrganization","choices","push","AvatarForm","AvatarGroup","inline","flex","value","label","handleChange","gravatar","user","organization","team","AvatarUploadSection","href","dataState","AvatarSubmit","priority","handleSaveSettings","withApi","FormPanel","title","fields","access","additionalFieldProps","renderFooter","renderHeader","otherProps","sanitizeQuerySelector","field","defaultValue","fieldWithoutDefaultValue","disabledReason","highlighted","name","JsonForm","location","hash","scrollToHash","toHash","scrollToElement","decodeURIComponent","align","offset","err","Sentry","fieldsWithVisibleProp","filter","defined","visible","length","every","formPanelProps","shouldDisplayForm","forms","features","formGroup","i","renderForm","withRouter","anObject","toPrimitive","module","exports","hint","TypeError","createNonEnumerableProperty","dateToPrimitive","TO_PRIMITIVE","wellKnownSymbol","DatePrototype","Date","prototype","defineWellKnownSymbol"],"mappings":"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","file":"chunks/app_components_avatarChooser_tsx-app_views_settings_components_forms_jsonForm_tsx-node_module-24dc4d.xxxxxxxxxxxxxxxxxxxx.js","sourcesContent":["import * as React from 'react';\nimport styled from '@emotion/styled';\n\ntype Props = {\n  hasImage?: boolean;\n  centered?: boolean;\n  children: React.ReactNode;\n  theme?: any;\n};\n\ntype WellProps = Omit<React.HTMLProps<HTMLDivElement>, keyof Props> & Props;\n\nconst Well = styled('div')<WellProps>`\n  border: 1px solid ${p => p.theme.border};\n  box-shadow: none;\n  background: ${p => p.theme.backgroundSecondary};\n  padding: ${p => (p.hasImage ? '80px 30px' : '15px 20px')};\n  margin-bottom: 20px;\n  border-radius: 3px;\n  ${p => p.centered && 'text-align: center'};\n`;\n\nexport default Well;\n","import * as React from 'react';\nimport styled from '@emotion/styled';\n\nimport {addErrorMessage} from 'app/actionCreators/indicator';\nimport Well from 'app/components/well';\nimport {AVATAR_URL_MAP} from 'app/constants';\nimport {t, tct} from 'app/locale';\nimport {AvatarUser} from 'app/types';\n\nconst resizerPositions = {\n  nw: ['top', 'left'],\n  ne: ['top', 'right'],\n  se: ['bottom', 'right'],\n  sw: ['bottom', 'left'],\n};\n\ntype Position = keyof typeof resizerPositions;\n\ntype Model = Pick<AvatarUser, 'avatar'>;\n\ntype Props = {\n  model: Model;\n  updateDataUrlState: (opts: {savedDataUrl?: string | null; dataUrl?: string}) => void;\n  type: 'user' | 'team' | 'organization' | 'project';\n  savedDataUrl?: string;\n};\n\ntype State = {\n  file: File | null;\n  objectURL: string | null;\n  mousePosition: {pageX: number; pageY: number};\n  resizeDimensions: {top: number; left: number; size: number};\n  resizeDirection: Position | null;\n};\n\nclass AvatarCropper extends React.Component<Props, State> {\n  state: State = {\n    file: null,\n    objectURL: null,\n    mousePosition: {pageX: 0, pageY: 0},\n    resizeDimensions: {top: 0, left: 0, size: 0},\n    resizeDirection: null,\n  };\n\n  componentWillUnmount() {\n    this.revokeObjectUrl();\n  }\n\n  file = React.createRef<HTMLInputElement>();\n  canvas = React.createRef<HTMLCanvasElement>();\n  image = React.createRef<HTMLImageElement>();\n  cropContainer = React.createRef<HTMLDivElement>();\n\n  // These values must be synced with the avatar endpoint in backend.\n  MIN_DIMENSION = 256;\n  MAX_DIMENSION = 1024;\n  ALLOWED_MIMETYPES = 'image/gif,image/jpeg,image/png';\n\n  onSelectFile = (ev: React.ChangeEvent<HTMLInputElement>) => {\n    const file = ev.target.files && ev.target.files[0];\n\n    // No file selected (e.g. user clicked \"cancel\")\n    if (!file) {\n      return;\n    }\n\n    if (!/^image\\//.test(file.type)) {\n      addErrorMessage(t('That is not a supported file type.'));\n      return;\n    }\n\n    this.revokeObjectUrl();\n\n    const {updateDataUrlState} = this.props;\n    const objectURL = window.URL.createObjectURL(file);\n    this.setState({file, objectURL}, () => updateDataUrlState({savedDataUrl: null}));\n  };\n\n  revokeObjectUrl = () =>\n    this.state.objectURL && window.URL.revokeObjectURL(this.state.objectURL);\n\n  onImageLoad = () => {\n    const error = this.validateImage();\n    if (error) {\n      this.revokeObjectUrl();\n      this.setState({objectURL: null});\n      addErrorMessage(error);\n      return;\n    }\n\n    const image = this.image.current;\n    if (!image) {\n      return;\n    }\n\n    const dimension = Math.min(image.clientHeight, image.clientWidth);\n    const state = {resizeDimensions: {size: dimension, top: 0, left: 0}};\n\n    this.setState(state, this.drawToCanvas);\n  };\n\n  updateDimensions = (ev: MouseEvent) => {\n    const cropContainer = this.cropContainer.current;\n    if (!cropContainer) {\n      return;\n    }\n\n    const {mousePosition, resizeDimensions} = this.state;\n\n    let pageY = ev.pageY;\n    let pageX = ev.pageX;\n    let top = resizeDimensions.top + (pageY - mousePosition.pageY);\n    let left = resizeDimensions.left + (pageX - mousePosition.pageX);\n\n    if (top < 0) {\n      top = 0;\n      pageY = mousePosition.pageY;\n    } else if (top + resizeDimensions.size > cropContainer.clientHeight) {\n      top = cropContainer.clientHeight - resizeDimensions.size;\n      pageY = mousePosition.pageY;\n    }\n\n    if (left < 0) {\n      left = 0;\n      pageX = mousePosition.pageX;\n    } else if (left + resizeDimensions.size > cropContainer.clientWidth) {\n      left = cropContainer.clientWidth - resizeDimensions.size;\n      pageX = mousePosition.pageX;\n    }\n\n    this.setState(state => ({\n      resizeDimensions: {...state.resizeDimensions, top, left},\n      mousePosition: {pageX, pageY},\n    }));\n  };\n\n  onMouseDown = (ev: React.MouseEvent<HTMLDivElement>) => {\n    ev.preventDefault();\n    this.setState({mousePosition: {pageY: ev.pageY, pageX: ev.pageX}});\n\n    document.addEventListener('mousemove', this.updateDimensions);\n    document.addEventListener('mouseup', this.onMouseUp);\n  };\n\n  onMouseUp = (ev: MouseEvent) => {\n    ev.preventDefault();\n    document.removeEventListener('mousemove', this.updateDimensions);\n    document.removeEventListener('mouseup', this.onMouseUp);\n    this.drawToCanvas();\n  };\n\n  startResize = (direction: Position, ev: React.MouseEvent<HTMLDivElement>) => {\n    ev.stopPropagation();\n    ev.preventDefault();\n    document.addEventListener('mousemove', this.updateSize);\n    document.addEventListener('mouseup', this.stopResize);\n\n    this.setState({\n      resizeDirection: direction,\n      mousePosition: {pageY: ev.pageY, pageX: ev.pageX},\n    });\n  };\n\n  stopResize = (ev: MouseEvent) => {\n    ev.stopPropagation();\n    ev.preventDefault();\n    document.removeEventListener('mousemove', this.updateSize);\n    document.removeEventListener('mouseup', this.stopResize);\n\n    this.setState({resizeDirection: null});\n    this.drawToCanvas();\n  };\n\n  updateSize = (ev: MouseEvent) => {\n    const cropContainer = this.cropContainer.current;\n    if (!cropContainer) {\n      return;\n    }\n\n    const {mousePosition} = this.state;\n\n    const yDiff = ev.pageY - mousePosition.pageY;\n    const xDiff = ev.pageX - mousePosition.pageX;\n\n    this.setState({\n      resizeDimensions: this.getNewDimensions(cropContainer, yDiff, xDiff),\n      mousePosition: {pageX: ev.pageX, pageY: ev.pageY},\n    });\n  };\n\n  // Normalize diff across dimensions so that negative diffs are always making\n  // the cropper smaller and positive ones are making the cropper larger\n  getDiffNW = (yDiff: number, xDiff: number) =>\n    (yDiff - yDiff * 2 + (xDiff - xDiff * 2)) / 2;\n\n  getDiffNE = (yDiff: number, xDiff: number) => (yDiff - yDiff * 2 + xDiff) / 2;\n\n  getDiffSW = (yDiff: number, xDiff: number) => (yDiff + (xDiff - xDiff * 2)) / 2;\n\n  getDiffSE = (yDiff: number, xDiff: number) => (yDiff + xDiff) / 2;\n\n  getNewDimensions = (container: HTMLDivElement, yDiff: number, xDiff: number) => {\n    const {resizeDimensions: oldDimensions, resizeDirection} = this.state;\n\n    const diff = this['getDiff' + resizeDirection!.toUpperCase()](yDiff, xDiff);\n\n    let height = container.clientHeight - oldDimensions.top;\n    let width = container.clientWidth - oldDimensions.left;\n\n    // Depending on the direction, we update different dimensions:\n    // nw: size, top, left\n    // ne: size, top\n    // sw: size, left\n    // se: size\n    const editingTop = resizeDirection === 'nw' || resizeDirection === 'ne';\n    const editingLeft = resizeDirection === 'nw' || resizeDirection === 'sw';\n\n    const newDimensions = {\n      top: 0,\n      left: 0,\n      size: oldDimensions.size + diff,\n    };\n\n    if (editingTop) {\n      newDimensions.top = oldDimensions.top - diff;\n      height = container.clientHeight - newDimensions.top;\n    }\n\n    if (editingLeft) {\n      newDimensions.left = oldDimensions.left - diff;\n      width = container.clientWidth - newDimensions.left;\n    }\n\n    if (newDimensions.top < 0) {\n      newDimensions.size = newDimensions.size + newDimensions.top;\n      if (editingLeft) {\n        newDimensions.left = newDimensions.left - newDimensions.top;\n      }\n      newDimensions.top = 0;\n    }\n\n    if (newDimensions.left < 0) {\n      newDimensions.size = newDimensions.size + newDimensions.left;\n      if (editingTop) {\n        newDimensions.top = newDimensions.top - newDimensions.left;\n      }\n      newDimensions.left = 0;\n    }\n\n    const maxSize = Math.min(width, height);\n    if (newDimensions.size > maxSize) {\n      if (editingTop) {\n        newDimensions.top = newDimensions.top + newDimensions.size - maxSize;\n      }\n      if (editingLeft) {\n        newDimensions.left = newDimensions.left + newDimensions.size - maxSize;\n      }\n      newDimensions.size = maxSize;\n    } else if (newDimensions.size < this.MIN_DIMENSION) {\n      if (editingTop) {\n        newDimensions.top = newDimensions.top + newDimensions.size - this.MIN_DIMENSION;\n      }\n      if (editingLeft) {\n        newDimensions.left = newDimensions.left + newDimensions.size - this.MIN_DIMENSION;\n      }\n      newDimensions.size = this.MIN_DIMENSION;\n    }\n\n    return {...oldDimensions, ...newDimensions};\n  };\n\n  validateImage() {\n    const img = this.image.current;\n\n    if (!img) {\n      return null;\n    }\n\n    if (img.naturalWidth < this.MIN_DIMENSION || img.naturalHeight < this.MIN_DIMENSION) {\n      return tct('Please upload an image larger than [size]px by [size]px.', {\n        size: this.MIN_DIMENSION - 1,\n      });\n    }\n\n    if (img.naturalWidth > this.MAX_DIMENSION || img.naturalHeight > this.MAX_DIMENSION) {\n      return tct('Please upload an image smaller than [size]px by [size]px.', {\n        size: this.MAX_DIMENSION,\n      });\n    }\n\n    return null;\n  }\n\n  drawToCanvas() {\n    const canvas = this.canvas.current;\n    if (!canvas) {\n      return;\n    }\n\n    const image = this.image.current;\n    if (!image) {\n      return;\n    }\n\n    const {left, top, size} = this.state.resizeDimensions;\n    // Calculate difference between natural dimensions and rendered dimensions\n    const ratio =\n      (image.naturalHeight / image.clientHeight +\n        image.naturalWidth / image.clientWidth) /\n      2;\n    canvas.width = size * ratio;\n    canvas.height = size * ratio;\n\n    canvas\n      .getContext('2d')!\n      .drawImage(\n        image,\n        left * ratio,\n        top * ratio,\n        size * ratio,\n        size * ratio,\n        0,\n        0,\n        size * ratio,\n        size * ratio\n      );\n\n    this.props.updateDataUrlState({dataUrl: canvas.toDataURL()});\n  }\n\n  get imageSrc() {\n    const {savedDataUrl, model, type} = this.props;\n    const uuid = model.avatar?.avatarUuid;\n    const photoUrl = uuid && `/${AVATAR_URL_MAP[type] || 'avatar'}/${uuid}/`;\n\n    return savedDataUrl || this.state.objectURL || photoUrl;\n  }\n\n  uploadClick = (ev: React.MouseEvent<HTMLAnchorElement>) => {\n    ev.preventDefault();\n    this.file.current && this.file.current.click();\n  };\n\n  renderImageCrop() {\n    const src = this.imageSrc;\n    if (!src) {\n      return null;\n    }\n\n    const {resizeDimensions, resizeDirection} = this.state;\n    const style = {\n      top: resizeDimensions.top,\n      left: resizeDimensions.left,\n      width: resizeDimensions.size,\n      height: resizeDimensions.size,\n    };\n\n    return (\n      <ImageCropper resizeDirection={resizeDirection}>\n        <CropContainer ref={this.cropContainer}>\n          <img\n            ref={this.image}\n            src={src}\n            onLoad={this.onImageLoad}\n            onDragStart={e => e.preventDefault()}\n          />\n          <Cropper style={style} onMouseDown={this.onMouseDown}>\n            {Object.keys(resizerPositions).map(pos => (\n              <Resizer\n                key={pos}\n                position={pos as Position}\n                onMouseDown={this.startResize.bind(this, pos)}\n              />\n            ))}\n          </Cropper>\n        </CropContainer>\n      </ImageCropper>\n    );\n  }\n\n  render() {\n    const src = this.imageSrc;\n\n    const upload = <a onClick={this.uploadClick} />;\n    const uploader = (\n      <Well hasImage centered>\n        <p>{tct('[upload:Upload a photo] to get started.', {upload})}</p>\n      </Well>\n    );\n\n    return (\n      <React.Fragment>\n        {!src && uploader}\n        {src && <HiddenCanvas ref={this.canvas} />}\n        {this.renderImageCrop()}\n        <div className=\"form-group\">\n          {src && <a onClick={this.uploadClick}>{t('Change Photo')}</a>}\n          <UploadInput\n            ref={this.file}\n            type=\"file\"\n            accept={this.ALLOWED_MIMETYPES}\n            onChange={this.onSelectFile}\n          />\n        </div>\n      </React.Fragment>\n    );\n  }\n}\n\nexport default AvatarCropper;\n\nconst UploadInput = styled('input')`\n  position: absolute;\n  opacity: 0;\n`;\n\nconst ImageCropper = styled('div')<{resizeDirection: Position | null}>`\n  cursor: ${p => (p.resizeDirection ? `${p.resizeDirection}-resize` : 'default')};\n  text-align: center;\n  margin-bottom: 20px;\n  background-size: 20px 20px;\n  background-position: 0 0, 0 10px, 10px -10px, -10px 0px;\n  background-color: ${p => p.theme.background};\n  background-image: linear-gradient(\n      45deg,\n      ${p => p.theme.backgroundSecondary} 25%,\n      rgba(0, 0, 0, 0) 25%\n    ),\n    linear-gradient(-45deg, ${p => p.theme.backgroundSecondary} 25%, rgba(0, 0, 0, 0) 25%),\n    linear-gradient(45deg, rgba(0, 0, 0, 0) 75%, ${p => p.theme.backgroundSecondary} 75%),\n    linear-gradient(-45deg, rgba(0, 0, 0, 0) 75%, ${p => p.theme.backgroundSecondary} 75%);\n`;\n\nconst CropContainer = styled('div')`\n  display: inline-block;\n  position: relative;\n  max-width: 100%;\n`;\n\nconst Cropper = styled('div')`\n  position: absolute;\n  border: 2px dashed ${p => p.theme.gray300};\n`;\n\nconst Resizer = styled('div')<{position: Position}>`\n  border-radius: 5px;\n  width: 10px;\n  height: 10px;\n  position: absolute;\n  background-color: ${p => p.theme.gray300};\n  cursor: ${p => `${p.position}-resize`};\n  ${p => resizerPositions[p.position].map(pos => `${pos}: -5px;`)}\n`;\n\nconst HiddenCanvas = styled('canvas')`\n  display: none;\n`;\n","import * as React from 'react';\nimport styled from '@emotion/styled';\n\nimport {addErrorMessage, addSuccessMessage} from 'app/actionCreators/indicator';\nimport {Client} from 'app/api';\nimport Avatar from 'app/components/avatar';\nimport AvatarCropper from 'app/components/avatarCropper';\nimport Button from 'app/components/button';\nimport ExternalLink from 'app/components/links/externalLink';\nimport LoadingError from 'app/components/loadingError';\nimport LoadingIndicator from 'app/components/loadingIndicator';\nimport {Panel, PanelBody, PanelHeader} from 'app/components/panels';\nimport Well from 'app/components/well';\nimport {t} from 'app/locale';\nimport {AvatarUser, Organization, Team} from 'app/types';\nimport withApi from 'app/utils/withApi';\nimport RadioGroup from 'app/views/settings/components/forms/controls/radioGroup';\n\ntype Model = Pick<AvatarUser, 'avatar'>;\ntype AvatarType = Required<Model>['avatar']['avatarType'];\ntype AvatarChooserType = 'user' | 'team' | 'organization';\n\ntype DefaultProps = {\n  onSave: (model: Model) => void;\n  allowGravatar?: boolean;\n  allowLetter?: boolean;\n  allowUpload?: boolean;\n  type?: AvatarChooserType;\n};\n\ntype Props = {\n  api: Client;\n  endpoint: string;\n  model: Model;\n  disabled?: boolean;\n  savedDataUrl?: string;\n  isUser?: boolean;\n} & DefaultProps;\n\ntype State = {\n  model: Model;\n  hasError: boolean;\n  savedDataUrl?: string | null;\n  dataUrl?: string | null;\n};\n\nclass AvatarChooser extends React.Component<Props, State> {\n  static defaultProps: DefaultProps = {\n    allowGravatar: true,\n    allowLetter: true,\n    allowUpload: true,\n    type: 'user',\n    onSave: () => {},\n  };\n\n  state: State = {\n    model: this.props.model,\n    savedDataUrl: null,\n    dataUrl: null,\n    hasError: false,\n  };\n\n  UNSAFE_componentWillReceiveProps(nextProps: Props) {\n    // Update local state if defined in props\n    if (typeof nextProps.model !== 'undefined') {\n      this.setState({model: nextProps.model});\n    }\n  }\n\n  updateState(model: Model) {\n    this.setState({model});\n  }\n\n  handleError(msg: string) {\n    addErrorMessage(msg);\n  }\n\n  handleSuccess(model: Model) {\n    const {onSave} = this.props;\n    this.setState({model});\n    onSave(model);\n    addSuccessMessage(t('Successfully saved avatar preferences'));\n  }\n\n  handleSaveSettings = (ev: React.MouseEvent) => {\n    const {endpoint, api} = this.props;\n    const {model, dataUrl} = this.state;\n    ev.preventDefault();\n    let data = {};\n    const avatarType = model && model.avatar ? model.avatar.avatarType : undefined;\n    const avatarPhoto = dataUrl ? dataUrl.split(',')[1] : undefined;\n\n    data = {\n      avatar_photo: avatarPhoto,\n      avatar_type: avatarType,\n    };\n\n    api.request(endpoint, {\n      method: 'PUT',\n      data,\n      success: resp => {\n        this.setState({savedDataUrl: this.state.dataUrl});\n        this.handleSuccess(resp);\n      },\n      error: this.handleError.bind(this, 'There was an error saving your preferences.'),\n    });\n  };\n\n  handleChange = (id: AvatarType) =>\n    this.updateState({\n      ...this.state.model,\n      avatar: {avatarUuid: this.state.model.avatar?.avatarUuid ?? '', avatarType: id},\n    });\n\n  render() {\n    const {\n      allowGravatar,\n      allowUpload,\n      allowLetter,\n      savedDataUrl,\n      type,\n      isUser,\n      disabled,\n    } = this.props;\n    const {hasError, model} = this.state;\n\n    if (hasError) {\n      return <LoadingError />;\n    }\n    if (!model) {\n      return <LoadingIndicator />;\n    }\n\n    const avatarType = model.avatar?.avatarType ?? 'letter_avatar';\n    const isLetter = avatarType === 'letter_avatar';\n\n    const isTeam = type === 'team';\n    const isOrganization = type === 'organization';\n    const choices: [AvatarType, string][] = [];\n\n    if (allowLetter) {\n      choices.push(['letter_avatar', t('Use initials')]);\n    }\n    if (allowUpload) {\n      choices.push(['upload', t('Upload an image')]);\n    }\n    if (allowGravatar) {\n      choices.push(['gravatar', t('Use Gravatar')]);\n    }\n\n    return (\n      <Panel>\n        <PanelHeader>{t('Avatar')}</PanelHeader>\n        <PanelBody>\n          <AvatarForm>\n            <AvatarGroup inline={isLetter}>\n              <RadioGroup\n                style={{flex: 1}}\n                choices={choices}\n                value={avatarType}\n                label={t('Avatar Type')}\n                onChange={this.handleChange}\n                disabled={disabled}\n              />\n              {isLetter && (\n                <Avatar\n                  gravatar={false}\n                  style={{width: 90, height: 90}}\n                  user={isUser ? (model as AvatarUser) : undefined}\n                  organization={isOrganization ? (model as Organization) : undefined}\n                  team={isTeam ? (model as Team) : undefined}\n                />\n              )}\n            </AvatarGroup>\n\n            <AvatarUploadSection>\n              {allowGravatar && avatarType === 'gravatar' && (\n                <Well>\n                  {t('Gravatars are managed through ')}\n                  <ExternalLink href=\"http://gravatar.com\">Gravatar.com</ExternalLink>\n                </Well>\n              )}\n\n              {model.avatar && avatarType === 'upload' && (\n                <AvatarCropper\n                  {...this.props}\n                  type={type!}\n                  model={model}\n                  savedDataUrl={savedDataUrl}\n                  updateDataUrlState={dataState => this.setState(dataState)}\n                />\n              )}\n              <AvatarSubmit className=\"form-actions\">\n                <Button\n                  type=\"button\"\n                  priority=\"primary\"\n                  onClick={this.handleSaveSettings}\n                  disabled={disabled}\n                >\n                  {t('Save Avatar')}\n                </Button>\n              </AvatarSubmit>\n            </AvatarUploadSection>\n          </AvatarForm>\n        </PanelBody>\n      </Panel>\n    );\n  }\n}\n\nconst AvatarGroup = styled('div')<{inline: boolean}>`\n  display: flex;\n  flex-direction: ${p => (p.inline ? 'row' : 'column')};\n`;\n\nconst AvatarForm = styled('div')`\n  line-height: 1.5em;\n  padding: 1em 1.25em;\n`;\n\nconst AvatarSubmit = styled('fieldset')`\n  display: flex;\n  justify-content: flex-end;\n  margin-top: 1em;\n`;\n\nconst AvatarUploadSection = styled('div')`\n  margin-top: 1em;\n`;\n\nexport default withApi(AvatarChooser);\n","import * as React from 'react';\n\nimport {Panel, PanelBody, PanelHeader} from 'app/components/panels';\nimport {Scope} from 'app/types';\nimport {sanitizeQuerySelector} from 'app/utils/sanitizeQuerySelector';\nimport FieldFromConfig from 'app/views/settings/components/forms/fieldFromConfig';\n\nimport {FieldObject, JsonFormObject} from './type';\n\ntype DefaultProps = {\n  additionalFieldProps: {[key: string]: any};\n};\n\ntype Props = DefaultProps & {\n  /**\n   * Panel title\n   */\n  title?: React.ReactNode;\n\n  /**\n   * List of fields to render\n   */\n  fields: FieldObject[];\n\n  access?: Set<Scope>;\n  features?: Record<string, any>;\n\n  /**\n   * The name of the field that should be highlighted\n   */\n  highlighted?: string;\n\n  /**\n   * Renders inside of PanelBody at the start\n   */\n  renderHeader?: (arg: JsonFormObject) => React.ReactNode;\n\n  /**\n   * Renders inside of PanelBody before PanelBody close\n   */\n  renderFooter?: (arg: JsonFormObject) => React.ReactNode;\n\n  /**\n   * Disables the entire form\n   */\n  disabled?: boolean;\n};\n\nexport default class FormPanel extends React.Component<Props> {\n  static defaultProps: DefaultProps = {\n    additionalFieldProps: {},\n  };\n\n  render() {\n    const {\n      title,\n      fields,\n      access,\n      disabled,\n      additionalFieldProps,\n      renderFooter,\n      renderHeader,\n      ...otherProps\n    } = this.props;\n\n    return (\n      <Panel id={typeof title === 'string' ? sanitizeQuerySelector(title) : undefined}>\n        {title && <PanelHeader>{title}</PanelHeader>}\n        <PanelBody>\n          {typeof renderHeader === 'function' && renderHeader({title, fields})}\n\n          {fields.map(field => {\n            if (typeof field === 'function') {\n              return field();\n            }\n\n            const {defaultValue: _, ...fieldWithoutDefaultValue} = field;\n\n            // Allow the form panel disabled prop to override the fields\n            // disabled prop, with fallback to the fields disabled state.\n            if (disabled === true) {\n              fieldWithoutDefaultValue.disabled = true;\n              fieldWithoutDefaultValue.disabledReason = undefined;\n            }\n\n            return (\n              <FieldFromConfig\n                access={access}\n                disabled={disabled}\n                key={field.name}\n                {...otherProps}\n                {...additionalFieldProps}\n                field={fieldWithoutDefaultValue}\n                highlighted={this.props.highlighted === `#${field.name}`}\n              />\n            );\n          })}\n          {typeof renderFooter === 'function' && renderFooter({title, fields})}\n        </PanelBody>\n      </Panel>\n    );\n  }\n}\n","import * as React from 'react';\nimport {withRouter, WithRouterProps} from 'react-router';\nimport * as Sentry from '@sentry/react';\nimport scrollToElement from 'scroll-to-element';\n\nimport {defined} from 'app/utils';\nimport {sanitizeQuerySelector} from 'app/utils/sanitizeQuerySelector';\n\nimport FormPanel from './formPanel';\nimport {Field, FieldObject, JsonFormObject} from './type';\n\ntype Props = {\n  /**\n   * Fields that are grouped by \"section\"\n   */\n  forms?: JsonFormObject[];\n\n  /**\n   * If `forms` is not defined, `title` + `fields` must be required.\n   * Allows more fine grain control of title/fields\n   */\n  fields?: FieldObject[];\n\n  additionalFieldProps?: {[key: string]: any};\n} & WithRouterProps &\n  Omit<\n    React.ComponentProps<typeof FormPanel>,\n    'highlighted' | 'fields' | 'additionalFieldProps'\n  >;\n\ntype State = {\n  // Field name that should be highlighted\n  highlighted?: string;\n};\n\nclass JsonForm extends React.Component<Props, State> {\n  state: State = {\n    // location.hash is optional because of tests.\n    highlighted: this.props.location?.hash,\n  };\n\n  componentDidMount() {\n    this.scrollToHash();\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps: Props) {\n    if (this.props.location.hash !== nextProps.location.hash) {\n      const hash = nextProps.location.hash;\n      this.scrollToHash(hash);\n      this.setState({highlighted: hash});\n    }\n  }\n\n  scrollToHash(toHash?: string): void {\n    // location.hash is optional because of tests.\n    const hash = toHash || this.props.location?.hash;\n\n    if (!hash) {\n      return;\n    }\n\n    // Push onto callback queue so it runs after the DOM is updated,\n    // this is required when navigating from a different page so that\n    // the element is rendered on the page before trying to getElementById.\n    try {\n      scrollToElement(sanitizeQuerySelector(decodeURIComponent(hash)), {\n        align: 'middle',\n        offset: -100,\n      });\n    } catch (err) {\n      Sentry.captureException(err);\n    }\n  }\n\n  shouldDisplayForm(fields: FieldObject[]) {\n    const fieldsWithVisibleProp = fields.filter(\n      field => typeof field !== 'function' && defined(field?.visible)\n    ) as Array<Omit<Field, 'visible'> & Required<Pick<Field, 'visible'>>>;\n\n    if (fields.length === fieldsWithVisibleProp.length) {\n      const {additionalFieldProps, ...props} = this.props;\n\n      const areAllFieldsHidden = fieldsWithVisibleProp.every(field => {\n        if (typeof field.visible === 'function') {\n          return !field.visible({...props, ...additionalFieldProps});\n        }\n        return !field.visible;\n      });\n\n      return !areAllFieldsHidden;\n    }\n\n    return true;\n  }\n\n  renderForm({\n    fields,\n    formPanelProps,\n    title,\n  }: {\n    fields: FieldObject[];\n    formPanelProps: Pick<\n      Props,\n      | 'access'\n      | 'disabled'\n      | 'features'\n      | 'additionalFieldProps'\n      | 'renderFooter'\n      | 'renderHeader'\n    > &\n      Pick<State, 'highlighted'>;\n    title?: React.ReactNode;\n  }) {\n    const shouldDisplayForm = this.shouldDisplayForm(fields);\n\n    if (\n      !shouldDisplayForm &&\n      !formPanelProps?.renderFooter &&\n      !formPanelProps?.renderHeader\n    ) {\n      return null;\n    }\n\n    return <FormPanel title={title} fields={fields} {...formPanelProps} />;\n  }\n\n  render() {\n    const {\n      access,\n      fields,\n      title,\n      forms,\n      disabled,\n      features,\n      additionalFieldProps,\n      renderFooter,\n      renderHeader,\n      location: _location,\n      ...otherProps\n    } = this.props;\n\n    const formPanelProps = {\n      access,\n      disabled,\n      features,\n      additionalFieldProps,\n      renderFooter,\n      renderHeader,\n      highlighted: this.state.highlighted,\n    };\n\n    return (\n      <div {...otherProps}>\n        {typeof forms !== 'undefined' &&\n          forms.map((formGroup, i) => (\n            <React.Fragment key={i}>\n              {this.renderForm({formPanelProps, ...formGroup})}\n            </React.Fragment>\n          ))}\n        {typeof forms === 'undefined' &&\n          typeof fields !== 'undefined' &&\n          this.renderForm({fields, formPanelProps, title})}\n      </div>\n    );\n  }\n}\n\nexport default withRouter(JsonForm);\n","'use strict';\nvar anObject = require('../internals/an-object');\nvar toPrimitive = require('../internals/to-primitive');\n\n// `Date.prototype[@@toPrimitive](hint)` method implementation\n// https://tc39.es/ecma262/#sec-date.prototype-@@toprimitive\nmodule.exports = function (hint) {\n  if (hint !== 'string' && hint !== 'number' && hint !== 'default') {\n    throw TypeError('Incorrect hint');\n  } return toPrimitive(anObject(this), hint !== 'number');\n};\n","var createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar dateToPrimitive = require('../internals/date-to-primitive');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_PRIMITIVE = wellKnownSymbol('toPrimitive');\nvar DatePrototype = Date.prototype;\n\n// `Date.prototype[@@toPrimitive]` method\n// https://tc39.es/ecma262/#sec-date.prototype-@@toprimitive\nif (!(TO_PRIMITIVE in DatePrototype)) {\n  createNonEnumerableProperty(DatePrototype, TO_PRIMITIVE, dateToPrimitive);\n}\n","var defineWellKnownSymbol = require('../internals/define-well-known-symbol');\n\n// `Symbol.toPrimitive` well-known symbol\n// https://tc39.es/ecma262/#sec-symbol.toprimitive\ndefineWellKnownSymbol('toPrimitive');\n"],"sourceRoot":""}