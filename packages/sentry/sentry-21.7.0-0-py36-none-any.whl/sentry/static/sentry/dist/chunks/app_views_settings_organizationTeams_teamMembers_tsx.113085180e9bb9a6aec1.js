(self.webpackChunk=self.webpackChunk||[]).push([["app_views_settings_organizationTeams_teamMembers_tsx"],{"./app/actionCreators/teams.tsx":function(e,t,r){"use strict";r.d(t,{eM:function(){return m},z_:function(){return u},fs:function(){return d},um:function(){return l},s:function(){return p},Cm:function(){return f},tT:function(){return h}}),r("../node_modules/core-js/modules/es.array.concat.js");var n=r("./app/actionCreators/indicator.tsx"),o=r("./app/actions/teamActions.tsx"),s=r("./app/locale.tsx"),a=r("./app/utils/callIfFunction.tsx"),i=r("./app/utils/guid.tsx"),c=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=arguments.length,n=new Array(r>2?r-2:0),o=2;o<r;o++)n[o-2]=arguments[o];a.g.apply(void 0,[e[t]].concat(n))};function m(e,t,r){return o.Z.fetchDetails(t.teamId),e.request("/teams/".concat(t.orgId,"/").concat(t.teamId,"/"),{success:function(e){o.Z.fetchDetailsSuccess(t.teamId,e),c(r,"success",e)},error:function(e){o.Z.fetchDetailsError(t.teamId,e),c(r,"error",e)}})}function u(e,t){o.Z.updateSuccess(e,t)}function d(e,t,r){var n="/teams/".concat(t.orgId,"/").concat(t.teamId,"/");return o.Z.update(t.teamId,t.data),e.request(n,{method:"PUT",data:t.data,success:function(e){u(t.teamId,e),c(r,"success",e)},error:function(e){o.Z.updateError(t.teamId,e),c(r,"error",e)}})}function l(e,t,r){var n,s="/organizations/".concat(t.orgId,"/members/").concat(null!==(n=t.memberId)&&void 0!==n?n:"me","/teams/").concat(t.teamId,"/"),a=(0,i.E)();return o.Z.update(a,t.teamId),e.request(s,{method:"POST",success:function(e){o.Z.updateSuccess(t.teamId,e),c(r,"success",e)},error:function(e){o.Z.updateError(a,t.teamId,e),c(r,"error",e)}})}function p(e,t,r){var n="/organizations/".concat(t.orgId,"/members/").concat(t.memberId||"me","/teams/").concat(t.teamId,"/"),s=(0,i.E)();return o.Z.update(s,t.teamId),e.request(n,{method:"DELETE",success:function(e){o.Z.updateSuccess(t.teamId,e),c(r,"success",e)},error:function(e){o.Z.updateError(s,t.teamId,e),c(r,"error",e)}})}function f(e,t,r){return o.Z.createTeam(t),e.requestPromise("/organizations/".concat(r.orgId,"/teams/"),{method:"POST",data:t}).then((function(e){return o.Z.createTeamSuccess(e),(0,n.S9)((0,s._N)("[team] has been added to the [organization] organization",{team:"#".concat(e.slug),organization:r.orgId})),e}),(function(e){throw o.Z.createTeamError(t.slug,e),(0,n.Iw)((0,s._N)("Unable to create [team] in the [organization] organization",{team:"#".concat(t.slug),organization:r.orgId})),e}))}function h(e,t){return o.Z.removeTeam(t.teamId),e.requestPromise("/teams/".concat(t.orgId,"/").concat(t.teamId,"/"),{method:"DELETE"}).then((function(e){return o.Z.removeTeamSuccess(t.teamId,e),(0,n.S9)((0,s._N)("[team] has been removed from the [organization] organization",{team:"#".concat(t.teamId),organization:t.orgId})),e}),(function(e){throw o.Z.removeTeamError(t.teamId,e),(0,n.Iw)((0,s._N)("Unable to remove [team] from the [organization] organization",{team:"#".concat(t.teamId),organization:t.orgId})),e}))}},"./app/views/settings/organizationTeams/teamMembers.tsx":function(e,t,r){"use strict";r.r(t),r("../node_modules/core-js/modules/es.reflect.construct.js"),r("../node_modules/core-js/modules/es.object.keys.js"),r("../node_modules/core-js/modules/es.symbol.js"),r("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),r("../node_modules/core-js/modules/web.dom-collections.for-each.js"),r("../node_modules/core-js/modules/es.object.get-own-property-descriptors.js");var n=r("../node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),o=r("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),s=r("../node_modules/@babel/runtime/helpers/esm/createClass.js"),a=r("../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),i=r("../node_modules/@babel/runtime/helpers/esm/inherits.js"),c=r("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),m=r("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),u=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),d=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),l=r("../node_modules/@babel/runtime/regenerator/index.js"),p=r.n(l),f=(r("../node_modules/core-js/modules/es.array.concat.js"),r("../node_modules/core-js/modules/es.array.find.js"),r("../node_modules/core-js/modules/es.array.filter.js"),r("../node_modules/core-js/modules/es.array.iterator.js"),r("../node_modules/core-js/modules/es.object.to-string.js"),r("../node_modules/core-js/modules/es.set.js"),r("../node_modules/core-js/modules/es.string.iterator.js"),r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../node_modules/core-js/modules/es.array.map.js"),r("../node_modules/core-js/modules/es.function.name.js"),r("../node_modules/core-js/modules/es.array.includes.js"),r("../node_modules/core-js/modules/es.string.includes.js"),r("../node_modules/react/index.js")),h=r("../node_modules/lodash/debounce.js"),b=r.n(h),g=r("./app/actionCreators/indicator.tsx"),v=r("./app/actionCreators/modal.tsx"),Z=r("./app/actionCreators/teams.tsx"),y=r("./app/components/avatar/userAvatar.tsx"),j=r("./app/components/button.tsx"),I=r("./app/components/dropdownAutoComplete/index.tsx"),w=r("./app/components/dropdownButton.tsx"),x=r("./app/components/idBadge/index.tsx"),_=r("./app/components/links/link.tsx"),M=r("./app/components/loadingError.tsx"),z=r("./app/components/loadingIndicator.tsx"),S=r("./app/components/panels/index.tsx"),k=r("./app/icons/index.tsx"),O=r("./app/locale.tsx"),T=r("./app/styles/overflowEllipsis.tsx"),C=r("./app/styles/space.tsx"),E=r("./app/utils/withApi.tsx"),P=r("./app/utils/withConfig.tsx"),q=r("./app/utils/withOrganization.tsx"),B=r("./app/views/settings/components/emptyMessage.tsx"),R=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function L(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var D=function(e){(0,i.Z)(l,e);var t,r,d=(t=l,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,m.Z)(t);if(r){var o=(0,m.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,c.Z)(this,e)});function l(){var e;(0,o.Z)(this,l);for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return e=d.call.apply(d,[this].concat(r)),(0,u.Z)((0,a.Z)(e),"state",{loading:!0,error:!1,dropdownBusy:!1,teamMemberList:[],orgMemberList:[]}),(0,u.Z)((0,a.Z)(e),"debouncedFetchMembersRequest",b()((function(t){return e.setState({dropdownBusy:!0},(function(){return e.fetchMembersRequest(t)}))}),200)),(0,u.Z)((0,a.Z)(e),"fetchMembersRequest",function(){var t=(0,n.Z)(p().mark((function t(r){var n,o,s,a,i;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.props,o=n.params,s=n.api,a=o.orgId,t.prev=2,t.next=5,s.requestPromise("/organizations/".concat(a,"/members/"),{query:{query:r}});case 5:i=t.sent,e.setState({orgMemberList:i,dropdownBusy:!1}),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(2),(0,g.Iw)((0,O.t)("Unable to load organization members."),{duration:2e3}),e.setState({dropdownBusy:!1});case 13:case"end":return t.stop()}}),t,null,[[2,9]])})));return function(e){return t.apply(this,arguments)}}()),(0,u.Z)((0,a.Z)(e),"fetchData",(0,n.Z)(p().mark((function t(){var r,n,o,s;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.props,n=r.api,o=r.params,t.prev=1,t.next=4,n.requestPromise("/teams/".concat(o.orgId,"/").concat(o.teamId,"/members/"));case 4:s=t.sent,e.setState({teamMemberList:s,loading:!1,error:!1}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),e.setState({loading:!1,error:!0});case 11:e.fetchMembersRequest("");case 12:case"end":return t.stop()}}),t,null,[[1,8]])})))),(0,u.Z)((0,a.Z)(e),"addTeamMember",(function(t){var r=e.props.params;e.setState({loading:!0}),e.debouncedFetchMembersRequest(""),(0,Z.um)(e.props.api,{orgId:r.orgId,teamId:r.teamId,memberId:t.value},{success:function(){var r=e.state.orgMemberList.find((function(e){return e.id===t.value}));void 0!==r&&(e.setState({loading:!1,error:!1,teamMemberList:e.state.teamMemberList.concat([r])}),(0,g.S9)((0,O.t)("Successfully added member to team.")))},error:function(){e.setState({loading:!1}),(0,g.Iw)((0,O.t)("Unable to add team member."))}})})),(0,u.Z)((0,a.Z)(e),"handleMemberFilterChange",(function(t){e.setState({dropdownBusy:!0}),e.debouncedFetchMembersRequest(t.target.value)})),e}return(0,s.Z)(l,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.props.params;e.params.teamId===t.teamId&&e.params.orgId===t.orgId||this.setState({loading:!0,error:!1},this.fetchData)}},{key:"removeMember",value:function(e){var t=this,r=this.props.params;(0,Z.s)(this.props.api,{orgId:r.orgId,teamId:r.teamId,memberId:e.id},{success:function(){t.setState({teamMemberList:t.state.teamMemberList.filter((function(t){return t.id!==e.id}))}),(0,g.S9)((0,O.t)("Successfully removed member from team."))},error:function(){return(0,g.Iw)((0,O.t)("There was an error while trying to remove a member from the team."))}})}},{key:"renderDropdown",value:function(e){var t=this,r=this.props,n=r.organization,o=r.params,s=new Set(this.state.teamMemberList.map((function(e){return e.id}))),a=!(null==n||!n.openMembership)||e,i=(this.state.orgMemberList||[]).filter((function(e){return!s.has(e.id)})).map((function(e){return{searchKey:"".concat(e.name," ").concat(e.email),value:e.id,label:(0,R.BX)(F,{children:[(0,R.tZ)(U,{user:e,size:24,className:"avatar"}),(0,R.tZ)(N,{children:e.name||e.email})]})}})),c=(0,R.BX)(X,{children:[(0,O.t)("Members"),(0,R.tZ)(G,{to:"",onClick:function(){return(0,v.openInviteMembersModal)({source:"teams"})},"data-test-id":"invite-member",children:(0,O.t)("Invite Member")})]});return(0,R.tZ)(I.Z,{items:i,alignMenu:"right",onSelect:a?this.addTeamMember:function(e){return(0,v.openTeamAccessRequestModal)({teamId:o.teamId,orgId:o.orgId,memberId:e.value})},menuHeader:c,emptyMessage:(0,O.t)("No members"),onChange:this.handleMemberFilterChange,busy:this.state.dropdownBusy,onClose:function(){return t.debouncedFetchMembersRequest("")},children:function(e){var t=e.isOpen;return(0,R.tZ)(w.Z,{isOpen:t,size:"xsmall","data-test-id":"add-member",children:(0,O.t)("Add Member")})}})}},{key:"removeButton",value:function(e){var t=this;return(0,R.tZ)(j.ZP,{size:"small",icon:(0,R.tZ)(k.JZ,{size:"xs",isCircled:!0}),onClick:function(){return t.removeMember(e)},label:(0,O.t)("Remove"),children:(0,O.t)("Remove")})}},{key:"render",value:function(){var e=this;if(this.state.loading)return(0,R.tZ)(z.Z,{});if(this.state.error)return(0,R.tZ)(M.Z,{onRetry:this.fetchData});var t=this.props,r=t.params,n=t.organization,o=t.config,s=n.access,a=s.includes("org:write")||s.includes("team:admin");return(0,R.BX)(S.s_,{children:[(0,R.BX)(S.V9,{hasButtons:!0,children:[(0,R.tZ)("div",{children:(0,O.t)("Members")}),(0,R.tZ)("div",{style:{textTransform:"none"},children:this.renderDropdown(a)})]}),this.state.teamMemberList.length?this.state.teamMemberList.map((function(t){var n=t.email===o.user.email,s=a||n;return(0,R.BX)(A,{children:[(0,R.tZ)(x.Z,{avatarSize:36,member:t,useLink:!0,orgId:r.orgId}),s&&e.removeButton(t)]},t.id)})):(0,R.tZ)(B.Z,{icon:(0,R.tZ)(k.qO,{size:"xl"}),size:"large",children:(0,O.t)("This team has no members")})]})}}]),l}(f.Component);D.displayName="TeamMembers";var A=(0,d.Z)(S.Lv,{target:"ekipw4c5"})({name:"zanomh",styles:"justify-content:space-between;align-items:center"}),F=(0,d.Z)("div",{target:"ekipw4c4"})("display:grid;grid-template-columns:max-content 1fr;grid-gap:",(0,C.Z)(.5),";align-items:center;"),N=(0,d.Z)("div",{target:"ekipw4c3"})("font-size:",(function(e){return e.theme.fontSizeSmall}),";",T.Z,";"),U=(0,d.Z)((function(e){return(0,R.tZ)(y.Z,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?L(Object(r),!0).forEach((function(t){(0,u.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e))}),{target:"ekipw4c2"})({name:"1dy9mco",styles:"min-width:1.75em;min-height:1.75em;width:1.5em;height:1.5em"}),X=(0,d.Z)("div",{target:"ekipw4c1"})("display:grid;grid-template-columns:1fr max-content;padding:",(0,C.Z)(1)," 0;font-size:",(function(e){return e.theme.fontSizeExtraSmall}),";text-transform:uppercase;"),G=(0,d.Z)(_.Z,{target:"ekipw4c0"})({name:"kxbue8",styles:"text-transform:none"});t.default=(0,P.Z)((0,E.Z)((0,q.Z)(D)))}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_organizationTeams_teamMembers_tsx.4200b5a79eb81568f4f6fd9a4f2d2a14.js.map