(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-065d1c6e"],{1148:function(t,i,a){"use strict";var e=a("a691"),r=a("1d80");t.exports="".repeat||function(t){var i=String(r(this)),a="",n=e(t);if(n<0||n==1/0)throw RangeError("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(i+=i))1&n&&(a+=i);return a}},"1b67":function(t,i,a){"use strict";a("bf13")},"408a":function(t,i,a){var e=a("c6b6");t.exports=function(t){if("number"!=typeof t&&"Number"!=e(t))throw TypeError("Incorrect invocation");return+t}},9485:function(t,i,a){t.exports=a.p+"static/img/nodata.8290bed9.png"},b0c0:function(t,i,a){var e=a("83ab"),r=a("9bf2").f,n=Function.prototype,o=n.toString,s=/^\s*function ([^ (]*)/,c="name";e&&!(c in n)&&r(n,c,{configurable:!0,get:function(){try{return o.call(this).match(s)[1]}catch(t){return""}}})},b64b:function(t,i,a){var e=a("23e7"),r=a("7b0b"),n=a("df75"),o=a("d039"),s=o((function(){n(1)}));e({target:"Object",stat:!0,forced:s},{keys:function(t){return n(r(t))}})},b680:function(t,i,a){"use strict";var e=a("23e7"),r=a("a691"),n=a("408a"),o=a("1148"),s=a("d039"),c=1..toFixed,u=Math.floor,l=function(t,i,a){return 0===i?a:i%2===1?l(t,i-1,a*t):l(t*t,i/2,a)},p=function(t){var i=0,a=t;while(a>=4096)i+=12,a/=4096;while(a>=2)i+=1,a/=2;return i},h=c&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!s((function(){c.call({})}));e({target:"Number",proto:!0,forced:h},{toFixed:function(t){var i,a,e,s,c=n(this),h=r(t),d=[0,0,0,0,0,0],m="",v="0",f=function(t,i){var a=-1,e=i;while(++a<6)e+=t*d[a],d[a]=e%1e7,e=u(e/1e7)},g=function(t){var i=6,a=0;while(--i>=0)a+=d[i],d[i]=u(a/t),a=a%t*1e7},y=function(){var t=6,i="";while(--t>=0)if(""!==i||0===t||0!==d[t]){var a=String(d[t]);i=""===i?a:i+o.call("0",7-a.length)+a}return i};if(h<0||h>20)throw RangeError("Incorrect fraction digits");if(c!=c)return"NaN";if(c<=-1e21||c>=1e21)return String(c);if(c<0&&(m="-",c=-c),c>1e-21)if(i=p(c*l(2,69,1))-69,a=i<0?c*l(2,-i,1):c/l(2,i,1),a*=4503599627370496,i=52-i,i>0){f(0,a),e=h;while(e>=7)f(1e7,0),e-=7;f(l(10,e,1),0),e=i-1;while(e>=23)g(1<<23),e-=23;g(1<<e),f(1,1),g(2),v=y()}else f(0,a),f(1<<-i,0),v=y()+o.call("0",h);return h>0?(s=v.length,v=m+(s<=h?"0."+o.call("0",h-s)+v:v.slice(0,s-h)+"."+v.slice(s-h))):v=m+v,v}})},bf13:function(t,i,a){},c4ea:function(t,i,a){"use strict";a.r(i);var e=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"cl-resource-content"},[e("div",{staticClass:"dashboard-item"},[e("div",{staticClass:"title-item"},[e("div",{staticClass:"title-text"},[t._v(" "+t._s(t.$t("profiling.structuralCpuUtil"))+" ")]),e("div",{staticClass:"detail-link",class:{disabled:!t.cpuInfo.initOver||t.cpuInfo.noData}},[e("button",{attrs:{disabled:!t.cpuInfo.initOver||t.cpuInfo.noData},on:{click:t.jumpToCpuDetail}},[t._v(" "+t._s(t.$t("profiling.viewDetail"))+" "),e("i",{staticClass:"el-icon-d-arrow-right"})])])]),e("div",{staticClass:"content-item"},[e("div",{directives:[{name:"show",rawName:"v-show",value:!t.cpuInfo.noData,expression:"!cpuInfo.noData"}],staticClass:"cpu-info"},[e("div",{ref:"deviceCpuChart",staticClass:"cpu-chart",attrs:{id:"deviceCpuChart"}}),e("div",{staticClass:"cpu-chart-info"},[e("div",{staticClass:"info-line"},[e("span",[t._v(t._s(t.$t("profiling.logicCores")))]),e("span",[t._v(t._s(t.deviceCpuChart.logicCores))])]),e("div",{staticClass:"info-line"},[e("span",[t._v(t._s(t.$t("profiling.avgUserUtilization")))]),e("span",[t._v(t._s(t.addPercentSign(t.deviceCpuChart.cpuAvgUser)))])]),e("div",{staticClass:"info-line"},[e("span",[t._v(t._s(t.$t("profiling.avgSysUtilization")))]),e("span",[t._v(t._s(t.addPercentSign(t.deviceCpuChart.cpuAvgSystem)))])]),e("div",{staticClass:"info-line"},[e("span",[t._v(t._s(t.$t("profiling.avgIOUtilization")))]),e("span",[t._v(t._s(t.addPercentSign(t.deviceCpuChart.cpuAvgIO)))])]),e("div",{staticClass:"info-line"},[e("span",[t._v(t._s(t.$t("profiling.avgIdleUtilization")))]),e("span",[t._v(t._s(t.addPercentSign(t.deviceCpuChart.cpuAvgFree)))])]),e("div",{staticClass:"info-line"},[e("span",[t._v(t._s(t.$t("profiling.avgWaitingProcess")))]),e("span",[t._v(t._s(t.deviceCpuChart.cpuAvgProcess))])]),e("div",{staticClass:"info-line"},[e("span",[t._v(t._s(t.$t("profiling.avgSwitchCount")))]),e("span",[t._v(t._s(t.deviceCpuChart.cpuAvgSwitch))])])])]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.cpuInfo.noData,expression:"cpuInfo.noData"}],staticClass:"noData-content"},[e("img",{attrs:{src:a("9485"),alt:""}}),e("p",[t._v(t._s(t.cpuInfo.initOver?t.$t("public.noData"):t.$t("public.dataLoading")))])])])]),e("div",{staticClass:"dashboard-item margin-item"},[e("div",{staticClass:"title-item"},[e("div",{staticClass:"title-text"},[t._v(" "+t._s(t.$t("profiling.memory.usedMemory"))+" ")]),e("div",{staticClass:"detail-link",class:{disabled:!t.graphicsInitOver||t.noGraphicsDataFlag}},[e("button",{attrs:{disabled:!t.graphicsInitOver||t.noGraphicsDataFlag},on:{click:t.jumpToMemoryDetail}},[t._v(" "+t._s(t.$t("profiling.viewDetail"))+" "),e("i",{staticClass:"el-icon-d-arrow-right"})])])]),e("div",{staticClass:"content-item"},[e("div",{directives:[{name:"show",rawName:"v-show",value:!t.graphicsInitOver||t.noGraphicsDataFlag,expression:"!graphicsInitOver || noGraphicsDataFlag"}],staticClass:"noData-content"},[e("div",[e("img",{attrs:{src:a("9485"),alt:""}})]),t.graphicsInitOver&&t.noGraphicsDataFlag?e("div",{staticClass:"noData-text"},[t._v(t._s(t.$t("public.noData")))]):e("div",{staticClass:"noData-text"},[t._v(t._s(t.$t("public.dataLoading")))])]),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.noGraphicsDataFlag&&t.graphicsInitOver,expression:"!noGraphicsDataFlag && graphicsInitOver"}],ref:"dashboardMemoryChart",staticClass:"dashboard-chart-content"})])])])},r=[],n=(a("b64b"),a("159b"),a("99af"),a("b0c0"),a("d3b7"),a("25f0"),a("b680"),a("d81d"),a("3778")),o=a("9fac"),s={data:function(){return{queryData:{dir:"",id:"",path:"",activePane:""},summaryPath:"",curCardNum:"",pageResizeTimer:null,firstInit:!0,graphicsInitOver:!1,noGraphicsDataFlag:!1,totalMemory:"-",memoryGraphicsChart:null,deviceCpuChart:{id:"deviceCpuChart",chartDom:null,option:{color:["#c23531","#2f4554","#61a0a8","#d48265"],tooltip:{trigger:"axis",formatter:null,confine:!0,backgroundColor:"rgba(50, 50, 50, 0.7)",borderWidth:0,textStyle:{color:"#fff"}},legend:{right:70,top:8,data:[]},xAxis:{name:"",data:[]},yAxis:{name:this.$t("profiling.utilizationTitle"),type:"value"},dataZoom:[{start:0,end:100,bottom:0},{start:0,end:100,type:"inside",bottom:0}],grid:{left:60,top:40,right:70,bottom:60},series:[]},logicCores:0,cpuAvgUser:0,cpuAvgSystem:0,cpuAvgIO:0,cpuAvgFree:0,cpuAvgProcess:0,cpuAvgSwitch:0},cpuInfo:{initOver:!1,noData:!0,stepArray:[],cpuInfoStr:{user_utilization:this.$t("profiling.userUtilization"),sys_utilization:this.$t("profiling.sysUtilization"),io_utilization:this.$t("profiling.ioUtilization"),idle_utilization:this.$t("profiling.idleUtilization")},samplingInterval:0}}},watch:{"$parent.curDashboardInfo.curCardNum":{handler:function(t){isNaN(t)||t===this.curCardNum||this.firstInit||(this.curCardNum=t,this.noGraphicsDataFlag=!1,this.graphicsInitOver=!1,this.init())},deep:!0,immediate:!0}},mounted:function(){window.addEventListener("resize",this.resizeCallback,!1),this.$bus.$on("collapse",this.resizeCallback),this.queryData={dir:this.$route.query.dir,id:this.$route.query.id,path:this.$route.query.path,activePane:this.$route.query.activePane},this.$route.query&&this.$route.query.path&&!isNaN(this.$route.query.cardNum)&&(this.summaryPath=this.$route.query.path,this.curCardNum=this.$route.query.cardNum,this.init()),this.firstInit=!1},methods:{init:function(){this.getMemorySummary(),this.queryCpuInfo()},resizeCallback:function(){var t=this;this.pageResizeTimer&&(clearTimeout(this.pageResizeTimer),this.pageResizeTimer=null),this.pageResizeTimer=setTimeout((function(){t.memoryGraphicsChart&&t.memoryGraphicsChart.resize(),t.deviceCpuChart.chartDom&&t.deviceCpuChart.chartDom.resize()}),300)},jumpToMemoryDetail:function(){this.$router.push({path:"/profiling/memory-detail",query:{dir:this.queryData.dir,id:this.queryData.id,cardNum:this.curCardNum,path:this.queryData.path,activePane:this.queryData.activePane}})},getMemorySummary:function(){var t=this;if(!this.summaryPath||isNaN(this.curCardNum))return this.noGraphicsDataFlag=!0,void(this.graphicsInitOver=!0);var i={dir:this.summaryPath,device_id:this.curCardNum};n["a"].queryMemorySummary(i).then((function(i){if(i&&i.data&&i.data.summary){var a=i.data.summary;t.totalMemory=isNaN(a.capacity)?"-":a.capacity}else t.totalMemory="-"}),(function(){t.overViewInitOver=!0})).then((function(){t.getMemoryGraphics()}))},getMemoryGraphics:function(){var t=this,i={dir:this.summaryPath,device_id:this.curCardNum};n["a"].queryMemoryGraphics(i).then((function(i){if(t.graphicsInitOver=!0,i&&i.data&&Object.keys(i.data).length){t.noGraphicsDataFlag=!1;var a=i.data[Object.keys(i.data)[0]];t.currentGraphicsDic=a,t.graphicsOption=t.formatGraphicsOption(),t.drawGraphics()}else t.noGraphicsDataFlag=!0}),(function(){t.graphicsInitOver=!0,t.noGraphicsDataFlag=!0}))},formatGraphicsOption:function(){var t=this;if(!this.currentGraphicsDic)return{};var i=this,a=[],e=[],r=[],n=[],o=-1,s=-1;this.currentGraphicsDic.nodes.forEach((function(i,c){i.node_id===t.currentGraphicsDic.fp_start?o=c:i.node_id===t.currentGraphicsDic.bp_end&&(s=c),a.push([i.node_id,t.currentGraphicsDic.lines[c]]),e.push([i.node_id,t.totalMemory]),r.push([i.node_id,t.currentGraphicsDic.static_mem]);var u=[];i.outputs.forEach((function(t){u.push([t.life_start,t.life_end])})),n.push(u)}));var c={id:this.graphicsId,name:this.$t("profiling.memory.curMemorySize"),data:a,type:"line",showSymbol:!1,lineStyle:{color:"#00a5a7"},color:"#00a5a7",markLine:{lineStyle:{color:"#00a5a7"},label:{formatter:function(t){var a="";return a=t.dataIndex?"".concat(i.$t("profiling.memory.bpEnd")).concat(i.$t("symbols.colon")).concat(s):"".concat(i.$t("profiling.memory.fpStart")).concat(i.$t("symbols.colon")).concat(o),a}},symbol:["none","none"],data:[{xAxis:o},{xAxis:s}]},markPoint:{symbol:"emptyCircle",symbolSize:8,itemStyle:{color:"#f45c5e"},data:[{coord:a[this.curSelectedPointIndex]}]}},u={data:e,name:this.$t("profiling.memory.totalMemory"),type:"line",smooth:0,symbol:"none",lineStyle:{color:"#fdca5a"},color:"#fdca5a"},l={data:r,name:this.$t("profiling.memory.staticMenory"),type:"line",smooth:0,symbol:"none",lineStyle:{color:"#3d58a6"},color:"#3d58a6"},p=[c,l],h={};h[this.$t("profiling.memory.curMemorySize")]=!0,h[this.$t("profiling.memory.staticMenory")]=!0;var d=[this.$t("profiling.memory.curMemorySize"),this.$t("profiling.memory.staticMenory")];isNaN(this.totalMemory)||(p.push(u),d.unshift(this.$t("profiling.memory.totalMemory")),h[this.$t("profiling.memory.totalMemory")]=!1);var m={legend:{show:!0,icon:"circle",data:d,selected:h},grid:{top:60,bottom:60},xAxis:{name:this.$t("profiling.memory.chartXaxisUnit"),type:"value",show:!0},yAxis:{name:this.$t("profiling.memory.chartYaxisUnit"),scale:!0,nameGap:24},tooltip:{trigger:"axis",axisPointer:{type:"line"},backgroundColor:"rgba(50, 50, 50, 0.7)",borderWidth:0,textStyle:{color:"#fff"},formatter:function(t){var a="";return t.forEach((function(t){if(t.seriesId===i.graphicsId){var e=t.dataIndex,r=i.currentGraphicsDic.nodes[e];r&&(a="<div>".concat(i.$t("profiling.memory.curOperaterId"))+"".concat(i.$t("symbols.colon")).concat(r.node_id,"</div>")+"<div>".concat(i.$t("profiling.memory.curOperator"))+"".concat(i.$t("symbols.colon")).concat(r.name,"</div>")+"<div>".concat(i.$t("profiling.memory.curOperatorMemorySize"))+"".concat(i.$t("symbols.colon")).concat(i.formmateNummber(r.size),"</div>")+"<div>".concat(i.$t("profiling.memory.curMemorySize"))+"".concat(i.$t("symbols.colon")).concat(i.formmateNummber(i.currentGraphicsDic.lines[e]),"</div>")+"<div>".concat(i.$t("profiling.memory.memoryChanged"))+"".concat(i.$t("symbols.colon")).concat(i.formmateNummber(r.allocated),"</div>"))}})),a}},dataZoom:[{type:"inside",filterMode:"empty",orient:"horizontal",xAxisIndex:0},{type:"slider",filterMode:"empty",orient:"horizontal",xAxisIndex:0,bottom:10}],series:p};return m},drawGraphics:function(){var t=this;this.graphicsOption&&this.$nextTick((function(){t.memoryGraphicsChart||(t.memoryGraphicsChart=o["a"].init(t.$refs.dashboardMemoryChart,null)),t.memoryGraphicsChart.setOption(t.graphicsOption),t.memoryGraphicsChart.resize()}))},formmateNummber:function(t){var i=10,a=1;return!isNaN(t)&&t.toString().length>this.numberLimit?t>a&&t<i?t.toFixed(4):t.toExponential(4):t},addPercentSign:function(t){return 0===t||"0"===t?"0":"".concat(t,"%")},queryCpuInfo:function(){var t=this,i={params:{profile:this.queryData.dir,train_id:this.queryData.id},body:{device_id:this.curCardNum,filter_condition:{}}};this.cpuInfo.noData=!0,this.cpuInfo.initOver=!1,n["a"].getCpuUtilization(i).then((function(i){if(t.cpuInfo.initOver=!0,i&&i.data){t.cpuInfo.noData=!i.data.step_total_num,t.cpuInfo.stepArray=i.data.step_info,t.samplingInterval=i.data.sampling_interval,t.deviceCpuChart.logicCores=i.data.cpu_processor_num;var a=i.data.device_info;a&&t.samplingInterval?t.initDeviceCpu(a):(t.clearCpuChart(),t.cpuInfo.noData=!0)}else t.clearCpuChart()}),(function(){t.clearCpuChart(),t.cpuInfo.initOver=!0}))},clearCpuChart:function(){this.deviceCpuChart.chartDom&&this.deviceCpuChart.chartDom.clear()},formatCpuChartTip:function(t,i){var a=t,e="";if(a&&a.length){var r=["#c23531","#2f4554","#61a0a8","#d48265"],n=a[0].dataIndex;e+="step: ".concat(i[n]),a.forEach((function(t,i){e+='<br><span class="cpu-chart-tip" style="background-color:'.concat(r[i],';"></span>')+"".concat(t.seriesName,": ").concat(t.data)})),e+="</div>"}return e},initDeviceCpu:function(t){var i=this,a=[],e=[];Object.keys(this.cpuInfo.cpuInfoStr).forEach((function(r){var n=t[r];if(n&&n.metrics){var o={type:"line",name:i.cpuInfo.cpuInfoStr[r],data:n.metrics,showSymbol:!1};a.push(o),e.push(o.name)}})),this.deviceCpuChart.cpuAvgUser=t.user_utilization.avg_value,this.deviceCpuChart.cpuAvgSystem=t.sys_utilization.avg_value,this.deviceCpuChart.cpuAvgIO=t.io_utilization.avg_value,this.deviceCpuChart.cpuAvgFree=t.idle_utilization.avg_value,this.deviceCpuChart.cpuAvgProcess=t.runable_processes.avg_value,this.deviceCpuChart.cpuAvgSwitch=t.context_switch_count.avg_value,this.deviceCpuChart.option.series=a,this.deviceCpuChart.option.xAxis.name="".concat(this.$t("profiling.sampleInterval"),"\n").concat(this.$t("symbols.leftbracket")).concat(this.samplingInterval,"ms").concat(this.$t("symbols.rightbracket")),this.deviceCpuChart.option.xAxis.data=t[Object.keys(t)[0]].metrics.map((function(t,i){return i+1})),this.deviceCpuChart.option.legend.data=e,this.deviceCpuChart.option.tooltip.formatter=function(t){return i.formatCpuChartTip(t,i.cpuInfo.stepArray)},this.$nextTick((function(){i.deviceCpuChart.chartDom||i.$refs.deviceCpuChart&&(i.deviceCpuChart.chartDom=o["a"].init(i.$refs.deviceCpuChart)),i.deviceCpuChart.chartDom.setOption(i.deviceCpuChart.option)}))},jumpToCpuDetail:function(){"/profiling/cpu-detail"!==this.$route.path&&this.$router.push({path:"/profiling/cpu-detail",query:{dir:this.queryData.dir,id:this.queryData.id,cardNum:this.curCardNum,path:this.queryData.path,activePane:this.queryData.activePane}})}},destroyed:function(){window.removeEventListener("resize",this.resizeCallback),this.pageResizeTimer&&(clearTimeout(this.pageResizeTimer),this.pageResizeTimer=null),this.$bus.$off("collapse")}},c=s,u=(a("1b67"),a("2877")),l=Object(u["a"])(c,e,r,!1,null,null,null);i["default"]=l.exports},d81d:function(t,i,a){"use strict";var e=a("23e7"),r=a("b727").map,n=a("1dde"),o=a("ae40"),s=n("map"),c=o("map");e({target:"Array",proto:!0,forced:!s||!c},{map:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}})}}]);