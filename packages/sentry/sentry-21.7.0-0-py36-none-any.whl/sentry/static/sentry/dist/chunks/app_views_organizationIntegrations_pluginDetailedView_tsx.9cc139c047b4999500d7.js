(self.webpackChunk=self.webpackChunk||[]).push([["app_views_organizationIntegrations_pluginDetailedView_tsx"],{"./app/views/organizationIntegrations/pluginDetailedView.tsx":function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return M}}),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptors.js");var r=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),o=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),i=n("../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),s=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),a=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),c=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),l=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),u=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),p=(n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.array.find-index.js"),n("../node_modules/core-js/modules/es.array.splice.js"),n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("./app/actionCreators/modal.tsx")),d=n("./app/components/button.tsx"),g=n("./app/components/contextPickerModal.tsx"),f=n("./app/locale.tsx"),m=n("./app/styles/space.tsx"),h=n("./app/utils/withOrganization.tsx"),b=n("./app/views/organizationIntegrations/abstractIntegrationDetailedView.tsx"),j=n("../node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),y=n("../node_modules/@babel/runtime/regenerator/index.js"),v=n.n(y),Z=n("../node_modules/react/index.js"),x=n("./app/actionCreators/indicator.tsx"),k=n("./app/components/acl/access.tsx"),w=n("./app/components/alert.tsx"),_=n("./app/components/confirm.tsx"),I=n("./app/components/idBadge/projectBadge.tsx"),P=n("./app/components/switchButton.tsx"),C=n("./app/icons/index.tsx"),E=n("./app/utils/withApi.tsx"),O=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");var R=function(e){(0,s.Z)(p,e);var t,n,u=(t=p,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return(0,a.Z)(this,e)});function p(){var e;(0,r.Z)(this,p);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=u.call.apply(u,[this].concat(n)),(0,l.Z)((0,i.Z)(e),"pluginUpdate",function(){var t=(0,j.Z)(v().mark((function t(n){var r,o,i,s,a,c=arguments;return v().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=c.length>1&&void 0!==c[1]?c[1]:"POST",o=e.props,i=o.organization,s=o.projectItem,a=o.plugin,t.next=4,e.props.api.requestPromise("/projects/".concat(i.slug,"/").concat(s.projectSlug,"/plugins/").concat(a.id,"/"),{method:r,data:n});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),(0,l.Z)((0,i.Z)(e),"updatePluginEnableStatus",function(){var t=(0,j.Z)(v().mark((function t(n){return v().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=5;break}return t.next=3,e.pluginUpdate({enabled:n});case 3:t.next=7;break;case 5:return t.next=7,e.pluginUpdate({},"DELETE");case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),(0,l.Z)((0,i.Z)(e),"handleReset",(0,j.Z)(v().mark((function t(){return v().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(0,x.E3)((0,f.t)("Removing...")),t.next=4,e.pluginUpdate({reset:!0});case 4:(0,x.S9)((0,f.t)("Configuration was removed")),e.props.onResetConfiguration(e.projectId),e.props.trackIntegrationEvent("integrations.uninstall_completed"),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),(0,x.Iw)((0,f.t)("Unable to remove configuration"));case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))),(0,l.Z)((0,i.Z)(e),"handleUninstallClick",(function(){e.props.trackIntegrationEvent("integrations.uninstall_clicked")})),(0,l.Z)((0,i.Z)(e),"toggleEnablePlugin",function(){var t=(0,j.Z)(v().mark((function t(n){var r,o=arguments;return v().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=!(o.length>1&&void 0!==o[1])||o[1],t.prev=1,(0,x.E3)((0,f.t)("Enabling...")),t.next=5,e.updatePluginEnableStatus(r);case 5:(0,x.S9)(r?(0,f.t)("Configuration was enabled."):(0,f.t)("Configuration was disabled.")),e.props.onPluginEnableStatusChange(n,r),e.props.trackIntegrationEvent(r?"integrations.enabled":"integrations.disabled"),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),(0,x.Iw)(r?(0,f.t)("Unable to enable configuration."):(0,f.t)("Unable to disable configuration."));case 13:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(e){return t.apply(this,arguments)}}()),e}return(0,o.Z)(p,[{key:"projectId",get:function(){return this.props.projectItem.projectId}},{key:"getConfirmMessage",value:function(){return(0,O.tZ)(Z.Fragment,{children:(0,O.tZ)(w.Z,{type:"error",icon:(0,O.tZ)(C.Gy,{size:"md"}),children:(0,f.t)("Deleting this installation will disable the integration for this project and remove any configurations.")})})}},{key:"projectForBadge",get:function(){var e=this.props.projectItem;return{slug:e.projectSlug,platform:e.projectPlatform?e.projectPlatform:void 0}}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,r=t.plugin,o=t.organization,i=t.projectItem;return(0,O.tZ)(z,{children:(0,O.tZ)(k.Z,{access:["org:integrations"],children:function(t){var s=t.hasAccess;return(0,O.BX)(B,{className:n,children:[(0,O.tZ)(L,{children:(0,O.tZ)(I.Z,{project:e.projectForBadge})}),(0,O.tZ)("div",{children:(0,O.tZ)(D,{borderless:!0,icon:(0,O.tZ)(C.iC,{}),disabled:!s,to:"/settings/".concat(o.slug,"/projects/").concat(i.projectSlug,"/plugins/").concat(r.id,"/"),"data-test-id":"integration-configure-button",children:(0,f.t)("Configure")})}),(0,O.tZ)("div",{children:(0,O.tZ)(_.Z,{priority:"danger",onConfirming:e.handleUninstallClick,disabled:!s,confirmText:"Delete Installation",onConfirm:function(){return e.handleReset()},message:e.getConfirmMessage(),children:(0,O.tZ)(D,{disabled:!s,borderless:!0,icon:(0,O.tZ)(C.Fz,{}),"data-test-id":"integration-remove-button",children:(0,f.t)("Uninstall")})})}),(0,O.tZ)(P.Z,{isActive:i.enabled,toggle:function(){return e.toggleEnablePlugin(i.projectId,!i.enabled)},isDisabled:!s})]})}})})}}]),p}(Z.Component);R.displayName="InstalledPlugin";var S=(0,E.Z)(R),z=(0,u.Z)("div",{target:"emrs3rl3"})("padding:",(0,m.Z)(2),";border:1px solid ",(function(e){return e.theme.border}),";border-bottom:none;background-color:",(function(e){return e.theme.background}),";&:last-child{border-bottom:1px solid ",(function(e){return e.theme.border}),";}"),D=(0,u.Z)(d.ZP,{target:"emrs3rl2"})("color:",(function(e){return e.theme.gray300}),";"),B=(0,u.Z)("div",{target:"emrs3rl1"})({name:"s5xdrg",styles:"display:flex;align-items:center"}),L=(0,u.Z)("div",{target:"emrs3rl0"})({name:"b6ci67",styles:"flex:1;box-sizing:border-box;display:flex;flex-direction:row;min-width:0"});function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var A=function(e){(0,s.Z)(d,e);var t,n,u=(t=d,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return(0,a.Z)(this,e)});function d(){var e;(0,r.Z)(this,d);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=u.call.apply(u,[this].concat(n)),(0,l.Z)((0,i.Z)(e),"handleResetConfiguration",(function(t){var n=e.plugin.projectList.slice(),r=n.findIndex((function(e){return e.projectId===t}));r<0||(n.splice(r,1),e.setState({plugins:[U(U({},e.state.plugins[0]),{},{projectList:n})]}))})),(0,l.Z)((0,i.Z)(e),"handlePluginEnableStatus",(function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.plugin.projectList.slice(),o=r.findIndex((function(e){return e.projectId===t}));o<0||(r[o]=U(U({},r[o]),{},{enabled:n}),e.setState({plugins:[U(U({},e.state.plugins[0]),{},{projectList:r})]}))})),(0,l.Z)((0,i.Z)(e),"handleAddToProject",(function(){var t=e.plugin,n=e.props,r=n.organization,o=n.router;e.trackIntegrationEvent("integrations.plugin_add_to_project_clicked"),p.openModal((function(e){return(0,O.tZ)(g.Z,U(U({},e),{},{nextPath:"/settings/".concat(r.slug,"/projects/:projectId/plugins/").concat(t.id,"/"),needProject:!0,needOrg:!1,onFinish:function(t){e.closeModal(),o.push(t)}}))}),{})})),e}return(0,o.Z)(d,[{key:"getEndpoints",value:function(){var e=this.props.params,t=e.orgId,n=e.integrationSlug;return[["plugins","/organizations/".concat(t,"/plugins/configs/?plugins=").concat(n)]]}},{key:"integrationType",get:function(){return"plugin"}},{key:"plugin",get:function(){return this.state.plugins[0]}},{key:"description",get:function(){return this.plugin.description||""}},{key:"author",get:function(){var e;return null===(e=this.plugin.author)||void 0===e?void 0:e.name}},{key:"resourceLinks",get:function(){return this.plugin.resourceLinks||[]}},{key:"installationStatus",get:function(){return this.plugin.projectList.length>0?"Installed":"Not Installed"}},{key:"integrationName",get:function(){return"".concat(this.plugin.name).concat(this.plugin.isHidden?" (Legacy)":"")}},{key:"featureData",get:function(){return this.plugin.featureDescriptions}},{key:"getTabDisplay",value:function(e){return"configurations"===e?"project configurations":"overview"}},{key:"renderTopButton",value:function(e,t){return t?(0,O.tZ)(F,{"data-test-id":"install-button",disabled:e,onClick:this.handleAddToProject,size:"small",priority:"primary",children:(0,f.t)("Add to Project")}):this.renderRequestIntegrationButton()}},{key:"renderConfigurations",value:function(){var e=this,t=this.plugin,n=this.props.organization;return t.projectList.length?(0,O.tZ)("div",{children:t.projectList.map((function(r){return(0,O.tZ)(S,{organization:n,plugin:t,projectItem:r,onResetConfiguration:e.handleResetConfiguration,onPluginEnableStatusChange:e.handlePluginEnableStatus,trackIntegrationEvent:e.trackIntegrationEvent},r.projectId)}))}):this.renderEmptyConfigurations()}}]),d}(b.Z),F=(0,u.Z)(d.ZP,{target:"e13hh9ci0"})("margin-bottom:",(0,m.Z)(1),";"),M=(0,h.Z)(A)}}]);
//# sourceMappingURL=../sourcemaps/app_views_organizationIntegrations_pluginDetailedView_tsx.ca99cea2636049f1bf0e52071f3ac6ef.js.map