{"version":3,"sources":["webpack:///webpack/runtime/chunk loaded","webpack:///webpack/runtime/create fake namespace object","webpack:///indico/web/modules/attachments/client/js/package.js","webpack:///indico/web/modules/attachments/client/js/legacy.js","webpack:///webpack/bootstrap","webpack:///webpack/runtime/compat get default export","webpack:///webpack/runtime/define property getters","webpack:///webpack/runtime/ensure chunk","webpack:///webpack/runtime/global","webpack:///webpack/runtime/hasOwnProperty shorthand","webpack:///webpack/runtime/make namespace object","webpack:///webpack/runtime/node module decorator","webpack:///webpack/runtime/runtimeId","webpack:///webpack/runtime/jsonp chunk loading","webpack:///webpack/startup"],"names":["deferred","leafPrototypes","getProto","window","setupGeneratePackage","eventId","$","on","toggle","this","value","trigger","$form","closeLoader","async","poll","taskId","res","indicoAxios","packageStatusURL","event_id","task_id","error","handleAxiosError","data","download_url","location","href","ajaxForm","handleAjaxError","beforeSubmit","IndicoUI","Dialogs","Util","progress","$T","success","handleFlashes","find","global","HISTORY_API_SUPPORTED","history","pushState","toggleFolder","evt","target","closest","length","toggleClass","next","slideToggle","document","ready","parent","dropdown","setupAttachmentPreview","preventDefault","$this","disabled","hasClass","locator","title","reloadOnChange","undefined","openAttachmentManager","attachment","pageURL","replace","clearHash","back","hash","mobileBrowser","e","initial","indexOf","replaceState","id","format","ajaxDialog","url","build_url","attr","preview","dialogClasses","onClose","off","removeClass","onOpen","popup","dialog","canvas","prev","addClass","from_preview","download","_","defer","stopPropagation","add","which","ui","keyCode","ESCAPE","show","onLoadError","xhr","status","alertPopup","gettext","Indico","User","msg","confirmPrompt","then","Urls","Login","previewAttachment","split","triggerHandler","shiftKey","metaKey","ctrlKey","altKey","setupAttachmentTreeView","setupAttachmentEditor","editor","flagChanged","hidePageHeader","html","attachment_list","ajax","method","complete","itemLocator","AttachmentManager","confirmCloseUnsaved","callbackData","customData","reload","reloadManagementAttachmentInfoColumn","column","ManagementAttachmentInfoColumn","replaceWith","messageIfFolderProtected","protectionField","folderField","protectionInfo","selfProtection","inheritedProtection","folderProtection","selectedFolder","val","prop","hide","children","text","setupAttachmentTooltipButtons","each","button","qtip","content","event","position","my","at","events","style","classes","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","loaded","__webpack_modules__","call","m","O","result","chunkIds","fn","priority","notFulfilled","Infinity","i","fulfilled","j","Object","keys","every","key","splice","n","getter","__esModule","d","a","getPrototypeOf","obj","t","mode","ns","create","r","def","current","getOwnPropertyNames","forEach","definition","o","defineProperty","enumerable","get","Promise","resolve","g","globalThis","Function","prototype","hasOwnProperty","Symbol","toStringTag","nmd","paths","installedChunks","2436","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","chunkLoadingGlobal","self","bind","push","__webpack_exports__"],"mappings":"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","file":"js/module_attachments.672c2bca.bundle.js","sourcesContent":["var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tresult = fn();\n\t\t}\n\t}\n\treturn result;\n};","var getProto = Object.getPrototypeOf ? (obj) => (Object.getPrototypeOf(obj)) : (obj) => (obj.__proto__);\nvar leafPrototypes;\n// create a fake namespace object\n// mode & 1: value is a module id, require it\n// mode & 2: merge all properties of value into the ns\n// mode & 4: return value when already ns object\n// mode & 16: return value when it's Promise-like\n// mode & 8|1: behave like require\n__webpack_require__.t = function(value, mode) {\n\tif(mode & 1) value = this(value);\n\tif(mode & 8) return value;\n\tif(typeof value === 'object' && value) {\n\t\tif((mode & 4) && value.__esModule) return value;\n\t\tif((mode & 16) && typeof value.then === 'function') return value;\n\t}\n\tvar ns = Object.create(null);\n\t__webpack_require__.r(ns);\n\tvar def = {};\n\tleafPrototypes = leafPrototypes || [null, getProto({}), getProto([]), getProto(getProto)];\n\tfor(var current = mode & 2 && value; typeof current == 'object' && !~leafPrototypes.indexOf(current); current = getProto(current)) {\n\t\tObject.getOwnPropertyNames(current).forEach((key) => (def[key] = () => (value[key])));\n\t}\n\tdef['default'] = () => (value);\n\t__webpack_require__.d(ns, def);\n\treturn ns;\n};","// This file is part of Indico.\n// Copyright (C) 2002 - 2021 CERN\n//\n// Indico is free software; you can redistribute it and/or\n// modify it under the terms of the MIT License; see the\n// LICENSE file for more details.\n\n/* global handleFlashes:false, handleAjaxError:false */\n\nimport packageStatusURL from 'indico-url:attachments.package_status';\n\nimport {indicoAxios, handleAxiosError} from 'indico/utils/axios';\nimport {$T} from 'indico/utils/i18n';\n\nwindow.setupGeneratePackage = function setupGeneratePackage(eventId) {\n  $('#filter_type input:radio').on('change', function() {\n    $('#form-group-sessions').toggle(this.value === 'sessions');\n    $('#form-group-contributions').toggle(this.value === 'contributions');\n    $('#form-group-dates').toggle(this.value === 'dates');\n  });\n  $('#filter_type input:radio:checked').trigger('change');\n\n  const $form = $('#download-package-form');\n  let closeLoader;\n\n  async function poll(taskId) {\n    let res;\n    try {\n      res = await indicoAxios.get(packageStatusURL({event_id: eventId, task_id: taskId}));\n    } catch (error) {\n      handleAxiosError(error);\n      closeLoader();\n      return;\n    }\n    if (res.data.download_url) {\n      window.location.href = res.data.download_url;\n      closeLoader();\n    } else {\n      poll(taskId);\n    }\n  }\n\n  $form.ajaxForm({\n    error(...args) {\n      closeLoader();\n      handleAjaxError(...args);\n    },\n    beforeSubmit() {\n      closeLoader = IndicoUI.Dialogs.Util.progress($T.gettext('Building package'));\n    },\n    success(data) {\n      if (data.success) {\n        poll(data.task_id);\n      } else {\n        handleFlashes(data, true, $form.find('.flashed-messages'));\n        closeLoader();\n      }\n    },\n  });\n};\n","// This file is part of Indico.\n// Copyright (C) 2002 - 2021 CERN\n//\n// Indico is free software; you can redistribute it and/or\n// modify it under the terms of the MIT License; see the\n// LICENSE file for more details.\n\n(function(global) {\n  const HISTORY_API_SUPPORTED = !!history.pushState;\n\n  function toggleFolder(evt) {\n    if ($(evt.target).closest('.actions').length) {\n      // ignore if it comes from inside the action panel\n      return;\n    }\n    $(this)\n      .toggleClass('collapsed')\n      .next('.sub-tree')\n      .find('td > div')\n      .slideToggle(150);\n  }\n\n  $(document).ready(function() {\n    $('.attachments > .i-dropdown')\n      .parent()\n      .dropdown();\n    if (!$('html').data('static-site')) {\n      setupAttachmentPreview();\n    }\n\n    $(document).on('click', '[data-attachment-editor]', function(evt) {\n      evt.preventDefault();\n      const $this = $(this);\n      if (this.disabled || $this.hasClass('disabled')) {\n        return;\n      }\n      const locator = $(this).data('locator');\n      const title = $(this).data('title');\n      const reloadOnChange = $this.data('reload-on-change') !== undefined;\n      openAttachmentManager(locator, title, reloadOnChange, $this);\n    });\n  });\n\n  global.setupAttachmentPreview = function setupAttachmentPreview() {\n    const attachment = $('.js-preview-dialog');\n    const pageURL = location.href.replace(/#.*$/, '');\n\n    // Previewer not supported on mobile browsers\n    if ($.mobileBrowser) {\n      return;\n    }\n\n    $(window)\n      .on('hashchange', function(e, initial) {\n        if (location.hash.indexOf('#preview:') !== 0) {\n          $('.attachment-preview-dialog').trigger('ajaxDialog:close', [true]);\n        } else {\n          if (initial && HISTORY_API_SUPPORTED) {\n            const hash = location.hash;\n            // start with a clean state, i.e. [..., page, page+preview]\n            history.replaceState({}, document.title, pageURL);\n            history.pushState({}, document.title, location.href + hash);\n          }\n          const id = location.hash.split('#preview:')[1];\n          previewAttachment(id);\n        }\n      })\n      .triggerHandler('hashchange', [true]);\n\n    attachment.on('click', function(e) {\n      if (e.which != 1 || e.shiftKey || e.metaKey || e.ctrlKey || e.altKey) {\n        // ignore middle clicks and modifier-clicks - people should be able to open\n        // an attachment in a new tab/window skipping the previewer, even if they use\n        // a weird mouse with less than three buttons.\n        return;\n      }\n      e.preventDefault();\n      location.hash = '#preview:{0}'.format($(this).data('attachmentId'));\n    });\n\n    function clearHash() {\n      if (HISTORY_API_SUPPORTED) {\n        // if we have the history api, we can assume that the previous state is the same page without\n        // a preview hash (since we ensure this in the initial/fake hashchange event on page load)\n        history.back();\n      } else {\n        // old browsers with no pushState support: the # wil stay which is a bit ugly,\n        // but let's not break history (we WILL \"spam\" history though, but that's what you\n        // get when using ancient browsers)\n        location.hash = '';\n      }\n    }\n\n    function previewAttachment(id) {\n      const attachment = $('.attachment[data-previewable][data-attachment-id=\"{0}\"]'.format(id));\n      if (!attachment.length) {\n        clearHash();\n        return;\n      }\n      ajaxDialog({\n        url: build_url(attachment.attr('href'), {preview: '1'}),\n        title: attachment.data('title'),\n        dialogClasses: 'attachment-preview-dialog',\n        onClose(data) {\n          $('body').off('keydown.attachmentPreview');\n          $('html, body').removeClass('prevent-scrolling');\n          if (!data) {\n            // get rid of the hash if we closed the dialog manually (i.e. not using the back button,\n            // in which case the hash should already be gone)\n            clearHash();\n          }\n        },\n        onOpen(popup) {\n          const dialog = popup.canvas.closest('.ui-dialog');\n          dialog.prev('.ui-widget-overlay').addClass('attachment-preview-overlay');\n          popup.canvas\n            .find('.attachment-preview-content-wrapper, .js-close-preview')\n            .on('click', function() {\n              popup.canvas.trigger('ajaxDialog:close');\n            });\n          popup.canvas.find('.attachment-download').on('click', function() {\n            const $this = $(this);\n            const href = $this.attr('href');\n            $this.attr('href', build_url(href, {from_preview: '1', download: '1'}));\n            _.defer(function() {\n              $this.attr('href', href);\n            });\n          });\n          popup.canvas\n            .find('.attachment-preview-content, .attachment-preview-top-bar')\n            .on('click', function(e) {\n              e.stopPropagation();\n            });\n          $('body')\n            .add(dialog)\n            .on('keydown.attachmentPreview', function(e) {\n              if (e.which === $.ui.keyCode.ESCAPE) {\n                popup.canvas.trigger('ajaxDialog:close');\n              }\n            });\n          $('html, body').addClass('prevent-scrolling');\n          // for some reason the dialog is hidden when its position\n          // gets updated so we explicitly show it.\n          _.defer(function() {\n            dialog.show();\n          });\n        },\n        onLoadError(xhr) {\n          const hash = location.hash;\n          clearHash();\n          if (xhr.status == 404) {\n            alertPopup($T.gettext('This file no longer exists. Please reload the page.'));\n            return false;\n          } else if (xhr.status != 403) {\n            return;\n          }\n          if (Indico.User && Indico.User.id !== undefined) {\n            alertPopup($T('You are not authorized to access this file.'), $T('Access Denied'));\n          } else {\n            const msg = $T('This file is protected. You will be redirected to the login page.');\n            confirmPrompt(msg, $T('Access Denied')).then(function() {\n              location.href = build_url(Indico.Urls.Login, {next: location.href + hash});\n            });\n          }\n          return false;\n        },\n      });\n    }\n  };\n\n  global.setupAttachmentTreeView = function setupAttachmentTreeView() {\n    $('.attachments-box').on('click', '.tree .expandable', toggleFolder);\n  };\n\n  global.setupAttachmentEditor = function setupAttachmentEditor() {\n    const editor = $('.attachment-editor');\n\n    function flagChanged() {\n      editor.trigger('ajaxDialog:setData', [true]);\n    }\n\n    editor\n      .on('click', '.tree .expandable', toggleFolder)\n      .on('click', '.js-dialog-action', function(e) {\n        e.preventDefault();\n        const $this = $(this);\n        ajaxDialog({\n          trigger: this,\n          url: $this.data('href'),\n          title: $this.data('title'),\n          hidePageHeader: true,\n          onClose(data) {\n            if (data) {\n              $('#attachments-container').html(data.attachment_list);\n              flagChanged();\n            }\n          },\n        });\n      })\n      .on('indico:confirmed', '.js-delete', function(e) {\n        e.preventDefault();\n\n        const $this = $(this);\n        $.ajax({\n          url: $this.data('href'),\n          method: $this.data('method'),\n          complete: IndicoUI.Dialogs.Util.progress(),\n          error: handleAjaxError,\n          success(data) {\n            $('#attachments-container').html(data.attachment_list);\n            handleFlashes(data, true, editor);\n            flagChanged();\n          },\n        });\n      });\n  };\n\n  global.openAttachmentManager = function openAttachmentManager(\n    itemLocator,\n    title,\n    reloadOnChange,\n    trigger\n  ) {\n    reloadOnChange = reloadOnChange === undefined ? true : reloadOnChange;\n    ajaxDialog({\n      trigger,\n      url: build_url(Indico.Urls.AttachmentManager, itemLocator),\n      title: title || $T.gettext('Manage material'),\n      confirmCloseUnsaved: false,\n      hidePageHeader: true,\n      onClose(callbackData, customData) {\n        if (customData && reloadOnChange) {\n          location.reload();\n        } else if (customData && trigger) {\n          trigger.trigger('attachments:updated');\n        }\n      },\n    });\n  };\n\n  global.reloadManagementAttachmentInfoColumn = function reloadManagementAttachmentInfoColumn(\n    itemLocator,\n    column\n  ) {\n    $.ajax({\n      url: build_url(Indico.Urls.ManagementAttachmentInfoColumn, itemLocator),\n      method: 'GET',\n      error: handleAjaxError,\n      success(data) {\n        column.replaceWith(data.html);\n      },\n    });\n  };\n\n  global.messageIfFolderProtected = function messageIfFolderProtected(\n    protectionField,\n    folderField,\n    protectionInfo,\n    selfProtection,\n    inheritedProtection,\n    folderProtection\n  ) {\n    folderField.on('change', function() {\n      const selectedFolder = $(this);\n      if (protectionInfo[selectedFolder.val()] && !protectionField.prop('checked')) {\n        selfProtection.hide();\n        inheritedProtection.hide();\n        folderProtection\n          .find('.folder-name')\n          .html(selectedFolder.children('option:selected').text());\n        folderProtection.show();\n      } else {\n        folderProtection.hide();\n        selfProtection.toggle(protectionField.prop('checked'));\n        inheritedProtection.toggle(!protectionField.prop('checked'));\n      }\n    });\n    _.defer(function() {\n      folderField.triggerHandler('change');\n    });\n  };\n\n  global.setupAttachmentTooltipButtons = function setupAttachmentTooltipButtons() {\n    $('.attachments-tooltip-button').each(function() {\n      const button = $(this);\n      button.qtip({\n        content: {\n          text: button.next('.material_list'),\n        },\n        show: {\n          event: 'click',\n        },\n        hide: {\n          event: 'unfocus',\n        },\n        position: {\n          my: 'top right',\n          at: 'bottom left',\n        },\n        events: {\n          show() {\n            button.addClass('open');\n          },\n          hide() {\n            button.removeClass('open');\n          },\n        },\n        style: {\n          classes: 'material_tip',\n        },\n      });\n    });\n  };\n})(window);\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","// The chunk loading function for additional chunks\n// Since all referenced chunks are already included\n// in this file, this function is empty here.\n__webpack_require__.e = () => (Promise.resolve());","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = (module) => {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","__webpack_require__.j = 2436;","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t2436: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tfor(moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) var result = runtime(__webpack_require__);\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkIds[i]] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunk\"] = self[\"webpackChunk\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [5514,3044,8592], () => (__webpack_require__(56161)))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"sourceRoot":""}