{"version":3,"sources":["webpack:///./app/actionCreators/plugins.tsx","webpack:///./app/actions/pluginActions.tsx","webpack:///./app/components/pluginConfig.tsx","webpack:///./app/stores/pluginsStore.tsx","webpack:///./app/utils/withPlugins.tsx","webpack:///./app/views/asyncView.tsx","webpack:///./app/views/settings/projectPlugins/details.tsx"],"names":["activeFetch","api","Client","doUpdate","orgId","projectId","pluginId","update","params","PluginActions","request","requestPromise","then","catch","resp","err","responseJSON","detail","Error","fetchPlugins","options","path","method","includeAllArgs","data","jqXHR","pageLinks","getResponseHeader","enablePlugin","addLoadingMessage","t","enabled","addSuccessMessage","addErrorMessage","disablePlugin","Reflux","PluginConfig","loading","plugins","props","testResults","onDisablePlugin","setState","getPluginEndpoint","test","JSON","stringify","this","loadPlugin","nextProps","nextState","isEqual","state","organization","project","slug","id","__html","doc","className","hasButtons","PluginName","StyledPluginIcon","name","canDisable","Actions","isTestable","TestPluginButton","onClick","handleTestPlugin","size","handleDisablePlugin","status","type","StyledPanelBody","dangerouslySetInnerHTML","createMarkup","renderSettings","Component","withApi","PluginIcon","space","Button","PanelBody","defaultState","error","PluginStoreConfig","updating","Map","reset","getInitialState","getState","Array","from","values","init","listenTo","onFetchAll","onFetchAllSuccess","onFetchAllError","onUpdate","onUpdateSuccess","onUpdateError","triggerState","trigger","resetLoading","map","plugin","updateObj","get","newPlugin","set","_updateObj","delete","origPlugin","WrappedComponent","WithPlugins","PluginsStore","undefined","prevProps","_prevState","prevContext","prevOrg","prevProject","defined","isOrgSame","isProjectSame","unsubscribe","React","getDisplayName","withOrganization","withProject","AsyncView","title","getTitle","renderComponent","AsyncComponent","ProjectPluginDetails","trackIntegrationEvent","integration","integration_type","view","success","pluginDetails","analyticsChangeEnableStatus","eventKey","recordDetailsViewed","value","split","find","getEnabled","enable","StyledButton","handleEnable","disable","priority","handleDisable","toggleEnable","handleReset","action","renderActions","author","url","href","trimSchema","version","description","resourceLinks","withPlugins"],"mappings":"wnDAUA,IAAMA,EAAc,GAEdC,EAAM,IAAIC,KAuBhB,SAASC,EAAT,GAAmF,IAAhEC,EAAgE,EAAhEA,MAAOC,EAAyD,EAAzDA,UAAWC,EAA8C,EAA9CA,SAAUC,EAAoC,EAApCA,OAAWC,GAAyB,YACjFC,WAAqBH,EAAUC,GAC/B,IAAMG,EAAUT,EAAIU,eAAJ,oBACDP,EADC,YACQC,EADR,oBAC6BC,EAD7B,UAGTE,IAiBP,OAZAE,EACGE,MAAK,WACJH,kBAA4BH,EAAUC,MAEvCM,OAAM,SAAAC,GACL,IAAMC,EACJD,GAAQA,EAAKE,cAAoD,iBAA7BF,EAAKE,aAAaC,OAClD,IAAIC,MAAMJ,EAAKE,aAAaC,QAC5B,IAAIC,MAAM,2BAChBT,gBAA0BH,EAAUC,EAAQQ,MAGzCL,EAaF,SAASS,EAAT,EAELC,GACmB,IAFlBhB,EAEkB,EAFlBA,MAAOC,EAEW,EAFXA,UAGFgB,EAAO,aAAH,OAAgBjB,EAAhB,YAAyBC,EAAzB,aAGV,GAAIL,EAAYqB,GACd,OAAOrB,EAAYqB,GAGrBZ,aAAuBW,GACvB,IAAMV,EAAUT,EAAIU,eAAeU,EAAM,CACvCC,OAAQ,MACRC,gBAAgB,IAoBlB,OAjBAvB,EAAYqB,GAAQX,EAGpBA,EACGE,MAAK,YAAsB,mBAApBY,EAAoB,KAAXC,GAAW,WAK1B,OAJAhB,oBAA8Be,EAAM,CAClCE,UAAWD,GAASA,EAAME,kBAAkB,UAGvCH,KAERX,OAAM,SAAAE,GAEL,MADAN,kBAA4BM,GACtB,IAAIG,MAAM,8BAEjBN,MAAK,kBAAOZ,EAAYqB,GAAQ,QAE5BX,EAQF,SAASkB,EAAapB,GAE3B,OADAqB,SAAkBC,OAAE,gBACb3B,EAAS,EAAD,KAAKK,GAAL,IAAaD,OAAQ,CAACwB,SAAS,GAAOT,OAAQ,UAC1DV,MAAK,kBAAMoB,SAAkBF,OAAE,0BAC/BjB,OAAM,kBAAMoB,SAAgBH,OAAE,+BAM5B,SAASI,EAAc1B,GAE5B,OADAqB,SAAkBC,OAAE,iBACb3B,EAAS,EAAD,KAAKK,GAAL,IAAaD,OAAQ,CAACwB,SAAS,GAAQT,OAAQ,YAC3DV,MAAK,kBAAMoB,SAAkBF,OAAE,2BAC/BjB,OAAM,kBAAMoB,SAAgBH,OAAE,kC,8GC5H7BrB,E,MAAgB0B,iBAAqB,CACzC,SACA,cACA,gBACA,WACA,kBACA,kBAGF,O,07CCuBMC,E,wnBAKW,CACbC,SAAUC,cAAiB,EAAKC,MAAMf,MACtCgB,YAAa,M,yCAiCO,WACpB,EAAKD,MAAME,gBAAgB,EAAKF,MAAMf,U,uDAGrB,2FACjB,EAAKkB,SAAS,CAACF,YAAa,MAC5BX,SAAkBC,OAAE,oBAFH,kBAKI,EAAKS,MAAMtC,IAAIU,eAAe,EAAKgC,oBAAqB,CACzErB,OAAQ,OACRE,KAAM,CACJoB,MAAM,KARK,OAKTpB,EALS,OAYf,EAAKkB,SAAS,CAACF,YAAaK,KAAKC,UAAUtB,EAAKP,WAChDe,SAAkBF,OAAE,mBAbL,mDAefG,SACEH,OAAE,8EAhBW,2D,kDAlCnB,WACEiB,KAAKC,WAAWD,KAAKR,MAAMf,Q,8CAG7B,SAAiCyB,GAC/BF,KAAKC,WAAWC,EAAUzB,Q,mCAG5B,SAAsByB,EAAkBC,GACtC,OAAQC,IAAQD,EAAWH,KAAKK,SAAWD,IAAQF,EAAUzB,KAAMuB,KAAKR,MAAMf,Q,wBAGhF,SAAWA,GAAc,WACvBuB,KAAKL,SACH,CACEL,SAAS,IAEX,WACEC,UAAad,GAAM,WACjB,EAAKkB,SAAS,CAACL,SAAS,Y,+BAMhC,WACE,MAAsCU,KAAKR,MAApCc,EAAP,EAAOA,aAAcC,EAArB,EAAqBA,QAAS9B,EAA9B,EAA8BA,KAC9B,0BAAoB6B,EAAaE,KAAjC,YAAyCD,EAAQC,KAAjD,oBAAiE/B,EAAKgC,GAAtE,O,0BA4BF,WACE,MAAO,CAACC,OAAQV,KAAKR,MAAMf,KAAKkC,O,oBAGlC,WACE,IAAOlC,EAAQuB,KAAKR,MAAbf,KAEDO,OAC0B,IAAvBgB,KAAKR,MAAMR,QAA0BgB,KAAKR,MAAMR,QAAUP,EAAKO,QAExE,OACE,QAAC,KAAD,CACE4B,UAAS,0CAAqCnC,EAAKgC,IACnD,eAAa,gBAFf,WAIE,QAAC,KAAD,CAAaI,YAAU,EAAvB,WACE,QAACC,EAAD,YACE,QAACC,EAAD,CAAkBxD,SAAUkB,EAAKgC,MACjC,yBAAOhC,EAAKuC,UAGbvC,EAAKwC,YAAcjC,IAClB,QAACkC,EAAD,WACGzC,EAAK0C,aACJ,QAACC,EAAD,CAAkBC,QAASrB,KAAKsB,iBAAkBC,KAAK,QAAvD,UACGxC,OAAE,kBAGP,QAAC,KAAD,CAAQwC,KAAK,QAAQF,QAASrB,KAAKwB,oBAAnC,UACGzC,OAAE,mBAMM,SAAhBN,EAAKgD,SACJ,QAAC,KAAD,CAAYC,KAAK,UAAjB,UACG3C,OAAE,kEAIqB,KAA3BiB,KAAKK,MAAMZ,cACV,QAAC,KAAD,CAAYiC,KAAK,OAAjB,WACE,6CACA,wBAAM1B,KAAKK,MAAMZ,kBAIrB,QAACkC,EAAD,YACE,eAAKC,wBAAyB5B,KAAK6B,iBAClC7B,KAAKK,MAAMf,SACV,QAAC,IAAD,IAEAC,SAAYd,GAAMqD,eAAe,CAC/BxB,aAAcN,KAAKR,MAAMc,aACzBC,QAASP,KAAKR,MAAMe,oB,GAxHPwB,aAArB1C,E,mCAAAA,E,eACkB,CACpBK,gBAAiB,eAgIrB,KAAesC,OAAQ3C,GAEvB,IAAMyB,GAAa,OAAO,MAAP,sBAAH,iEAMVC,GAAmB,OAAOkB,KAAP,sBAAH,iBACJC,OAAM,GADF,KAIhBhB,GAAU,OAAO,MAAP,sBAAH,sCAGPE,GAAmB,OAAOe,KAAP,sBAAH,iBACJD,OAAM,GADF,KAIhBP,GAAkB,OAAOS,IAAP,sBAAH,YACRF,OAAM,GADE,uB,yxECvKrB,IAAMG,EAAe,CACnB/C,SAAS,EACTC,QAAS,GACT+C,MAAO,KACP3D,UAAW,MAGP4D,EAAmE,CACvEhD,QAAS,KACTc,MAAO,EAAF,GAAMgC,GACXG,SAAU,IAAIC,IAEdC,MALuE,WAUrE,OAHA1C,KAAKT,QAAU,KACfS,KAAKK,MAAL,KAAiBgC,GACjBrC,KAAKwC,SAAW,IAAIC,IACbzC,KAAKK,OAGdsC,gBAbuE,WAcrE,OAAO3C,KAAK4C,YAGdA,SAjBuE,WAkBrE,MAAsC5C,KAAKK,MAE3C,OAFA,EAAOd,QAEP,QAFA,aAEA,IAEEA,QAASS,KAAKT,QAAUsD,MAAMC,KAAK9C,KAAKT,QAAQwD,UAAY,MAIhEC,KA1BuE,WA2BrEhD,KAAK0C,QACL1C,KAAKiD,SAASvF,aAAwBsC,KAAKkD,YAC3ClD,KAAKiD,SAASvF,oBAA+BsC,KAAKmD,mBAClDnD,KAAKiD,SAASvF,kBAA6BsC,KAAKoD,iBAChDpD,KAAKiD,SAASvF,WAAsBsC,KAAKqD,UACzCrD,KAAKiD,SAASvF,kBAA6BsC,KAAKsD,iBAChDtD,KAAKiD,SAASvF,gBAA2BsC,KAAKuD,gBAGhDC,aApCuE,WAqCrExD,KAAKyD,QAAQzD,KAAK4C,aAGpBM,WAxCuE,WAwCb,6DAAJ,GAA1CQ,EAA8C,EAA9CA,aACNA,IACF1D,KAAKK,MAAMf,SAAU,EACrBU,KAAKK,MAAMiC,MAAQ,KACnBtC,KAAKT,QAAU,MAGjBS,KAAKwD,gBAGPL,kBAlDuE,SAkDrD1E,EAlDqD,GAkDF,IAAlCE,EAAkC,EAAlCA,UACjCqB,KAAKT,QAAU,IAAIkD,IAAIhE,EAAKkF,KAAI,SAAAC,GAAM,MAAI,CAACA,EAAOnD,GAAImD,OACtD5D,KAAKK,MAAM1B,UAAYA,GAAa,KACpCqB,KAAKK,MAAMf,SAAU,EACrBU,KAAKwD,gBAGPJ,gBAzDuE,SAyDvDpF,GACdgC,KAAKT,QAAU,KACfS,KAAKK,MAAMf,SAAU,EACrBU,KAAKK,MAAMiC,MAAQtE,EACnBgC,KAAKwD,gBAGPH,SAhEuE,SAgE9D5C,EAAYoD,GACnB,GAAK7D,KAAKT,QAAV,CAIA,IAAMqE,EAAS5D,KAAKT,QAAQuE,IAAIrD,GAChC,GAAKmD,EAAL,CAGA,IAAMG,EAAY,EAAH,KACVH,GACAC,GAGL7D,KAAKT,QAAQyE,IAAIvD,EAAIsD,GACrB/D,KAAKwC,SAASwB,IAAIvD,EAAImD,GACtB5D,KAAKwD,kBAGPF,gBAnFuE,SAmFvD7C,EAAYwD,GAC1BjE,KAAKwC,SAAS0B,OAAOzD,IAGvB8C,cAvFuE,SAuFzD9C,EAAYwD,EAA6BjG,GACrD,IAAMmG,EAAanE,KAAKwC,SAASsB,IAAIrD,GAChC0D,GAAenE,KAAKT,UAIzBS,KAAKT,QAAQyE,IAAIvD,EAAI0D,GACrBnE,KAAKwC,SAAS0B,OAAOzD,GACrBT,KAAKK,MAAMiC,MAAQtE,EACnBgC,KAAKwD,kBAQT,EAFoBpE,gBAAmBmD,G,6yBC9BvC,MAvEA,SACE6B,GACA,IACMC,EADN,6B,IAAA,G,EAAA,E,gaAAA,gLAMU,CAAC9E,QAAS,GAAID,SAAS,KANjC,gCA4CgBgF,UAAoB,YAA+B,IAA7B/E,EAA6B,EAA7BA,QAASD,EAAoB,EAApBA,QAG3C,EAAKK,SAAS,CAACJ,UAASD,mBACvBiF,IAhDL,kDAQE,WACEvE,KAAK5B,iBATT,gCAYE,SAAmBoG,EAAWC,EAAYC,GACxC,MAAgC1E,KAAKR,MAA9Bc,EAAP,EAAOA,aAAcC,EAArB,EAAqBA,QAGfoE,EAAUH,EAAUlE,eAAgBoE,aAA1B,EAA0BA,EAAapE,cACjDsE,EAAcJ,EAAUjE,UAAWmE,aAArB,EAAqBA,EAAanE,SAQtD,IAAKsE,QAAQD,KAAiBC,QAAQF,GAAtC,CAIA,IAAMG,EAAYH,EAAQnE,OAASF,EAAaE,KAC1CuE,EAAgBH,EAAYpE,QAASD,aAArB,EAAqBA,EAASC,MAGhDsE,GAAaC,GAIjB/E,KAAK5B,kBArCT,kCAwCE,WACE4B,KAAKgF,gBAzCT,0BAkDE,WACE,MAAgChF,KAAKR,MAA9Bc,EAAP,EAAOA,aAAcC,EAArB,EAAqBA,QAEhBA,GAAYD,IAIjBlC,QAAa,CAACd,UAAWiD,EAAQC,KAAMnD,MAAOiD,EAAaE,SAzD/D,oBA4DE,WACE,OACE,QAAC4D,EAAD,OAAuBpE,KAAKR,OAA5B,IAA2DD,QAASS,KAAKK,aA9D/E,GAC0B4E,aAiE1B,OAjEMZ,EADN,kCACMA,EADN,qCAKsCa,OAAed,GALrD,OAkEOe,QAAiBC,OAAYf,M,muBCpFjBgB,E,0iBAInB,WACE,MAAO,K,oBAGT,WACE,IAAMC,EAAQtF,KAAKuF,WACnB,OACE,QAAC,IAAD,CAAeD,MAAK,UAAKA,EAAQ,GAAH,OAAMA,EAAN,OAAmB,GAA7B,UAApB,SACGtF,KAAKwF,wB,GATJC,KAHWJ,E,kyDCiCfK,E,+nBA2CU,WACZ,MAAqC,EAAKlG,MAAM/B,OAAzCH,EAAP,EAAOA,UAAWD,EAAlB,EAAkBA,MAAOE,EAAzB,EAAyBA,UAEzBuB,SAAkBC,OAAE,qBACpB4G,QACE,iCACA,CACEC,YAAarI,EACbsI,iBAAkB,SAClBC,KAAM,kBAER,EAAKtG,MAAMc,cAGb,EAAKpD,IAAIS,QAAT,oBAA8BN,EAA9B,YAAuCC,EAAvC,oBAA4DC,EAA5D,KAAyE,CACvEgB,OAAQ,OACRE,KAAM,CAACiE,OAAO,GACdqD,QAAS,SAAAC,GACP,EAAKrG,SAAS,CAACqG,mBACf/G,SAAkBF,OAAE,sBACpB4G,QACE,mCACA,CACEC,YAAarI,EACbsI,iBAAkB,SAClBC,KAAM,kBAER,EAAKtG,MAAMc,eAGfgC,MAAO,YACLpD,SAAgBH,OAAE,6B,kCAKT,YACbF,QAAa,EAAKW,MAAM/B,QACxB,EAAKwI,6BAA4B,O,mCAGnB,YACd9G,QAAc,EAAKK,MAAM/B,QACzB,EAAKwI,6BAA4B,O,iDAGL,SAACjH,GAC7B,IAAOzB,EAAY,EAAKiC,MAAM/B,OAAvBF,SACD2I,EAAWlH,EAAU,uBAAyB,yBACpD2G,QACEO,EACA,CACEN,YAAarI,EACbsI,iBAAkB,SAClBC,KAAM,kBAER,EAAKtG,MAAMc,iB,mDAlGf,SAAmBkE,EAAkBE,IACnC,iEAAyBF,EAAWE,GAChCF,EAAU/G,OAAOF,WAAayC,KAAKR,MAAM/B,OAAOF,UAClDyC,KAAKmG,wB,+BAGT,WACEnG,KAAKmG,wB,iCAGP,WACE,IAAO5I,EAAYyC,KAAKR,MAAM/B,OAAvBF,UAEPoI,QACE,8BACA,CACEC,YAAarI,EACbsI,iBAAkB,SAClBC,KAAM,kBAER9F,KAAKR,MAAMc,gB,sBAIf,WACE,IAAOsD,EAAU5D,KAAKK,MAAfuD,OACP,OAAIA,GAAUA,EAAO5C,KACZ4C,EAAO5C,KAEP,W,0BAIX,WACE,MAAqChB,KAAKR,MAAM/B,OAAzCH,EAAP,EAAOA,UAAWD,EAAlB,EAAkBA,MAAOE,EAAzB,EAAyBA,SACzB,MAAO,CAAC,CAAC,gBAAD,oBAA+BF,EAA/B,YAAwCC,EAAxC,oBAA6DC,EAA7D,S,wBAGV,SAAW6I,GACT,OAAOA,EAAMC,MAAM,MAAM,K,wBAgE3B,WAAa,WACJL,EAAiBhG,KAAKK,MAAtB2F,cACAzG,EAAWS,KAAKR,MAAhBD,QAEDqE,EACJrE,GACAA,EAAQA,SACRA,EAAQA,QAAQ+G,MAAK,qBAAE9F,OAAmB,EAAKhB,MAAM/B,OAAOF,YAE9D,OAAOqG,EAASA,EAAO5E,QAAUgH,GAAiBA,EAAchH,U,2BAGlE,WACE,IAAOgH,EAAiBhG,KAAKK,MAAtB2F,cACP,IAAKA,EACH,OAAO,KAET,IAAMhH,EAAUgB,KAAKuG,aAEfC,GACJ,QAACC,EAAD,CAAclF,KAAK,QAAQF,QAASrB,KAAK0G,aAAzC,UACG3H,OAAE,mBAID4H,GACJ,QAACF,EAAD,CAAclF,KAAK,QAAQqF,SAAS,SAASvF,QAASrB,KAAK6G,cAA3D,UACG9H,OAAE,oBAID+H,EAAe9H,EAAU2H,EAAUH,EAEzC,OACE,eAAK5F,UAAU,aAAf,UACGoF,EAAc/E,YAAc6F,GAC7B,QAAC,KAAD,CAAQvF,KAAK,QAAQF,QAASrB,KAAK+G,YAAnC,UACGhI,OAAE,8B,wBAMX,WAAa,QACX,EAAgCiB,KAAKR,MAA9Bc,EAAP,EAAOA,aAAcC,EAArB,EAAqBA,QACdyF,EAAiBhG,KAAKK,MAAtB2F,cACP,OAAKA,GAKH,0BACE,QAAC,IAAD,CAAoBV,MAAOU,EAAchF,KAAMgG,OAAQhH,KAAKiH,mBAC5D,eAAKrG,UAAU,MAAf,WACE,eAAKA,UAAU,WAAf,UACE,QAAC,IAAD,CACEN,aAAcA,EACdC,QAASA,EACT9B,KAAMuH,EACNhH,QAASgB,KAAKuG,aACd7G,gBAAiBM,KAAK6G,mBAG1B,eAAKjG,UAAU,2BAAf,UACE,eAAKA,UAAU,qBAAf,WACE,wBAAK7B,OAAE,yBAEP,cAAI6B,UAAU,OAAd,WACE,wBAAK7B,OAAE,WACP,uBAAKiH,EAAchF,QACnB,wBAAKjC,OAAE,aACP,iCAAKiH,EAAckB,cAAnB,aAAK,EAAsBlG,QAC1B,UAAAgF,EAAckB,cAAd,eAAsBC,OACrB,0BACE,wBAAKpI,OAAE,UACP,wBACE,QAAC,IAAD,CAAcqI,KAAMpB,EAAckB,OAAOC,IAAzC,SACGnH,KAAKqH,WAAWrB,EAAckB,OAAOC,aAK9C,wBAAKpI,OAAE,cACP,uBAAKiH,EAAcsB,aAGpBtB,EAAcuB,cACb,0BACE,wBAAKxI,OAAE,kBACP,aAAG6B,UAAU,cAAb,SAA4BoF,EAAcuB,iBAI7CvB,EAAcwB,gBACb,0BACE,wBAAKzI,OAAE,gBACP,cAAI6B,UAAU,OAAd,SACGoF,EAAcwB,cAAc7D,KAAI,gBAAE2B,EAAF,EAAEA,MAAO6B,EAAT,EAASA,IAAT,OAC/B,wBACE,QAAC,IAAD,CAAcC,KAAMD,EAApB,SAA0B7B,KADnB6B,sBAnDlB,S,GAvJsB9B,KA2NnC,WAAeoC,OAAY/B,GAE3B,IAAMe,GAAe,OAAOtE,KAAP,qBAAH,iBACAD,OAAM,KADN","file":"chunks/app_views_settings_projectPlugins_details_tsx.xxxxxxxxxxxxxxxxxxxx.js","sourcesContent":["import {\n  addErrorMessage,\n  addLoadingMessage,\n  addSuccessMessage,\n} from 'app/actionCreators/indicator';\nimport PluginActions from 'app/actions/pluginActions';\nimport {Client, RequestOptions} from 'app/api';\nimport {t} from 'app/locale';\nimport {Plugin} from 'app/types';\n\nconst activeFetch = {};\n// PluginsStore always exists, so api client should be independent of component lifecycle\nconst api = new Client();\n\ntype Slugs = {\n  /**\n   * Organization slug\n   */\n  orgId: string;\n\n  /**\n   * Project slug\n   */\n  projectId: string;\n\n  /**\n   * Plugin slug\n   */\n  pluginId: string;\n};\n\ntype DoUpdateParams = Slugs & {\n  update: Partial<Plugin>;\n} & Partial<RequestOptions>;\n\nfunction doUpdate({orgId, projectId, pluginId, update, ...params}: DoUpdateParams) {\n  PluginActions.update(pluginId, update);\n  const request = api.requestPromise(\n    `/projects/${orgId}/${projectId}/plugins/${pluginId}/`,\n    {\n      ...params,\n    }\n  );\n\n  // This is intentionally not chained because we want the unhandled promise to be returned\n  request\n    .then(() => {\n      PluginActions.updateSuccess(pluginId, update);\n    })\n    .catch(resp => {\n      const err =\n        resp && resp.responseJSON && typeof resp.responseJSON.detail === 'string'\n          ? new Error(resp.responseJSON.detail)\n          : new Error('Unable to update plugin');\n      PluginActions.updateError(pluginId, update, err);\n    });\n\n  return request;\n}\n\ntype FetchPluginsOptions = {\n  /**\n   * Reset will set loading state = true\n   */\n  resetLoading?: boolean;\n};\n\n/**\n * Fetches list of available plugins for a project\n */\nexport function fetchPlugins(\n  {orgId, projectId}: Pick<Slugs, 'orgId' | 'projectId'>,\n  options?: FetchPluginsOptions\n): Promise<Plugin[]> {\n  const path = `/projects/${orgId}/${projectId}/plugins/`;\n\n  // Make sure we throttle fetches\n  if (activeFetch[path]) {\n    return activeFetch[path];\n  }\n\n  PluginActions.fetchAll(options);\n  const request = api.requestPromise(path, {\n    method: 'GET',\n    includeAllArgs: true,\n  });\n\n  activeFetch[path] = request;\n\n  // This is intentionally not chained because we want the unhandled promise to be returned\n  request\n    .then(([data, _, jqXHR]) => {\n      PluginActions.fetchAllSuccess(data, {\n        pageLinks: jqXHR && jqXHR.getResponseHeader('Link'),\n      });\n\n      return data;\n    })\n    .catch(err => {\n      PluginActions.fetchAllError(err);\n      throw new Error('Unable to fetch plugins');\n    })\n    .then(() => (activeFetch[path] = null));\n\n  return request;\n}\n\ntype EnableDisablePluginParams = Slugs;\n\n/**\n * Enables a plugin\n */\nexport function enablePlugin(params: EnableDisablePluginParams) {\n  addLoadingMessage(t('Enabling...'));\n  return doUpdate({...params, update: {enabled: true}, method: 'POST'})\n    .then(() => addSuccessMessage(t('Plugin was enabled')))\n    .catch(() => addErrorMessage(t('Unable to enable plugin')));\n}\n\n/**\n * Disables a plugin\n */\nexport function disablePlugin(params: EnableDisablePluginParams) {\n  addLoadingMessage(t('Disabling...'));\n  return doUpdate({...params, update: {enabled: false}, method: 'DELETE'})\n    .then(() => addSuccessMessage(t('Plugin was disabled')))\n    .catch(() => addErrorMessage(t('Unable to disable plugin')));\n}\n","import Reflux from 'reflux';\n\nconst PluginActions = Reflux.createActions([\n  'update',\n  'updateError',\n  'updateSuccess',\n  'fetchAll',\n  'fetchAllSuccess',\n  'fetchAllError',\n]);\n\nexport default PluginActions;\n","import {Component} from 'react';\nimport styled from '@emotion/styled';\nimport isEqual from 'lodash/isEqual';\n\nimport {\n  addErrorMessage,\n  addLoadingMessage,\n  addSuccessMessage,\n} from 'app/actionCreators/indicator';\nimport {Client} from 'app/api';\nimport Button from 'app/components/button';\nimport LoadingIndicator from 'app/components/loadingIndicator';\nimport {Panel, PanelAlert, PanelBody, PanelHeader} from 'app/components/panels';\nimport {t} from 'app/locale';\nimport plugins from 'app/plugins';\nimport PluginIcon from 'app/plugins/components/pluginIcon';\nimport space from 'app/styles/space';\nimport {Organization, Plugin, Project} from 'app/types';\nimport withApi from 'app/utils/withApi';\n\ntype Props = {\n  organization: Organization;\n  project: Project;\n  data: Plugin;\n  onDisablePlugin: (data: Plugin) => void;\n  api: Client;\n  enabled?: boolean;\n};\n\ntype State = {\n  testResults: string;\n  loading?: boolean;\n};\n\nclass PluginConfig extends Component<Props, State> {\n  static defaultProps = {\n    onDisablePlugin: () => {},\n  };\n\n  state: State = {\n    loading: !plugins.isLoaded(this.props.data),\n    testResults: '',\n  };\n\n  componentDidMount() {\n    this.loadPlugin(this.props.data);\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps: Props) {\n    this.loadPlugin(nextProps.data);\n  }\n\n  shouldComponentUpdate(nextProps: Props, nextState: State) {\n    return !isEqual(nextState, this.state) || !isEqual(nextProps.data, this.props.data);\n  }\n\n  loadPlugin(data: Plugin) {\n    this.setState(\n      {\n        loading: true,\n      },\n      () => {\n        plugins.load(data, () => {\n          this.setState({loading: false});\n        });\n      }\n    );\n  }\n\n  getPluginEndpoint() {\n    const {organization, project, data} = this.props;\n    return `/projects/${organization.slug}/${project.slug}/plugins/${data.id}/`;\n  }\n\n  handleDisablePlugin = () => {\n    this.props.onDisablePlugin(this.props.data);\n  };\n\n  handleTestPlugin = async () => {\n    this.setState({testResults: ''});\n    addLoadingMessage(t('Sending test...'));\n\n    try {\n      const data = await this.props.api.requestPromise(this.getPluginEndpoint(), {\n        method: 'POST',\n        data: {\n          test: true,\n        },\n      });\n\n      this.setState({testResults: JSON.stringify(data.detail)});\n      addSuccessMessage(t('Test Complete!'));\n    } catch (_err) {\n      addErrorMessage(\n        t('An unexpected error occurred while testing your plugin. Please try again.')\n      );\n    }\n  };\n\n  createMarkup() {\n    return {__html: this.props.data.doc};\n  }\n\n  render() {\n    const {data} = this.props;\n    // If passed via props, use that value instead of from `data`\n    const enabled =\n      typeof this.props.enabled !== 'undefined' ? this.props.enabled : data.enabled;\n\n    return (\n      <Panel\n        className={`plugin-config ref-plugin-config-${data.id}`}\n        data-test-id=\"plugin-config\"\n      >\n        <PanelHeader hasButtons>\n          <PluginName>\n            <StyledPluginIcon pluginId={data.id} />\n            <span>{data.name}</span>\n          </PluginName>\n\n          {data.canDisable && enabled && (\n            <Actions>\n              {data.isTestable && (\n                <TestPluginButton onClick={this.handleTestPlugin} size=\"small\">\n                  {t('Test Plugin')}\n                </TestPluginButton>\n              )}\n              <Button size=\"small\" onClick={this.handleDisablePlugin}>\n                {t('Disable')}\n              </Button>\n            </Actions>\n          )}\n        </PanelHeader>\n\n        {data.status === 'beta' && (\n          <PanelAlert type=\"warning\">\n            {t('This plugin is considered beta and may change in the future.')}\n          </PanelAlert>\n        )}\n\n        {this.state.testResults !== '' && (\n          <PanelAlert type=\"info\">\n            <strong>Test Results</strong>\n            <div>{this.state.testResults}</div>\n          </PanelAlert>\n        )}\n\n        <StyledPanelBody>\n          <div dangerouslySetInnerHTML={this.createMarkup()} />\n          {this.state.loading ? (\n            <LoadingIndicator />\n          ) : (\n            plugins.get(data).renderSettings({\n              organization: this.props.organization,\n              project: this.props.project,\n            })\n          )}\n        </StyledPanelBody>\n      </Panel>\n    );\n  }\n}\n\nexport {PluginConfig};\nexport default withApi(PluginConfig);\n\nconst PluginName = styled('div')`\n  display: flex;\n  align-items: center;\n  flex: 1;\n`;\n\nconst StyledPluginIcon = styled(PluginIcon)`\n  margin-right: ${space(1)};\n`;\n\nconst Actions = styled('div')`\n  display: flex;\n`;\nconst TestPluginButton = styled(Button)`\n  margin-right: ${space(1)};\n`;\n\nconst StyledPanelBody = styled(PanelBody)`\n  padding: ${space(2)};\n  padding-bottom: 0;\n`;\n","import Reflux from 'reflux';\n\nimport PluginActions from 'app/actions/pluginActions';\nimport {Plugin} from 'app/types';\n\ntype PluginStoreInterface = {\n  state: {\n    loading: boolean;\n    plugins: Plugin[];\n    error: Error | null;\n    pageLinks: string | null;\n  };\n  plugins: Map<string, Plugin> | null;\n  updating: Map<string, Plugin>;\n};\n\nconst defaultState = {\n  loading: true,\n  plugins: [],\n  error: null,\n  pageLinks: null,\n};\n\nconst PluginStoreConfig: Reflux.StoreDefinition & PluginStoreInterface = {\n  plugins: null,\n  state: {...defaultState},\n  updating: new Map(),\n\n  reset() {\n    // reset our state\n    this.plugins = null;\n    this.state = {...defaultState};\n    this.updating = new Map();\n    return this.state;\n  },\n\n  getInitialState() {\n    return this.getState();\n  },\n\n  getState() {\n    const {plugins: _plugins, ...state} = this.state;\n\n    return {\n      ...state,\n      plugins: this.plugins ? Array.from(this.plugins.values()) : [],\n    };\n  },\n\n  init() {\n    this.reset();\n    this.listenTo(PluginActions.fetchAll, this.onFetchAll);\n    this.listenTo(PluginActions.fetchAllSuccess, this.onFetchAllSuccess);\n    this.listenTo(PluginActions.fetchAllError, this.onFetchAllError);\n    this.listenTo(PluginActions.update, this.onUpdate);\n    this.listenTo(PluginActions.updateSuccess, this.onUpdateSuccess);\n    this.listenTo(PluginActions.updateError, this.onUpdateError);\n  },\n\n  triggerState() {\n    this.trigger(this.getState());\n  },\n\n  onFetchAll({resetLoading}: {resetLoading?: boolean} = {}) {\n    if (resetLoading) {\n      this.state.loading = true;\n      this.state.error = null;\n      this.plugins = null;\n    }\n\n    this.triggerState();\n  },\n\n  onFetchAllSuccess(data: Plugin[], {pageLinks}: {pageLinks?: string}) {\n    this.plugins = new Map(data.map(plugin => [plugin.id, plugin]));\n    this.state.pageLinks = pageLinks || null;\n    this.state.loading = false;\n    this.triggerState();\n  },\n\n  onFetchAllError(err) {\n    this.plugins = null;\n    this.state.loading = false;\n    this.state.error = err;\n    this.triggerState();\n  },\n\n  onUpdate(id: string, updateObj: Partial<Plugin>) {\n    if (!this.plugins) {\n      return;\n    }\n\n    const plugin = this.plugins.get(id);\n    if (!plugin) {\n      return;\n    }\n    const newPlugin = {\n      ...plugin,\n      ...updateObj,\n    };\n\n    this.plugins.set(id, newPlugin);\n    this.updating.set(id, plugin);\n    this.triggerState();\n  },\n\n  onUpdateSuccess(id: string, _updateObj: Partial<Plugin>) {\n    this.updating.delete(id);\n  },\n\n  onUpdateError(id: string, _updateObj: Partial<Plugin>, err) {\n    const origPlugin = this.updating.get(id);\n    if (!origPlugin || !this.plugins) {\n      return;\n    }\n\n    this.plugins.set(id, origPlugin);\n    this.updating.delete(id);\n    this.state.error = err;\n    this.triggerState();\n  },\n};\n\ntype PluginStore = Reflux.Store & PluginStoreInterface;\n\nconst PluginStore = Reflux.createStore(PluginStoreConfig);\n\nexport default PluginStore as PluginStore;\n","import * as React from 'react';\n\nimport {fetchPlugins} from 'app/actionCreators/plugins';\nimport PluginsStore from 'app/stores/pluginsStore';\nimport {Organization, Plugin, Project} from 'app/types';\nimport {defined} from 'app/utils';\nimport getDisplayName from 'app/utils/getDisplayName';\nimport withOrganization from 'app/utils/withOrganization';\nimport withProject from 'app/utils/withProject';\n\ntype WithPluginProps = {\n  organization: Organization;\n  project?: Project;\n};\n\ntype State = {\n  plugins: Plugin[];\n  loading: boolean;\n};\n\n/**\n * Higher order component that fetches list of plugins and\n * passes PluginsStore to component as `plugins`\n */\nfunction withPlugins<P extends WithPluginProps>(\n  WrappedComponent: React.ComponentType<P>\n) {\n  class WithPlugins extends React.Component<\n    Omit<P, keyof 'plugins'> & WithPluginProps,\n    State\n  > {\n    static displayName = `withPlugins(${getDisplayName(WrappedComponent)})`;\n    state = {plugins: [], loading: true};\n\n    componentDidMount() {\n      this.fetchPlugins();\n    }\n\n    componentDidUpdate(prevProps, _prevState, prevContext) {\n      const {organization, project} = this.props;\n\n      // Only fetch plugins when a org slug or project slug has changed\n      const prevOrg = prevProps.organization || prevContext?.organization;\n      const prevProject = prevProps.project || prevContext?.project;\n\n      // If previous org/project is undefined then it means:\n      // the HoC has mounted, `fetchPlugins` has been called (via cDM), and\n      // store was updated. We don't need to fetchPlugins again (or it will cause an infinite loop)\n      //\n      // This is for the unusual case where component is mounted and receives a new org/project prop\n      // e.g. when switching projects via breadcrumbs in settings.\n      if (!defined(prevProject) || !defined(prevOrg)) {\n        return;\n      }\n\n      const isOrgSame = prevOrg.slug === organization.slug;\n      const isProjectSame = prevProject.slug === project?.slug;\n\n      // Don't do anything if org and project are the same\n      if (isOrgSame && isProjectSame) {\n        return;\n      }\n\n      this.fetchPlugins();\n    }\n\n    componentWillUnmount() {\n      this.unsubscribe();\n    }\n\n    unsubscribe = PluginsStore.listen(({plugins, loading}: State) => {\n      // State is destructured as store updates contain additional keys\n      // that are not exposed by this HoC\n      this.setState({plugins, loading});\n    }, undefined);\n\n    fetchPlugins() {\n      const {organization, project} = this.props;\n\n      if (!project || !organization) {\n        return;\n      }\n\n      fetchPlugins({projectId: project.slug, orgId: organization.slug});\n    }\n\n    render() {\n      return (\n        <WrappedComponent {...(this.props as P & WithPluginProps)} plugins={this.state} />\n      );\n    }\n  }\n  return withOrganization(withProject(WithPlugins));\n}\n\nexport default withPlugins;\n","import * as React from 'react';\nimport DocumentTitle from 'react-document-title';\n\nimport AsyncComponent from 'app/components/asyncComponent';\n\ntype AsyncViewState = AsyncComponent['state'];\ntype AsyncViewProps = AsyncComponent['props'];\n\nexport default class AsyncView<\n  P extends AsyncViewProps = AsyncViewProps,\n  S extends AsyncViewState = AsyncViewState\n> extends AsyncComponent<P, S> {\n  getTitle() {\n    return '';\n  }\n\n  render() {\n    const title = this.getTitle();\n    return (\n      <DocumentTitle title={`${title ? `${title} - ` : ''}Sentry`}>\n        {this.renderComponent() as React.ReactChild}\n      </DocumentTitle>\n    );\n  }\n}\n","import {WithRouterProps} from 'react-router';\nimport styled from '@emotion/styled';\n\nimport {\n  addErrorMessage,\n  addLoadingMessage,\n  addSuccessMessage,\n} from 'app/actionCreators/indicator';\nimport {disablePlugin, enablePlugin} from 'app/actionCreators/plugins';\nimport Button from 'app/components/button';\nimport ExternalLink from 'app/components/links/externalLink';\nimport PluginConfig from 'app/components/pluginConfig';\nimport {t} from 'app/locale';\nimport space from 'app/styles/space';\nimport {Organization, Plugin, Project} from 'app/types';\nimport {trackIntegrationEvent} from 'app/utils/integrationUtil';\nimport withPlugins from 'app/utils/withPlugins';\nimport AsyncView from 'app/views/asyncView';\nimport SettingsPageHeader from 'app/views/settings/components/settingsPageHeader';\n\ntype Props = {\n  organization: Organization;\n  project: Project;\n  plugins: {\n    plugins: Plugin[];\n  };\n} & WithRouterProps<{orgId: string; projectId: string; pluginId: string}>;\n\ntype State = {\n  pluginDetails?: Plugin;\n} & AsyncView['state'];\n\n/**\n * There are currently two sources of truths for plugin details:\n *\n * 1) PluginsStore has a list of plugins, and this is where ENABLED state lives\n * 2) We fetch \"plugin details\" via API and save it to local state as `pluginDetails`.\n *    This is because \"details\" call contains form `config` and the \"list\" endpoint does not.\n *    The more correct way would be to pass `config` to PluginConfig and use plugin from\n *    PluginsStore\n */\nclass ProjectPluginDetails extends AsyncView<Props, State> {\n  componentDidUpdate(prevProps: Props, prevContext: any) {\n    super.componentDidUpdate(prevProps, prevContext);\n    if (prevProps.params.pluginId !== this.props.params.pluginId) {\n      this.recordDetailsViewed();\n    }\n  }\n  componentDidMount() {\n    this.recordDetailsViewed();\n  }\n\n  recordDetailsViewed() {\n    const {pluginId} = this.props.params;\n\n    trackIntegrationEvent(\n      'integrations.details_viewed',\n      {\n        integration: pluginId,\n        integration_type: 'plugin',\n        view: 'plugin_details',\n      },\n      this.props.organization\n    );\n  }\n\n  getTitle() {\n    const {plugin} = this.state;\n    if (plugin && plugin.name) {\n      return plugin.name;\n    } else {\n      return 'Sentry';\n    }\n  }\n\n  getEndpoints(): ReturnType<AsyncView['getEndpoints']> {\n    const {projectId, orgId, pluginId} = this.props.params;\n    return [['pluginDetails', `/projects/${orgId}/${projectId}/plugins/${pluginId}/`]];\n  }\n\n  trimSchema(value) {\n    return value.split('//')[1];\n  }\n\n  handleReset = () => {\n    const {projectId, orgId, pluginId} = this.props.params;\n\n    addLoadingMessage(t('Saving changes\\u2026'));\n    trackIntegrationEvent(\n      'integrations.uninstall_clicked',\n      {\n        integration: pluginId,\n        integration_type: 'plugin',\n        view: 'plugin_details',\n      },\n      this.props.organization\n    );\n\n    this.api.request(`/projects/${orgId}/${projectId}/plugins/${pluginId}/`, {\n      method: 'POST',\n      data: {reset: true},\n      success: pluginDetails => {\n        this.setState({pluginDetails});\n        addSuccessMessage(t('Plugin was reset'));\n        trackIntegrationEvent(\n          'integrations.uninstall_completed',\n          {\n            integration: pluginId,\n            integration_type: 'plugin',\n            view: 'plugin_details',\n          },\n          this.props.organization\n        );\n      },\n      error: () => {\n        addErrorMessage(t('An error occurred'));\n      },\n    });\n  };\n\n  handleEnable = () => {\n    enablePlugin(this.props.params);\n    this.analyticsChangeEnableStatus(true);\n  };\n\n  handleDisable = () => {\n    disablePlugin(this.props.params);\n    this.analyticsChangeEnableStatus(false);\n  };\n\n  analyticsChangeEnableStatus = (enabled: boolean) => {\n    const {pluginId} = this.props.params;\n    const eventKey = enabled ? 'integrations.enabled' : 'integrations.disabled';\n    trackIntegrationEvent(\n      eventKey,\n      {\n        integration: pluginId,\n        integration_type: 'plugin',\n        view: 'plugin_details',\n      },\n      this.props.organization\n    );\n  };\n\n  // Enabled state is handled via PluginsStore and not via plugins detail\n  getEnabled() {\n    const {pluginDetails} = this.state;\n    const {plugins} = this.props;\n\n    const plugin =\n      plugins &&\n      plugins.plugins &&\n      plugins.plugins.find(({slug}) => slug === this.props.params.pluginId);\n\n    return plugin ? plugin.enabled : pluginDetails && pluginDetails.enabled;\n  }\n\n  renderActions() {\n    const {pluginDetails} = this.state;\n    if (!pluginDetails) {\n      return null;\n    }\n    const enabled = this.getEnabled();\n\n    const enable = (\n      <StyledButton size=\"small\" onClick={this.handleEnable}>\n        {t('Enable Plugin')}\n      </StyledButton>\n    );\n\n    const disable = (\n      <StyledButton size=\"small\" priority=\"danger\" onClick={this.handleDisable}>\n        {t('Disable Plugin')}\n      </StyledButton>\n    );\n\n    const toggleEnable = enabled ? disable : enable;\n\n    return (\n      <div className=\"pull-right\">\n        {pluginDetails.canDisable && toggleEnable}\n        <Button size=\"small\" onClick={this.handleReset}>\n          {t('Reset Configuration')}\n        </Button>\n      </div>\n    );\n  }\n\n  renderBody() {\n    const {organization, project} = this.props;\n    const {pluginDetails} = this.state;\n    if (!pluginDetails) {\n      return null;\n    }\n\n    return (\n      <div>\n        <SettingsPageHeader title={pluginDetails.name} action={this.renderActions()} />\n        <div className=\"row\">\n          <div className=\"col-md-7\">\n            <PluginConfig\n              organization={organization}\n              project={project}\n              data={pluginDetails}\n              enabled={this.getEnabled()}\n              onDisablePlugin={this.handleDisable}\n            />\n          </div>\n          <div className=\"col-md-4 col-md-offset-1\">\n            <div className=\"pluginDetails-meta\">\n              <h4>{t('Plugin Information')}</h4>\n\n              <dl className=\"flat\">\n                <dt>{t('Name')}</dt>\n                <dd>{pluginDetails.name}</dd>\n                <dt>{t('Author')}</dt>\n                <dd>{pluginDetails.author?.name}</dd>\n                {pluginDetails.author?.url && (\n                  <div>\n                    <dt>{t('URL')}</dt>\n                    <dd>\n                      <ExternalLink href={pluginDetails.author.url}>\n                        {this.trimSchema(pluginDetails.author.url)}\n                      </ExternalLink>\n                    </dd>\n                  </div>\n                )}\n                <dt>{t('Version')}</dt>\n                <dd>{pluginDetails.version}</dd>\n              </dl>\n\n              {pluginDetails.description && (\n                <div>\n                  <h4>{t('Description')}</h4>\n                  <p className=\"description\">{pluginDetails.description}</p>\n                </div>\n              )}\n\n              {pluginDetails.resourceLinks && (\n                <div>\n                  <h4>{t('Resources')}</h4>\n                  <dl className=\"flat\">\n                    {pluginDetails.resourceLinks.map(({title, url}) => (\n                      <dd key={url}>\n                        <ExternalLink href={url}>{title}</ExternalLink>\n                      </dd>\n                    ))}\n                  </dl>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport {ProjectPluginDetails};\n\nexport default withPlugins(ProjectPluginDetails);\n\nconst StyledButton = styled(Button)`\n  margin-right: ${space(0.75)};\n`;\n"],"sourceRoot":""}