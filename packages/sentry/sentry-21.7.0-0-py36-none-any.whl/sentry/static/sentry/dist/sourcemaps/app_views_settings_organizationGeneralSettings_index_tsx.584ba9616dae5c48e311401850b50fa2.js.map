{"version":3,"sources":["webpack:///./app/components/sentryDocumentTitle.tsx","webpack:///./app/data/forms/organizationGeneralSettings.tsx","webpack:///./app/utils/slugify.tsx","webpack:///./app/views/settings/organization/permissionAlert.tsx","webpack:///./app/views/settings/organizationGeneralSettings/organizationSettingsForm.tsx","webpack:///./app/views/settings/organizationGeneralSettings/index.tsx"],"names":["SentryDocumentTitle","title","orgSlug","projectSlug","children","docTitle","route","formGroups","t","fields","name","type","required","label","help","transformInput","slugify","saveOnBlur","saveMessageAlertType","saveMessage","choices","initialData","availableRoles","map","r","id","disabled","access","has","visible","features","str","toLowerCase","replace","PermissionAlert","props","hasAccess","icon","size","OrganizationSettingsForm","organization","this","slug","onSave","authProvider","state","endpoint","jsonFormSettings","additionalFieldProps","hasSsoEnabled","Set","location","apiMethod","apiEndpoint","allowUndo","onSubmitSuccess","_resp","model","onSubmitError","addErrorMessage","forms","organizationSettingsFields","allowGravatar","updateOrganization","AsyncComponent","withOrganization","OrganizationGeneralSettings","api","params","addLoadingMessage","removeAndRedirectToRemainingOrganization","orgId","successMessage","errorMessage","prevData","data","changeOrganizationSlug","browserHistory","hasProjects","projects","length","Fragment","handleSave","isDefault","priority","confirmText","message","tct","noMargin","className","project","onConfirm","handleRemoveOrganization","Component","withApi"],"mappings":"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","file":"chunks/app_views_settings_organizationGeneralSettings_index_tsx.xxxxxxxxxxxxxxxxxxxx.js","sourcesContent":["import * as React from 'react';\nimport DocumentTitle from 'react-document-title';\n\ntype Props = {\n  // Main page title\n  title: string;\n  orgSlug?: string;\n  projectSlug?: string;\n  children?: React.ReactNode;\n};\n\nfunction SentryDocumentTitle({title, orgSlug, projectSlug, children}: Props) {\n  function getDocTitle() {\n    if (!orgSlug && !projectSlug) {\n      return title;\n    }\n\n    if (orgSlug && projectSlug) {\n      return `${title} - ${orgSlug} - ${projectSlug}`;\n    }\n\n    if (orgSlug) {\n      return `${title} - ${orgSlug}`;\n    }\n\n    return `${title} - ${projectSlug}`;\n  }\n\n  const docTitle = getDocTitle();\n\n  return (\n    <DocumentTitle title={`${docTitle} - Sentry`}>\n      {children as React.ReactChild}\n    </DocumentTitle>\n  );\n}\n\nexport default SentryDocumentTitle;\n","import {t} from 'app/locale';\nimport {MemberRole} from 'app/types';\nimport slugify from 'app/utils/slugify';\nimport {JsonFormObject} from 'app/views/settings/components/forms/type';\n\n// Export route to make these forms searchable by label/help\nexport const route = '/settings/:orgId/';\n\nconst formGroups: JsonFormObject[] = [\n  {\n    // Form \"section\"/\"panel\"\n    title: t('General'),\n    fields: [\n      {\n        name: 'slug',\n        type: 'string',\n        required: true,\n        label: t('Organization Slug'),\n        help: t('A unique ID used to identify this organization'),\n        transformInput: slugify,\n        saveOnBlur: false,\n        saveMessageAlertType: 'info',\n        saveMessage: t(\n          'You will be redirected to the new organization slug after saving'\n        ),\n      },\n      {\n        name: 'name',\n        type: 'string',\n        required: true,\n        label: t('Display Name'),\n        help: t('A human-friendly name for the organization'),\n      },\n      {\n        name: 'isEarlyAdopter',\n        type: 'boolean',\n        label: t('Early Adopter'),\n        help: t(\"Opt-in to new features before they're released to the public\"),\n      },\n    ],\n  },\n\n  {\n    title: 'Membership',\n    fields: [\n      {\n        name: 'defaultRole',\n        type: 'select',\n        required: true,\n        label: t('Default Role'),\n        // seems weird to have choices in initial form data\n        choices: ({initialData} = {}) =>\n          initialData?.availableRoles?.map((r: MemberRole) => [r.id, r.name]) ?? [],\n        help: t('The default role new members will receive'),\n        disabled: ({access}) => !access.has('org:admin'),\n      },\n      {\n        name: 'openMembership',\n        type: 'boolean',\n        required: true,\n        label: t('Open Membership'),\n        help: t('Allow organization members to freely join or leave any team'),\n      },\n      {\n        name: 'eventsMemberAdmin',\n        type: 'boolean',\n        label: t('Let Members Delete Events'),\n        help: t(\n          'Allow members to delete events (including the delete & discard action) by granting them the `event:admin` scope.'\n        ),\n      },\n      {\n        name: 'alertsMemberWrite',\n        type: 'boolean',\n        label: t('Let Members Create and Edit Alerts'),\n        help: t(\n          'Allow members to create, edit, and delete alert rules by granting them the `alerts:write` scope.'\n        ),\n      },\n      {\n        name: 'attachmentsRole',\n        type: 'select',\n        choices: ({initialData = {}}) =>\n          initialData?.availableRoles?.map((r: MemberRole) => [r.id, r.name]) ?? [],\n        label: t('Attachments Access'),\n        help: t(\n          'Role required to download event attachments, such as native crash reports or log files.'\n        ),\n        visible: ({features}) => features.has('event-attachments'),\n      },\n      {\n        name: 'debugFilesRole',\n        type: 'select',\n        choices: ({initialData = {}}) =>\n          initialData?.availableRoles?.map((r: MemberRole) => [r.id, r.name]) ?? [],\n        label: t('Debug Files Access'),\n        help: t(\n          'Role required to download debug information files, proguard mappings and source maps.'\n        ),\n      },\n    ],\n  },\n];\n\nexport default formGroups;\n","// XXX: This is NOT an exhaustive slugify function\n// Only forces lowercase and replaces spaces with hyphens\nexport default function slugify(str: any): string {\n  return typeof str === 'string' ? str.toLowerCase().replace(' ', '-') : '';\n}\n","import * as React from 'react';\n\nimport Access from 'app/components/acl/access';\nimport Alert from 'app/components/alert';\nimport {IconWarning} from 'app/icons';\nimport {t} from 'app/locale';\n\ntype Props = React.ComponentPropsWithoutRef<typeof Alert> &\n  Pick<React.ComponentProps<typeof Access>, 'access'>;\n\nconst PermissionAlert = ({access = ['org:write'], ...props}: Props) => (\n  <Access access={access}>\n    {({hasAccess}) =>\n      !hasAccess && (\n        <Alert type=\"warning\" icon={<IconWarning size=\"sm\" />} {...props}>\n          {t(\n            'These settings can only be edited by users with the organization owner or manager role.'\n          )}\n        </Alert>\n      )\n    }\n  </Access>\n);\n\nexport default PermissionAlert;\n","import {RouteComponentProps} from 'react-router';\nimport {Location} from 'history';\n\nimport {addErrorMessage} from 'app/actionCreators/indicator';\nimport {updateOrganization} from 'app/actionCreators/organizations';\nimport AsyncComponent from 'app/components/asyncComponent';\nimport AvatarChooser from 'app/components/avatarChooser';\nimport organizationSettingsFields from 'app/data/forms/organizationGeneralSettings';\nimport {Organization, Scope} from 'app/types';\nimport withOrganization from 'app/utils/withOrganization';\nimport Form from 'app/views/settings/components/forms/form';\nimport JsonForm from 'app/views/settings/components/forms/jsonForm';\n\ntype Props = {\n  location: Location;\n  organization: Organization;\n  access: Set<Scope>;\n  initialData: Organization;\n  onSave: (previous: Organization, updated: Record<string, any>) => void;\n} & RouteComponentProps<{orgId: string}, {}>;\n\ntype State = AsyncComponent['state'] & {\n  authProvider: object;\n};\n\nclass OrganizationSettingsForm extends AsyncComponent<Props, State> {\n  getEndpoints(): ReturnType<AsyncComponent['getEndpoints']> {\n    const {organization} = this.props;\n    return [['authProvider', `/organizations/${organization.slug}/auth-provider/`]];\n  }\n\n  render() {\n    const {initialData, organization, onSave, access} = this.props;\n    const {authProvider} = this.state;\n    const endpoint = `/organizations/${organization.slug}/`;\n\n    const jsonFormSettings = {\n      additionalFieldProps: {hasSsoEnabled: !!authProvider},\n      features: new Set(organization.features),\n      access,\n      location: this.props.location,\n      disabled: !access.has('org:write'),\n    };\n\n    return (\n      <Form\n        data-test-id=\"organization-settings\"\n        apiMethod=\"PUT\"\n        apiEndpoint={endpoint}\n        saveOnBlur\n        allowUndo\n        initialData={initialData}\n        onSubmitSuccess={(_resp, model) => {\n          // Special case for slug, need to forward to new slug\n          if (typeof onSave === 'function') {\n            onSave(initialData, model.initialData);\n          }\n        }}\n        onSubmitError={() => addErrorMessage('Unable to save change')}\n      >\n        <JsonForm {...jsonFormSettings} forms={organizationSettingsFields} />\n        <AvatarChooser\n          type=\"organization\"\n          allowGravatar={false}\n          endpoint={`${endpoint}avatar/`}\n          model={initialData}\n          onSave={updateOrganization}\n          disabled={!access.has('org:write')}\n        />\n      </Form>\n    );\n  }\n}\n\nexport default withOrganization(OrganizationSettingsForm);\n","import {Component, Fragment} from 'react';\nimport {browserHistory, RouteComponentProps} from 'react-router';\n\nimport {addLoadingMessage} from 'app/actionCreators/indicator';\nimport {\n  changeOrganizationSlug,\n  removeAndRedirectToRemainingOrganization,\n  updateOrganization,\n} from 'app/actionCreators/organizations';\nimport {Client} from 'app/api';\nimport Button from 'app/components/button';\nimport Confirm from 'app/components/confirm';\nimport {Panel, PanelHeader} from 'app/components/panels';\nimport SentryDocumentTitle from 'app/components/sentryDocumentTitle';\nimport {t, tct} from 'app/locale';\nimport {Organization} from 'app/types';\nimport withApi from 'app/utils/withApi';\nimport withOrganization from 'app/utils/withOrganization';\nimport Field from 'app/views/settings/components/forms/field';\nimport SettingsPageHeader from 'app/views/settings/components/settingsPageHeader';\nimport TextBlock from 'app/views/settings/components/text/textBlock';\nimport PermissionAlert from 'app/views/settings/organization/permissionAlert';\n\nimport OrganizationSettingsForm from './organizationSettingsForm';\n\ntype Props = {\n  api: Client;\n  organization: Organization;\n} & RouteComponentProps<{orgId: string}, {}>;\n\nclass OrganizationGeneralSettings extends Component<Props> {\n  handleRemoveOrganization = () => {\n    const {api, organization, params} = this.props;\n    if (!organization) {\n      return;\n    }\n\n    addLoadingMessage();\n    removeAndRedirectToRemainingOrganization(api, {\n      orgId: params.orgId,\n      successMessage: `${organization.name} is queued for deletion.`,\n      errorMessage: `Error removing the ${organization.name} organization`,\n    });\n  };\n\n  handleSave = (prevData: Organization, data: Partial<Organization>) => {\n    if (data.slug && data.slug !== prevData.slug) {\n      changeOrganizationSlug(\n        prevData,\n        data as Partial<Organization> & Pick<Organization, 'slug'>\n      );\n      browserHistory.replace(`/settings/${data.slug}/`);\n    } else {\n      // This will update OrganizationStore (as well as OrganizationsStore\n      // which is slightly incorrect because it has summaries vs a detailed org)\n      updateOrganization(data);\n    }\n  };\n\n  render() {\n    const {organization, params} = this.props;\n    const {orgId} = params;\n    const access = new Set(organization.access);\n    const hasProjects = organization.projects && !!organization.projects.length;\n\n    return (\n      <Fragment>\n        <SentryDocumentTitle title={t('General Settings')} orgSlug={orgId} />\n        <div>\n          <SettingsPageHeader title={t('Organization Settings')} />\n          <PermissionAlert />\n\n          <OrganizationSettingsForm\n            {...this.props}\n            initialData={organization}\n            access={access}\n            onSave={this.handleSave}\n          />\n\n          {access.has('org:admin') && !organization.isDefault && (\n            <Panel>\n              <PanelHeader>{t('Remove Organization')}</PanelHeader>\n              <Field\n                label={t('Remove Organization')}\n                help={t(\n                  'Removing this organization will delete all data including projects and their associated events.'\n                )}\n              >\n                <div>\n                  <Confirm\n                    priority=\"danger\"\n                    confirmText={t('Remove Organization')}\n                    message={\n                      <div>\n                        <TextBlock>\n                          {tct(\n                            'Removing the organization, [name] is permanent and cannot be undone! Are you sure you want to continue?',\n                            {\n                              name: organization && <strong>{organization.name}</strong>,\n                            }\n                          )}\n                        </TextBlock>\n\n                        {hasProjects && (\n                          <div>\n                            <TextBlock noMargin>\n                              {t(\n                                'This will also remove the following associated projects:'\n                              )}\n                            </TextBlock>\n                            <ul className=\"ref-projects\">\n                              {organization.projects.map(project => (\n                                <li key={project.slug}>{project.slug}</li>\n                              ))}\n                            </ul>\n                          </div>\n                        )}\n                      </div>\n                    }\n                    onConfirm={this.handleRemoveOrganization}\n                  >\n                    <Button\n                      priority=\"danger\"\n                      title={t(\n                        'Remove %s organization',\n                        organization && organization.name\n                      )}\n                    >\n                      {t('Remove Organization')}\n                    </Button>\n                  </Confirm>\n                </div>\n              </Field>\n            </Panel>\n          )}\n        </div>\n      </Fragment>\n    );\n  }\n}\n\nexport default withApi(withOrganization(OrganizationGeneralSettings));\n"],"sourceRoot":""}