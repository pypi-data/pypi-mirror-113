{"version":3,"sources":["wizard.js"],"names":["$","fn","wizard","config","$navItems","find","$panes","$activeNavItem","$activeWizardPane","filter","isLastPane","index","length","getButton","text","name","disable","classes","tooltip","addActionBarToActivePane","remove","disablePrevious","disableNext","redirectOnLastPane","append","gettext","hidePrevious","data","skip","skipTooltip","switchToPane","removeClass","eq","addClass","next","previous","submit","$form","window","clearErrors","ajax","method","traditional","serializeForm","pubFuncs","isNumeric","on","prepend","done","location","fail","err","renderFormErrors","responseJSON","jQuery"],"mappings":"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","file":"wizard.js","sourceRoot":"../../../static_src/wizard/js","sourcesContent":["/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2021, Shuup Commerce Inc. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n(function($) {\n    $.fn.wizard = function(config={}) {\n        let $navItems = this.find(\".wizard-nav li\");\n        let $panes = this.find(\".wizard-pane\");\n        let $activeNavItem = $navItems.find(\".active\");\n        let $activeWizardPane = $panes.filter(\".active\");\n\n        function isLastPane(){\n            return $panes.index($activeWizardPane) == $panes.length - 1;\n        }\n\n        function getButton(text, name, disable, classes, tooltip) {\n            return (\n                '<button name=\"' + name + '\"' +\n                         'class=\"btn btn-lg ' + classes + '\" ' + (disable? \"disabled\":\"\") +\n                         (tooltip? \"data-toggle='tooltip' data-placement='bottom' title='\" + tooltip + \"'\": \"\") +\n                         '>' +\n                    text +\n                '</button>'\n            );\n        }\n\n        function addActionBarToActivePane() {\n            $panes.find(\".action-bar\").remove();\n            let disablePrevious = false;\n            let disableNext = false;\n            if($panes.index($activeWizardPane) === 0) {\n                disablePrevious = true;\n            }\n            if(isLastPane() && !config.redirectOnLastPane) {\n                disableNext = true;\n            }\n\n            $activeWizardPane.append(\n                '<div class=\"action-bar\">' +\n                    '<div class=\"clearfix\">' +\n                        getButton(gettext(\"Previous\"), \"previous\", disablePrevious, \"btn-primary pull-left \" + (config.hidePrevious? \"hidden\":\"\")) +\n                        getButton(isLastPane() ? gettext(\"Finish\") : gettext(\"Next\"), \"next\", disableNext, \"btn-primary pull-right\") +\n                        (\n                            ($activeWizardPane.data(\"can_skip\") === \"True\" || config.skip) ?\n                            getButton(gettext(\"Skip\"), \"skip\", false, \"btn-default pull-right btn-wizard-skip\", config.skipTooltip) : ''\n                        ) +\n                    '</div>' +\n                '</div>'\n            );\n            $activeWizardPane.find('[data-toggle=\"tooltip\"]').tooltip();\n        }\n\n        function switchToPane(index) {\n            $navItems.removeClass(\"active\");\n            $panes.removeClass(\"active\");\n            $activeNavItem = $navItems.eq(index);\n            $activeWizardPane = $panes.eq(index);\n            $activeNavItem.addClass(\"active\");\n            $activeWizardPane.addClass(\"active\");\n\n            addActionBarToActivePane();\n        }\n\n        function next() {\n            switchToPane($panes.index($activeWizardPane) + 1);\n        }\n\n        function previous() {\n            switchToPane($panes.index($activeWizardPane) - 1);\n        }\n\n        function submit() {\n            let $form = $activeWizardPane.find(\"form\");\n            window.clearErrors($form);\n            return $.ajax({method: \"POST\", traditional: true, data: window.serializeForm($form)});\n        }\n\n        var pubFuncs = {next, previous, submit};\n\n        if(config in pubFuncs){\n            return pubFuncs[config]();\n        } else if($.isNumeric(config)){\n            switchToPane(config);\n        } else {\n            this.on(\"click\", \"button[name='next']\", () => {\n                this.find(\"button[name='next']\").prepend('<i class=\"fa fa-spinner fa-pulse fa-fw\"></i>');\n                if(config.next) {\n                    config.next($activeWizardPane);\n                } else {\n                    submit().done(() => {\n                        if(config.redirectOnLastPane && isLastPane()){\n                            window.location = config.redirectOnLastPane;\n                        } else {\n                            next();\n                        }\n                    }).fail((err) => {\n                        window.clearErrors($activeWizardPane.find(\"form\")); // Remove previous form errors\n                        this.find(\"i.fa.fa-spinner\").remove();\n                        renderFormErrors($activeWizardPane.find(\"form\"), err.responseJSON);\n                    });\n                }\n            });\n\n            this.on(\"click\", \"button[name='previous']\", () => {\n                this.find(\"button[name='previous']\").prepend('<i class=\"fa fa-spinner fa-pulse fa-fw\"></i>');\n                if(config.previous) {\n                    config.previous($activeWizardPane);\n                } else {\n                    previous();\n                }\n            });\n\n            this.on(\"click\", \"button[name='skip']\", () => {\n                if(config.redirectOnLastPane && isLastPane()){\n                    window.location = config.redirectOnLastPane;\n                } else {\n                    next();\n                }\n            });\n            switchToPane(0);\n        }\n        return this;\n    };\n}(jQuery));\n"]}