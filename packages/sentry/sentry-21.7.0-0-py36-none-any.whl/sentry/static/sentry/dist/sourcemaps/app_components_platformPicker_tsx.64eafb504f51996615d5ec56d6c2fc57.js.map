{"version":3,"sources":["webpack:///./app/components/platformPicker.tsx"],"names":["PLATFORM_CATEGORIES","categoryList","id","name","t","PlatformList","space","PlatformPicker","keydown","category","props","defaultCategory","filter","noAutoFilter","platform","split","debounce","state","trackAdvancedAnalyticsEvent","search","toLowerCase","num_results","platformList","length","source","organization","React","this","currentCategory","filtered","platforms","includes","filterAliases","some","alias","sort","a","b","localeCompare","showOther","e","target","searchInput","current","focus","preventDefault","setPlatform","listProps","listClassName","NavContainer","CategoryNav","map","onClick","setState","to","isActive","SearchBar","size","type","ref","value","placeholder","onChange","logSearch","className","PlatformCard","selected","onClear","stopPropagation","platform_id","icon","title","tct","href","p","theme","border","inputStyles","subText","NavTabs","StyledPlatformIcon","PlatformIcon","ClearButton","Button","background","textColor","defaultProps","isCircled","borderless","radius","withLanguageIcon","format","alert","info","backgroundLight","muted","fontSizeExtraSmall"],"mappings":"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","file":"chunks/app_components_platformPicker_tsx.xxxxxxxxxxxxxxxxxxxx.js","sourcesContent":["import * as React from 'react';\nimport keydown from 'react-keydown';\nimport styled from '@emotion/styled';\nimport debounce from 'lodash/debounce';\nimport {PlatformIcon} from 'platformicons';\n\nimport Button from 'app/components/button';\nimport ExternalLink from 'app/components/links/externalLink';\nimport ListLink from 'app/components/links/listLink';\nimport NavTabs from 'app/components/navTabs';\nimport categoryList, {filterAliases, PlatformKey} from 'app/data/platformCategories';\nimport platforms from 'app/data/platforms';\nimport {IconClose, IconProject, IconSearch} from 'app/icons';\nimport {t, tct} from 'app/locale';\nimport {inputStyles} from 'app/styles/input';\nimport space from 'app/styles/space';\nimport {Organization, PlatformIntegration} from 'app/types';\nimport {trackAdvancedAnalyticsEvent} from 'app/utils/advancedAnalytics';\nimport EmptyMessage from 'app/views/settings/components/emptyMessage';\n\nconst PLATFORM_CATEGORIES = [...categoryList, {id: 'all', name: t('All')}] as const;\n\nconst PlatformList = styled('div')`\n  display: grid;\n  grid-gap: ${space(1)};\n  grid-template-columns: repeat(auto-fill, 112px);\n  margin-bottom: ${space(2)};\n`;\n\ntype Category = typeof PLATFORM_CATEGORIES[number]['id'];\n\ntype Props = {\n  setPlatform: (key: PlatformKey | null) => void;\n  platform?: string | null;\n  showOther?: boolean;\n  listClassName?: string;\n  listProps?: React.ComponentProps<typeof PlatformList>;\n  noAutoFilter?: boolean;\n  defaultCategory?: Category;\n  organization?: Organization;\n  source?: string;\n};\n\ntype State = {\n  category: Category;\n  filter: string;\n};\n\nclass PlatformPicker extends React.Component<Props, State> {\n  static defaultProps = {\n    showOther: true,\n  };\n\n  state: State = {\n    category: this.props.defaultCategory ?? PLATFORM_CATEGORIES[0].id,\n    filter: this.props.noAutoFilter ? '' : (this.props.platform || '').split('-')[0],\n  };\n\n  get platformList() {\n    const {category} = this.state;\n    const currentCategory = categoryList.find(({id}) => id === category);\n\n    const filter = this.state.filter.toLowerCase();\n\n    const subsetMatch = (platform: PlatformIntegration) =>\n      platform.id.includes(filter) ||\n      platform.name.toLowerCase().includes(filter) ||\n      filterAliases[platform.id as PlatformKey]?.some(alias => alias.includes(filter));\n\n    const categoryMatch = (platform: PlatformIntegration) =>\n      category === 'all' ||\n      (currentCategory?.platforms as undefined | string[])?.includes(platform.id);\n\n    const filtered = platforms\n      .filter(this.state.filter ? subsetMatch : categoryMatch)\n      .sort((a, b) => a.id.localeCompare(b.id));\n\n    return this.props.showOther ? filtered : filtered.filter(({id}) => id !== 'other');\n  }\n\n  logSearch = debounce(() => {\n    if (this.state.filter) {\n      trackAdvancedAnalyticsEvent(\n        'growth.platformpicker_search',\n        {\n          search: this.state.filter.toLowerCase(),\n          num_results: this.platformList.length,\n          source: this.props.source,\n        },\n        this.props.organization ?? null\n      );\n    }\n  }, 300);\n\n  @keydown('/')\n  focusSearch(e: KeyboardEvent) {\n    if (e.target !== this.searchInput.current) {\n      this.searchInput?.current?.focus();\n      e.preventDefault();\n    }\n  }\n\n  searchInput = React.createRef<HTMLInputElement>();\n\n  render() {\n    const platformList = this.platformList;\n    const {setPlatform, listProps, listClassName} = this.props;\n    const {filter, category} = this.state;\n\n    return (\n      <React.Fragment>\n        <NavContainer>\n          <CategoryNav>\n            {PLATFORM_CATEGORIES.map(({id, name}) => (\n              <ListLink\n                key={id}\n                onClick={(e: React.MouseEvent) => {\n                  trackAdvancedAnalyticsEvent(\n                    'growth.platformpicker_category',\n                    {category: id, source: this.props.source},\n                    this.props.organization ?? null\n                  );\n                  this.setState({category: id, filter: ''});\n                  e.preventDefault();\n                }}\n                to=\"\"\n                isActive={() => id === (filter ? 'all' : category)}\n              >\n                {name}\n              </ListLink>\n            ))}\n          </CategoryNav>\n          <SearchBar>\n            <IconSearch size=\"xs\" />\n            <input\n              type=\"text\"\n              ref={this.searchInput}\n              value={filter}\n              placeholder={t('Filter Platforms')}\n              onChange={e => this.setState({filter: e.target.value}, this.logSearch)}\n            />\n          </SearchBar>\n        </NavContainer>\n        <PlatformList className={listClassName} {...listProps}>\n          {platformList.map(platform => (\n            <PlatformCard\n              data-test-id={`platform-${platform.id}`}\n              key={platform.id}\n              platform={platform}\n              selected={this.props.platform === platform.id}\n              onClear={(e: React.MouseEvent) => {\n                setPlatform(null);\n                e.stopPropagation();\n              }}\n              onClick={() => {\n                trackAdvancedAnalyticsEvent(\n                  'growth.select_platform',\n                  {\n                    platform_id: platform.id,\n                    source: this.props.source,\n                  },\n                  this.props.organization ?? null\n                );\n                setPlatform(platform.id as PlatformKey);\n              }}\n            />\n          ))}\n        </PlatformList>\n        {platformList.length === 0 && (\n          <EmptyMessage\n            icon={<IconProject size=\"xl\" />}\n            title={t(\"We don't have an SDK for that yet!\")}\n          >\n            {tct(\n              `Not finding your platform? You can still create your project,\n              but looks like we don't have an official SDK for your platform\n              yet. However, there's a rich ecosystem of community supported\n              SDKs (including Perl, CFML, Clojure, and ActionScript). Try\n              [search:searching for Sentry clients] or contacting support.`,\n              {\n                search: (\n                  <ExternalLink href=\"https://github.com/search?q=-org%3Agetsentry+topic%3Asentry&type=Repositories\" />\n                ),\n              }\n            )}\n          </EmptyMessage>\n        )}\n      </React.Fragment>\n    );\n  }\n}\n\nconst NavContainer = styled('div')`\n  margin-bottom: ${space(2)};\n  display: grid;\n  grid-gap: ${space(2)};\n  grid-template-columns: 1fr minmax(0, 300px);\n  align-items: start;\n  border-bottom: 1px solid ${p => p.theme.border};\n`;\n\nconst SearchBar = styled('div')`\n  ${p => inputStyles(p)};\n  padding: 0 8px;\n  color: ${p => p.theme.subText};\n  display: flex;\n  align-items: center;\n  font-size: 15px;\n  margin-top: -${space(0.75)};\n\n  input {\n    border: none;\n    background: none;\n    padding: 2px 4px;\n    width: 100%;\n    /* Ensure a consistent line height to keep the input the desired height */\n    line-height: 24px;\n\n    &:focus {\n      outline: none;\n    }\n  }\n`;\n\nconst CategoryNav = styled(NavTabs)`\n  margin: 0;\n  margin-top: 4px;\n  white-space: nowrap;\n\n  > li {\n    float: none;\n    display: inline-block;\n  }\n`;\n\nconst StyledPlatformIcon = styled(PlatformIcon)`\n  margin: ${space(2)};\n`;\n\nconst ClearButton = styled(Button)`\n  position: absolute;\n  top: -6px;\n  right: -6px;\n  height: 22px;\n  width: 22px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 50%;\n  background: ${p => p.theme.background};\n  color: ${p => p.theme.textColor};\n`;\n\nClearButton.defaultProps = {\n  icon: <IconClose isCircled size=\"xs\" />,\n  borderless: true,\n  size: 'xsmall',\n};\n\nconst PlatformCard = styled(({platform, selected, onClear, ...props}) => (\n  <div {...props}>\n    <StyledPlatformIcon\n      platform={platform.id}\n      size={56}\n      radius={5}\n      withLanguageIcon\n      format=\"lg\"\n    />\n\n    <h3>{platform.name}</h3>\n    {selected && <ClearButton onClick={onClear} />}\n  </div>\n))`\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 0 0 14px;\n  border-radius: 4px;\n  cursor: pointer;\n  background: ${p => p.selected && p.theme.alert.info.backgroundLight};\n\n  &:hover {\n    background: ${p => p.theme.alert.muted.backgroundLight};\n  }\n\n  h3 {\n    flex-grow: 1;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 100%;\n    color: ${p => (p.selected ? p.theme.textColor : p.theme.subText)};\n    text-align: center;\n    font-size: ${p => p.theme.fontSizeExtraSmall};\n    text-transform: uppercase;\n    margin: 0;\n    padding: 0 ${space(0.5)};\n    line-height: 1.2;\n  }\n`;\n\nexport default PlatformPicker;\n"],"sourceRoot":""}