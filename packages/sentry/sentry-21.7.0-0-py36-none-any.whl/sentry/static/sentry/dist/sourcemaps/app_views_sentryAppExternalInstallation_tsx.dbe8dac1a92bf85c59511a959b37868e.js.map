{"version":3,"sources":["webpack:///./app/actionCreators/sentryAppInstallations.tsx","webpack:///./app/utils/consolidatedScopes.tsx","webpack:///./app/utils/marked.tsx","webpack:///./app/views/asyncView.tsx","webpack:///./app/components/modals/sentryAppDetailsModal.tsx","webpack:///./app/views/sentryAppExternalInstallation.tsx","webpack:///../node_modules/lodash/_baseInverter.js","webpack:///../node_modules/lodash/_createInverter.js","webpack:///../node_modules/lodash/invertBy.js"],"names":["installSentryApp","client","orgId","app","addLoadingMessage","promise","requestPromise","method","data","slug","then","clearIndicators","addErrorMessage","t","name","uninstallSentryApp","install","uuid","addSuccessMessage","PERMISSION_LEVELS","read","write","admin","HUMAN_RESOURCE_NAMES","project","team","release","event","org","member","DEFAULT_RESOURCE_PERMISSIONS","Project","Team","Release","Event","Organization","Member","PROJECT_RELEASES","permissionLevel","scope","permission","split","compareScopes","a","b","toResourcePermissions","scopes","scopeList","permissions","filteredScopes","includes","filter","Object","values","groupBy","map","sort","pop","forEach","resource","toPermissions","resourcePermissions","pick","invertBy","safeLinkPattern","safeImagePattern","isSafeHref","href","pattern","test","decodeURIComponent","unescape","SafeRenderer","title","text","out","dompurify","this","options","sanitize","marked","NoParagraphRenderer","renderer","silent","IS_ACCEPTANCE_TEST","NODE_ENV","sanitizedMarked","singleLineRenderer","AsyncView","getTitle","renderComponent","AsyncComponent","SentryAppDetailsModal","prevProps","props","organization","id","trackOpened","sentryApp","isInstalled","recordInteraction","trackIntegrationEvent","integration_type","integration","already_installed","view","integration_status","status","startSession","features","feature","feat","featureGate","replace","StyledTag","onInstall","keys","length","Title","Permission","Indicator","Text","tct","resources","join","closeModal","state","featureData","f","description","dangerouslySetInnerHTML","__html","getIntegrationFeatureGate","FeatureList","IntegrationFeatures","overview","featureProps","Heading","pluginId","size","HeadingInfo","Name","Features","featureTags","Description","provider","key","disabled","disabledReason","renderPermissions","Footer","Author","author","DisabledNotice","reason","onClick","access","hasAccess","priority","style","marginLeft","space","p","theme","gray300","color","red300","success","Tag","SentryAppExternalInstallation","selectedOrgSlug","newUrl","document","referrer","window","location","assign","undefined","api","redirectUrl","queryParams","installationId","code","orgSlug","addQueryParamsToExistingUrl","onClose","setState","reloading","Promise","all","installations","sentryAppSlug","stateKey","onSelectOrg","organizations","params","owner","isSentryAppUnavailableForOrg","OrgNameHolder","type","icon","sentryAppName","InstallLink","ownerSlug","otherOrg","label","inline","stacked","required","onChange","value","placeholder","choices","getOptions","organizationName","OrgViewHolder","isSingleOrg","renderSingleOrgView","renderMultiOrgView","checkAndRenderError","disableInstall","Content","isSentryAppInternal","renderInternalAppError","renderMainContent","baseForOwn","module","exports","object","setter","iteratee","accumulator","baseInverter","toIteratee","baseIteratee","createInverter","objectProto","prototype","hasOwnProperty","nativeObjectToString","toString","result","call","push"],"mappings":"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","file":"chunks/app_views_sentryAppExternalInstallation_tsx.xxxxxxxxxxxxxxxxxxxx.js","sourcesContent":["import {\n  addErrorMessage,\n  addLoadingMessage,\n  addSuccessMessage,\n  clearIndicators,\n} from 'app/actionCreators/indicator';\nimport {Client} from 'app/api';\nimport {t} from 'app/locale';\nimport {SentryApp, SentryAppInstallation} from 'app/types';\n\n/**\n * Install a sentry application\n *\n * @param {Object} client ApiClient\n * @param {String} orgId Organization Slug\n * @param {Object} app SentryApp\n */\nexport function installSentryApp(\n  client: Client,\n  orgId: string,\n  app: SentryApp\n): Promise<SentryAppInstallation> {\n  addLoadingMessage();\n  const promise = client.requestPromise(\n    `/organizations/${orgId}/sentry-app-installations/`,\n    {\n      method: 'POST',\n      data: {slug: app.slug},\n    }\n  );\n  promise.then(\n    () => clearIndicators(),\n    () => addErrorMessage(t(`Unable to install ${app.name}`))\n  );\n  return promise;\n}\n\n/**\n * Uninstall a sentry application\n *\n * @param {Object} client ApiClient\n * @param {Object} install SentryAppInstallation\n */\nexport function uninstallSentryApp(\n  client: Client,\n  install: SentryAppInstallation\n): Promise<void> {\n  addLoadingMessage();\n  const promise = client.requestPromise(`/sentry-app-installations/${install.uuid}/`, {\n    method: 'DELETE',\n  });\n  promise.then(\n    () => {\n      addSuccessMessage(t(`${install.app.slug} successfully uninstalled.`));\n    },\n    () => clearIndicators()\n  );\n  return promise;\n}\n","import groupBy from 'lodash/groupBy';\nimport invertBy from 'lodash/invertBy';\nimport pick from 'lodash/pick';\n\nimport {Permissions} from 'app/types';\n\nconst PERMISSION_LEVELS = {\n  read: 0,\n  write: 1,\n  admin: 2,\n};\n\nconst HUMAN_RESOURCE_NAMES = {\n  project: 'Project',\n  team: 'Team',\n  release: 'Release',\n  event: 'Event',\n  org: 'Organization',\n  member: 'Member',\n};\n\nconst DEFAULT_RESOURCE_PERMISSIONS: Permissions = {\n  Project: 'no-access',\n  Team: 'no-access',\n  Release: 'no-access',\n  Event: 'no-access',\n  Organization: 'no-access',\n  Member: 'no-access',\n};\n\nconst PROJECT_RELEASES = 'project:releases';\n\ntype PermissionLevelResources = {\n  read: string[];\n  write: string[];\n  admin: string[];\n};\n/**\n * Numerical value of the scope where Admin is higher than Write,\n * which is higher than Read. Used to sort scopes by access.\n */\nconst permissionLevel = (scope: string): number => {\n  const permission = scope.split(':')[1];\n  return PERMISSION_LEVELS[permission];\n};\n\nconst compareScopes = (a: string, b: string) => permissionLevel(a) - permissionLevel(b);\n\n/**\n * Return the most permissive scope for each resource.\n *\n * Example:\n *    Given the full list of scopes:\n *      ['project:read', 'project:write', 'team:read', 'team:write', 'team:admin']\n *\n *    this would return:\n *      ['project:write', 'team:admin']\n */\nfunction topScopes(scopeList: string[]) {\n  return Object.values(groupBy(scopeList, scope => scope.split(':')[0]))\n    .map(scopes => scopes.sort(compareScopes))\n    .map(scopes => scopes.pop());\n}\n\n/**\n * Convert into a list of Permissions, grouped by resource.\n *\n * This is used in the new/edit Sentry App form. That page displays permissions\n * in a per-Resource manner, meaning one row for Project, one for Organization, etc.\n *\n * This exposes scopes in a way that works for that UI.\n *\n * Example:\n *    {\n *      'Project': 'read',\n *      'Organization': 'write',\n *      'Team': 'no-access',\n *      ...\n *    }\n */\nfunction toResourcePermissions(scopes: string[]): Permissions {\n  const permissions = {...DEFAULT_RESOURCE_PERMISSIONS};\n  let filteredScopes = [...scopes];\n  // The scope for releases is `project:releases`, but instead of displaying\n  // it as a permission of Project, we want to separate it out into its own\n  // row for Releases.\n  if (scopes.includes(PROJECT_RELEASES)) {\n    permissions.Release = 'admin';\n    filteredScopes = scopes.filter((scope: string) => scope !== PROJECT_RELEASES); // remove project:releases\n  }\n\n  topScopes(filteredScopes).forEach((scope: string | undefined) => {\n    if (scope) {\n      const [resource, permission] = scope.split(':');\n      permissions[HUMAN_RESOURCE_NAMES[resource]] = permission;\n    }\n  });\n\n  return permissions;\n}\n\n/**\n * Convert into a list of Permissions, grouped by access and including a\n * list of resources per access level.\n *\n * This is used in the Permissions Modal when installing an App. It displays\n * scopes in a per-Permission way, meaning one row for Read, one for Write,\n * and one for Admin.\n *\n * This exposes scopes in a way that works for that UI.\n *\n * Example:\n *    {\n *      read:  ['Project', 'Organization'],\n *      write: ['Member'],\n *      admin: ['Release']\n *    }\n */\nfunction toPermissions(scopes: string[]): PermissionLevelResources {\n  const defaultPermissions = {read: [], write: [], admin: []};\n  const resourcePermissions = toResourcePermissions(scopes);\n\n  // Filter out the 'no-access' permissions\n  const permissions = pick(invertBy(resourcePermissions), ['read', 'write', 'admin']);\n  return {...defaultPermissions, ...permissions};\n}\n\nexport {toPermissions, toResourcePermissions};\n","import dompurify from 'dompurify';\nimport marked from 'marked'; // eslint-disable-line no-restricted-imports\n\nimport {IS_ACCEPTANCE_TEST, NODE_ENV} from 'app/constants';\n\n// Only https and mailto, (e.g. no javascript, vbscript, data protocols)\nconst safeLinkPattern = /^(https?:|mailto:)/i;\n\nconst safeImagePattern = /^https?:\\/\\/./i;\n\nfunction isSafeHref(href: string, pattern: RegExp) {\n  try {\n    return pattern.test(decodeURIComponent(unescape(href)));\n  } catch {\n    return false;\n  }\n}\n\n/**\n * Implementation of marked.Renderer which additonally sanitizes URLs.\n */\nclass SafeRenderer extends marked.Renderer {\n  link(href: string, title: string, text: string) {\n    // For a bad link, just return the plain text href\n    if (!isSafeHref(href, safeLinkPattern)) {\n      return href;\n    }\n\n    const out = `<a href=\"${href}\"${title ? ` title=\"${title}\"` : ''}>${text}</a>`;\n    return dompurify.sanitize(out);\n  }\n\n  image(href: string, title: string, text: string) {\n    // For a bad image, return an empty string\n    if (this.options.sanitize && !isSafeHref(href, safeImagePattern)) {\n      return '';\n    }\n\n    return `<img src=\"${href}\" alt=\"${text}\"${title ? ` title=\"${title}\"` : ''} />`;\n  }\n}\n\nclass NoParagraphRenderer extends SafeRenderer {\n  paragraph(text: string) {\n    return text;\n  }\n}\n\nmarked.setOptions({\n  renderer: new SafeRenderer(),\n  sanitize: true,\n\n  // Silence sanitize deprecation warning in test / ci (CI sets NODE_NV\n  // to production, but specifies `CI`).\n  //\n  // [!!] This has the side effect of causing failed markdown content to render\n  //      as a html error, instead of throwing an exception, however none of\n  //      our tests are rendering failed markdown so this is likely a safe\n  //      tradeoff to turn off off the deprecation warning.\n  silent: !!IS_ACCEPTANCE_TEST || NODE_ENV === 'test',\n});\n\nconst sanitizedMarked = (...args: Parameters<typeof marked>) =>\n  dompurify.sanitize(marked(...args));\n\nconst singleLineRenderer = (text: string, options: marked.MarkedOptions = {}) =>\n  sanitizedMarked(text, {...options, renderer: new NoParagraphRenderer()});\n\nexport {singleLineRenderer};\nexport default sanitizedMarked;\n","import * as React from 'react';\nimport DocumentTitle from 'react-document-title';\n\nimport AsyncComponent from 'app/components/asyncComponent';\n\ntype AsyncViewState = AsyncComponent['state'];\ntype AsyncViewProps = AsyncComponent['props'];\n\nexport default class AsyncView<\n  P extends AsyncViewProps = AsyncViewProps,\n  S extends AsyncViewState = AsyncViewState\n> extends AsyncComponent<P, S> {\n  getTitle() {\n    return '';\n  }\n\n  render() {\n    const title = this.getTitle();\n    return (\n      <DocumentTitle title={`${title ? `${title} - ` : ''}Sentry`}>\n        {this.renderComponent() as React.ReactChild}\n      </DocumentTitle>\n    );\n  }\n}\n","import * as React from 'react';\nimport styled from '@emotion/styled';\n\nimport Access from 'app/components/acl/access';\nimport AsyncComponent from 'app/components/asyncComponent';\nimport Button from 'app/components/button';\nimport CircleIndicator from 'app/components/circleIndicator';\nimport Tag from 'app/components/tag';\nimport {IconFlag} from 'app/icons';\nimport {t, tct} from 'app/locale';\nimport PluginIcon from 'app/plugins/components/pluginIcon';\nimport space from 'app/styles/space';\nimport {IntegrationFeature, Organization, SentryApp} from 'app/types';\nimport {toPermissions} from 'app/utils/consolidatedScopes';\nimport {\n  getIntegrationFeatureGate,\n  trackIntegrationEvent,\n} from 'app/utils/integrationUtil';\nimport marked, {singleLineRenderer} from 'app/utils/marked';\nimport {recordInteraction} from 'app/utils/recordSentryAppInteraction';\n\ntype Props = {\n  closeModal: () => void;\n  sentryApp: SentryApp;\n  isInstalled: boolean;\n  onInstall: () => Promise<void>;\n  organization: Organization;\n} & AsyncComponent['props'];\n\ntype State = {\n  featureData: IntegrationFeature[];\n} & AsyncComponent['state'];\n\n// No longer a modal anymore but yea :)\nexport default class SentryAppDetailsModal extends AsyncComponent<Props, State> {\n  componentDidUpdate(prevProps: Props) {\n    // if the user changes org, count this as a fresh event to track\n    if (this.props.organization.id !== prevProps.organization.id) {\n      this.trackOpened();\n    }\n  }\n\n  componentDidMount() {\n    this.trackOpened();\n  }\n\n  trackOpened() {\n    const {sentryApp, organization, isInstalled} = this.props;\n    recordInteraction(sentryApp.slug, 'sentry_app_viewed');\n\n    trackIntegrationEvent(\n      'integrations.install_modal_opened',\n      {\n        integration_type: 'sentry_app',\n        integration: sentryApp.slug,\n        already_installed: isInstalled,\n        view: 'external_install',\n        integration_status: sentryApp.status,\n      },\n      organization,\n      {startSession: true}\n    );\n  }\n\n  getEndpoints(): ReturnType<AsyncComponent['getEndpoints']> {\n    const {sentryApp} = this.props;\n    return [['featureData', `/sentry-apps/${sentryApp.slug}/features/`]];\n  }\n\n  featureTags(features: Pick<IntegrationFeature, 'featureGate'>[]) {\n    return features.map(feature => {\n      const feat = feature.featureGate.replace(/integrations/g, '');\n      return <StyledTag key={feat}>{feat.replace(/-/g, ' ')}</StyledTag>;\n    });\n  }\n\n  get permissions() {\n    return toPermissions(this.props.sentryApp.scopes);\n  }\n\n  async onInstall() {\n    const {onInstall} = this.props;\n    // we want to make sure install finishes before we close the modal\n    // and we should close the modal if there is an error as well\n    try {\n      await onInstall();\n    } catch (_err) {\n      /* stylelint-disable-next-line no-empty-block */\n    }\n  }\n\n  renderPermissions() {\n    const permissions = this.permissions;\n    if (\n      Object.keys(permissions).filter(scope => permissions[scope].length > 0).length === 0\n    ) {\n      return null;\n    }\n\n    return (\n      <React.Fragment>\n        <Title>Permissions</Title>\n        {permissions.read.length > 0 && (\n          <Permission>\n            <Indicator />\n            <Text key=\"read\">\n              {tct('[read] access to [resources] resources', {\n                read: <strong>Read</strong>,\n                resources: permissions.read.join(', '),\n              })}\n            </Text>\n          </Permission>\n        )}\n        {permissions.write.length > 0 && (\n          <Permission>\n            <Indicator />\n            <Text key=\"write\">\n              {tct('[read] and [write] access to [resources] resources', {\n                read: <strong>Read</strong>,\n                write: <strong>Write</strong>,\n                resources: permissions.write.join(', '),\n              })}\n            </Text>\n          </Permission>\n        )}\n        {permissions.admin.length > 0 && (\n          <Permission>\n            <Indicator />\n            <Text key=\"admin\">\n              {tct('[admin] access to [resources] resources', {\n                admin: <strong>Admin</strong>,\n                resources: permissions.admin.join(', '),\n              })}\n            </Text>\n          </Permission>\n        )}\n      </React.Fragment>\n    );\n  }\n\n  renderBody() {\n    const {sentryApp, closeModal, isInstalled, organization} = this.props;\n    const {featureData} = this.state;\n    // Prepare the features list\n    const features = (featureData || []).map(f => ({\n      featureGate: f.featureGate,\n      description: (\n        <span dangerouslySetInnerHTML={{__html: singleLineRenderer(f.description)}} />\n      ),\n    }));\n\n    const {FeatureList, IntegrationFeatures} = getIntegrationFeatureGate();\n\n    const overview = sentryApp.overview || '';\n    const featureProps = {organization, features};\n\n    return (\n      <React.Fragment>\n        <Heading>\n          <PluginIcon pluginId={sentryApp.slug} size={50} />\n\n          <HeadingInfo>\n            <Name>{sentryApp.name}</Name>\n            {!!features.length && <Features>{this.featureTags(features)}</Features>}\n          </HeadingInfo>\n        </Heading>\n\n        <Description dangerouslySetInnerHTML={{__html: marked(overview)}} />\n        <FeatureList {...featureProps} provider={{...sentryApp, key: sentryApp.slug}} />\n\n        <IntegrationFeatures {...featureProps}>\n          {({disabled, disabledReason}) => (\n            <React.Fragment>\n              {!disabled && this.renderPermissions()}\n              <Footer>\n                <Author>{t('Authored By %s', sentryApp.author)}</Author>\n                <div>\n                  {disabled && <DisabledNotice reason={disabledReason} />}\n                  <Button size=\"small\" onClick={closeModal}>\n                    {t('Cancel')}\n                  </Button>\n\n                  <Access organization={organization} access={['org:integrations']}>\n                    {({hasAccess}) =>\n                      hasAccess && (\n                        <Button\n                          size=\"small\"\n                          priority=\"primary\"\n                          disabled={isInstalled || disabled}\n                          onClick={() => this.onInstall()}\n                          style={{marginLeft: space(1)}}\n                          data-test-id=\"install\"\n                        >\n                          {t('Accept & Install')}\n                        </Button>\n                      )\n                    }\n                  </Access>\n                </div>\n              </Footer>\n            </React.Fragment>\n          )}\n        </IntegrationFeatures>\n      </React.Fragment>\n    );\n  }\n}\n\nconst Heading = styled('div')`\n  display: grid;\n  grid-template-columns: max-content 1fr;\n  grid-gap: ${space(1)};\n  align-items: center;\n  margin-bottom: ${space(2)};\n`;\n\nconst HeadingInfo = styled('div')`\n  display: grid;\n  grid-template-rows: max-content max-content;\n  align-items: start;\n`;\n\nconst Name = styled('div')`\n  font-weight: bold;\n  font-size: 1.4em;\n`;\n\nconst Description = styled('div')`\n  font-size: 1.5rem;\n  line-height: 2.1rem;\n  margin-bottom: ${space(2)};\n\n  li {\n    margin-bottom: 6px;\n  }\n`;\n\nconst Author = styled('div')`\n  color: ${p => p.theme.gray300};\n`;\n\nconst DisabledNotice = styled(({reason, ...p}: {reason: React.ReactNode}) => (\n  <div {...p}>\n    <IconFlag color=\"red300\" size=\"1.5em\" />\n    {reason}\n  </div>\n))`\n  display: grid;\n  align-items: center;\n  flex: 1;\n  grid-template-columns: max-content 1fr;\n  color: ${p => p.theme.red300};\n  font-size: 0.9em;\n`;\n\nconst Text = styled('p')`\n  margin: 0px 6px;\n`;\n\nconst Permission = styled('div')`\n  display: flex;\n`;\n\nconst Footer = styled('div')`\n  display: flex;\n  padding: 20px 30px;\n  border-top: 1px solid #e2dee6;\n  margin: 20px -30px -30px;\n  justify-content: space-between;\n`;\n\nconst Title = styled('p')`\n  margin-bottom: ${space(1)};\n  font-weight: bold;\n`;\n\nconst Indicator = styled(p => <CircleIndicator size={7} {...p} />)`\n  margin-top: 7px;\n  color: ${p => p.theme.success};\n`;\n\nconst Features = styled('div')`\n  margin: -${space(0.5)};\n`;\n\nconst StyledTag = styled(Tag)`\n  padding: ${space(0.5)};\n`;\n","import {RouteComponentProps} from 'react-router';\nimport styled from '@emotion/styled';\n\nimport {addErrorMessage} from 'app/actionCreators/indicator';\nimport {installSentryApp} from 'app/actionCreators/sentryAppInstallations';\nimport Alert from 'app/components/alert';\nimport OrganizationAvatar from 'app/components/avatar/organizationAvatar';\nimport SelectControl from 'app/components/forms/selectControl';\nimport SentryAppDetailsModal from 'app/components/modals/sentryAppDetailsModal';\nimport NarrowLayout from 'app/components/narrowLayout';\nimport {IconFlag} from 'app/icons';\nimport {t, tct} from 'app/locale';\nimport {\n  LightWeightOrganization,\n  Organization,\n  SentryApp,\n  SentryAppInstallation,\n} from 'app/types';\nimport {trackIntegrationEvent} from 'app/utils/integrationUtil';\nimport {addQueryParamsToExistingUrl} from 'app/utils/queryString';\nimport AsyncView from 'app/views/asyncView';\nimport Field from 'app/views/settings/components/forms/field';\n\ntype Props = RouteComponentProps<{sentryAppSlug: string}, {}>;\n\ntype State = AsyncView['state'] & {\n  selectedOrgSlug: string | null;\n  organization: Organization | null;\n  organizations: LightWeightOrganization[];\n  reloading: boolean;\n  sentryApp: SentryApp;\n};\n\nexport default class SentryAppExternalInstallation extends AsyncView<Props, State> {\n  getDefaultState() {\n    const state = super.getDefaultState();\n    return {\n      ...state,\n      selectedOrgSlug: null,\n      organization: null,\n      organizations: [],\n      reloading: false,\n    };\n  }\n\n  getEndpoints(): ReturnType<AsyncView['getEndpoints']> {\n    return [\n      ['organizations', '/organizations/'],\n      ['sentryApp', `/sentry-apps/${this.sentryAppSlug}/`],\n    ];\n  }\n\n  getTitle() {\n    return t('Choose Installation Organization');\n  }\n\n  get sentryAppSlug() {\n    return this.props.params.sentryAppSlug;\n  }\n\n  get isSingleOrg() {\n    return this.state.organizations.length === 1;\n  }\n\n  get isSentryAppInternal() {\n    const {sentryApp} = this.state;\n    return sentryApp && sentryApp.status === 'internal';\n  }\n\n  get isSentryAppUnavailableForOrg() {\n    const {sentryApp, selectedOrgSlug} = this.state;\n    // if the app is unpublished for a different org\n    return (\n      selectedOrgSlug &&\n      sentryApp?.owner?.slug !== selectedOrgSlug &&\n      sentryApp.status === 'unpublished'\n    );\n  }\n\n  get disableInstall() {\n    const {reloading, isInstalled} = this.state;\n    return isInstalled || reloading || this.isSentryAppUnavailableForOrg;\n  }\n\n  hasAccess = (org: LightWeightOrganization) => org.access.includes('org:integrations');\n\n  onClose = () => {\n    // if we came from somewhere, go back there. Otherwise, back to the integrations page\n    const {selectedOrgSlug} = this.state;\n    const newUrl = document.referrer || `/settings/${selectedOrgSlug}/integrations/`;\n    window.location.assign(newUrl);\n  };\n\n  onInstall = async (): Promise<any | undefined> => {\n    const {organization, sentryApp} = this.state;\n    if (!organization || !sentryApp) {\n      return undefined;\n    }\n    trackIntegrationEvent(\n      'integrations.installation_start',\n      {\n        integration_type: 'sentry_app',\n        integration: sentryApp.slug,\n        view: 'external_install',\n        integration_status: sentryApp.status,\n      },\n      organization\n    );\n\n    const install = await installSentryApp(this.api, organization.slug, sentryApp);\n    // installation is complete if the status is installed\n    if (install.status === 'installed') {\n      trackIntegrationEvent(\n        'integrations.installation_complete',\n        {\n          integration_type: 'sentry_app',\n          integration: sentryApp.slug,\n          view: 'external_install',\n          integration_status: sentryApp.status,\n        },\n        organization\n      );\n    }\n\n    if (sentryApp.redirectUrl) {\n      const queryParams = {\n        installationId: install.uuid,\n        code: install.code,\n        orgSlug: organization.slug,\n      };\n      const redirectUrl = addQueryParamsToExistingUrl(sentryApp.redirectUrl, queryParams);\n      return window.location.assign(redirectUrl);\n    }\n    return this.onClose();\n  };\n\n  onSelectOrg = async (orgSlug: string) => {\n    this.setState({selectedOrgSlug: orgSlug, reloading: true});\n\n    try {\n      const [organization, installations]: [Organization, SentryAppInstallation[]] =\n        await Promise.all([\n          this.api.requestPromise(`/organizations/${orgSlug}/`),\n          this.api.requestPromise(`/organizations/${orgSlug}/sentry-app-installations/`),\n        ]);\n      const isInstalled = installations\n        .map(install => install.app.slug)\n        .includes(this.sentryAppSlug);\n      // all state fields should be set at the same time so analytics in SentryAppDetailsModal works properly\n      this.setState({organization, isInstalled, reloading: false});\n    } catch (err) {\n      addErrorMessage(t('Failed to retrieve organization or integration details'));\n      this.setState({reloading: false});\n    }\n  };\n\n  onRequestSuccess = ({stateKey, data}) => {\n    // if only one org, we can immediately update our selected org\n    if (stateKey === 'organizations' && data.length === 1) {\n      this.onSelectOrg(data[0].slug);\n    }\n  };\n\n  getOptions() {\n    return this.state.organizations.map(org => [\n      org.slug,\n      <div key={org.slug}>\n        <OrganizationAvatar organization={org} />\n        <OrgNameHolder>{org.slug}</OrgNameHolder>\n      </div>,\n    ]);\n  }\n\n  renderInternalAppError() {\n    const {sentryApp} = this.state;\n    return (\n      <Alert type=\"error\" icon={<IconFlag size=\"md\" />}>\n        {tct(\n          'Integration [sentryAppName] is an internal integration. Internal integrations are automatically installed',\n          {\n            sentryAppName: <strong>{sentryApp.name}</strong>,\n          }\n        )}\n      </Alert>\n    );\n  }\n\n  checkAndRenderError() {\n    const {organization, selectedOrgSlug, isInstalled, sentryApp} = this.state;\n    if (selectedOrgSlug && organization && !this.hasAccess(organization)) {\n      return (\n        <Alert type=\"error\" icon={<IconFlag size=\"md\" />}>\n          <p>\n            {tct(\n              `You do not have permission to install integrations in\n          [organization]. Ask an organization owner or manager to\n          visit this page to finish installing this integration.`,\n              {organization: <strong>{organization.slug}</strong>}\n            )}\n          </p>\n          <InstallLink>{window.location.href}</InstallLink>\n        </Alert>\n      );\n    }\n    if (isInstalled && organization) {\n      return (\n        <Alert type=\"error\" icon={<IconFlag size=\"md\" />}>\n          {tct('Integration [sentryAppName] already installed for [organization]', {\n            organization: <strong>{organization.name}</strong>,\n            sentryAppName: <strong>{sentryApp.name}</strong>,\n          })}\n        </Alert>\n      );\n    }\n\n    if (this.isSentryAppUnavailableForOrg) {\n      // use the slug of the owner if we have it, otherwise use 'another organization'\n      const ownerSlug = sentryApp?.owner?.slug ?? 'another organization';\n      return (\n        <Alert type=\"error\" icon={<IconFlag size=\"md\" />}>\n          {tct(\n            'Integration [sentryAppName] is an unpublished integration for [otherOrg]. An unpublished integration can only be installed on the organization which created it.',\n            {\n              sentryAppName: <strong>{sentryApp.name}</strong>,\n              otherOrg: <strong>{ownerSlug}</strong>,\n            }\n          )}\n        </Alert>\n      );\n    }\n\n    return null;\n  }\n\n  renderMultiOrgView() {\n    const {selectedOrgSlug, sentryApp} = this.state;\n    return (\n      <div>\n        <p>\n          {tct(\n            'Please pick a specific [organization:organization] to install [sentryAppName]',\n            {\n              organization: <strong />,\n              sentryAppName: <strong>{sentryApp.name}</strong>,\n            }\n          )}\n        </p>\n        <Field label={t('Organization')} inline={false} stacked required>\n          {() => (\n            <SelectControl\n              onChange={({value}) => this.onSelectOrg(value)}\n              value={selectedOrgSlug}\n              placeholder={t('Select an organization')}\n              choices={this.getOptions()}\n            />\n          )}\n        </Field>\n      </div>\n    );\n  }\n\n  renderSingleOrgView() {\n    const {organizations, sentryApp} = this.state;\n    // pull the name out of organizations since state.organization won't be loaded initially\n    const organizationName = organizations[0].name;\n    return (\n      <div>\n        <p>\n          {tct('You are installing [sentryAppName] for organization [organization]', {\n            organization: <strong>{organizationName}</strong>,\n            sentryAppName: <strong>{sentryApp.name}</strong>,\n          })}\n        </p>\n      </div>\n    );\n  }\n\n  renderMainContent() {\n    const {organization, sentryApp} = this.state;\n    return (\n      <div>\n        <OrgViewHolder>\n          {this.isSingleOrg ? this.renderSingleOrgView() : this.renderMultiOrgView()}\n        </OrgViewHolder>\n        {this.checkAndRenderError()}\n        {organization && (\n          <SentryAppDetailsModal\n            sentryApp={sentryApp}\n            organization={organization}\n            onInstall={this.onInstall}\n            closeModal={this.onClose}\n            isInstalled={this.disableInstall}\n          />\n        )}\n      </div>\n    );\n  }\n\n  renderBody() {\n    return (\n      <NarrowLayout>\n        <Content>\n          <h3>{t('Finish integration installation')}</h3>\n          {this.isSentryAppInternal\n            ? this.renderInternalAppError()\n            : this.renderMainContent()}\n        </Content>\n      </NarrowLayout>\n    );\n  }\n}\n\nconst InstallLink = styled('pre')`\n  margin-bottom: 0;\n  background: #fbe3e1;\n`;\n\nconst OrgNameHolder = styled('span')`\n  margin-left: 5px;\n`;\n\nconst Content = styled('div')`\n  margin-bottom: 40px;\n`;\n\nconst OrgViewHolder = styled('div')`\n  margin-bottom: 20px;\n`;\n","var baseForOwn = require('./_baseForOwn');\n\n/**\n * The base implementation of `_.invert` and `_.invertBy` which inverts\n * `object` with values transformed by `iteratee` and set by `setter`.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} setter The function to set `accumulator` values.\n * @param {Function} iteratee The iteratee to transform values.\n * @param {Object} accumulator The initial inverted object.\n * @returns {Function} Returns `accumulator`.\n */\nfunction baseInverter(object, setter, iteratee, accumulator) {\n  baseForOwn(object, function(value, key, object) {\n    setter(accumulator, iteratee(value), key, object);\n  });\n  return accumulator;\n}\n\nmodule.exports = baseInverter;\n","var baseInverter = require('./_baseInverter');\n\n/**\n * Creates a function like `_.invertBy`.\n *\n * @private\n * @param {Function} setter The function to set accumulator values.\n * @param {Function} toIteratee The function to resolve iteratees.\n * @returns {Function} Returns the new inverter function.\n */\nfunction createInverter(setter, toIteratee) {\n  return function(object, iteratee) {\n    return baseInverter(object, setter, toIteratee(iteratee), {});\n  };\n}\n\nmodule.exports = createInverter;\n","var baseIteratee = require('./_baseIteratee'),\n    createInverter = require('./_createInverter');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * This method is like `_.invert` except that the inverted object is generated\n * from the results of running each element of `object` thru `iteratee`. The\n * corresponding inverted value of each inverted key is an array of keys\n * responsible for generating the inverted value. The iteratee is invoked\n * with one argument: (value).\n *\n * @static\n * @memberOf _\n * @since 4.1.0\n * @category Object\n * @param {Object} object The object to invert.\n * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n * @returns {Object} Returns the new inverted object.\n * @example\n *\n * var object = { 'a': 1, 'b': 2, 'c': 1 };\n *\n * _.invertBy(object);\n * // => { '1': ['a', 'c'], '2': ['b'] }\n *\n * _.invertBy(object, function(value) {\n *   return 'group' + value;\n * });\n * // => { 'group1': ['a', 'c'], 'group2': ['b'] }\n */\nvar invertBy = createInverter(function(result, value, key) {\n  if (value != null &&\n      typeof value.toString != 'function') {\n    value = nativeObjectToString.call(value);\n  }\n\n  if (hasOwnProperty.call(result, value)) {\n    result[value].push(key);\n  } else {\n    result[value] = [key];\n  }\n}, baseIteratee);\n\nmodule.exports = invertBy;\n"],"sourceRoot":""}