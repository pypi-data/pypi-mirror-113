(()=>{"use strict";var e,t,o,a={42959:(e,t,o)=>{var a=o(63025),n=o(53806),i=o.n(n),r=o(12394);const c=a.ZP.bind(null,{endpoint:"rb.check_room_available",rules:[{args:["room_id"],converters:{room_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"room_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"availability",isDynamic:!1},{data:"/",isDynamic:!1},{data:"simple",isDynamic:!1}]}]},"/"),l=a.ZP.bind(null,{endpoint:"rb.roombooking",rules:[{args:["path"],converters:{path:"PathConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"path",isDynamic:!0}]},{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1}]}]},"/");window.setupEventCreationDialog=function(e){e=$.extend({categoryField:null,protectionModeFields:null,initialCategory:null,checkAvailability:!1,rbExcludedCategories:null,serverDefaultTimezone:null},e);const t=$($.parseHTML($("#event-creation-protection-messages").html())),o=$("<div>",{class:"form-group",css:{marginTop:"5px"}}),a=$("#event-creation-create_booking"),n=$("#room-available"),d=$("#room-available-prebook"),s=$("#room-conflict-booking"),m=$("#room-conflict-prebooking"),v=$("#room-conflict-prebooking-prebook"),g=$("#room-user-booking"),f=$("#room-user-prebooking"),u=$("#room-unbookable"),p=$("#room-cannot-book"),h=$("#create-booking"),b=$("#create-prebooking"),y=$("#create-booking-over-prebooking"),D=$("#create-prebooking-over-prebooking");let _,k,Y,M,O,H,j,S=null,T=!1;function P(){let a=e.protectionModeFields.filter(":checked").val();"inheriting"===a&&(a=S.is_protected?"inheriting-protected":"inheriting-public");const n=t.filter(".{0}-protection-message".format(a));n.find(".js-category-title").text(S.title),o.html(n)}function x(e){Y=i()(`${e.date} ${e.time}`,"YYYY-MM-DD HH:mm"),M=i()(Y).add(e.duration,"minutes")}function F(t){return e.rbExcludedCategories.some((e=>parseInt(e.id,10)===t))}function w(e){const t={path:"calendar",date:Y.format("YYYY-MM-DD"),text:H.room_name},o=l(t);e.find("a").prop("href",o)}function C(e){k&&(e&&($("#availability-messages").find("input[id^='create']").prop("checked",!1),a.val("false")),k.hide())}function E(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(C(t),!("room_id"in H)||!Y.isValid()||!M.isValid()||!Y.isSame(M,"day")||Y.isSameOrAfter(M)||F(O.id)||j!==e.serverDefaultTimezone||T)return void a.val("false");const o={room_id:H.room_id,start_dt:Y.format(i().HTML5_FMT.DATETIME_LOCAL),end_dt:M.format(i().HTML5_FMT.DATETIME_LOCAL)};$.ajax({url:c(o),method:"GET",dataType:"json",contentType:"application/json",error:handleAjaxError,success(e){(e=(0,r.k)(e)).userBooking?(a.val("false"),k=g,w(k)):e.userPrebooking?(a.val("false"),k=f,w(k)):e.conflictBooking?(a.val("false"),k=s,w(k)):e.unbookable?(a.val("false"),k=u,w(k)):e.conflictPrebooking?e.canBook?(a.val(String(y[0].checked)),k=m,w(k)):e.canPrebook?(a.val(String(D[0].checked)),k=v,w(k)):(a.val("false"),k=p):e.canBook?(a.val(String(h[0].checked)),k=n):e.canPrebook?(a.val(String(b[0].checked)),k=d):(a.val("false"),k=p),k.show()}})}o.appendTo(e.protectionModeFields.closest(".form-field")),e.categoryField.on("indico:categorySelected",((t,o)=>{S||(e.protectionModeFields.prop("disabled",!1),e.protectionModeFields.filter("[value=inheriting]").prop("checked",!0)),S=o,P()})),e.protectionModeFields.on("change",(function(){P()})),e.initialCategory?e.categoryField.trigger("indico:categorySelected",[e.initialCategory]):e.protectionModeFields.prop("disabled",!0),e.checkAvailability&&(function(){const e=$("#event-creation-start_dt-datestorage").val(),t=$("#event-creation-start_dt-timestorage").val(),o=$("#event-creation-end_dt-datestorage").val(),a=$("#event-creation-end_dt-timestorage").val(),n=$("#event-creation-occurrences").val(),r=n?JSON.parse(n):null;H=JSON.parse($("#event-creation-location_data").val()),j=$("#event-creation-timezone").val(),O=JSON.parse($("#event-creation-category").val()),r&&1===r.length?x(r[0]):(Y=i()(`${e} ${t}`,"DD/MM/YYYY HH:mm"),M=i()(`${o} ${a}`,"DD/MM/YYYY HH:mm"))}(),$("#event-creation-location_data").on("change",(function(){H=JSON.parse($(this).val()),_!==H.room_id&&(_=H.room_id,E(!0))})),$("#event-creation-start_dt-datestorage").on("change",(function(){const e=$(this).val(),t=$("#event-creation-start_dt-timestorage").val(),o=$("#event-creation-end_dt-datestorage").val(),a=$("#event-creation-end_dt-timestorage").val();Y=i()(`${e} ${t}`,"DD/MM/YYYY HH:mm"),M=i()(`${o} ${a}`,"DD/MM/YYYY HH:mm"),M.isBefore(Y)&&(M=i()(`${e} ${a}`,"DD/MM/YYYY HH:mm")),E()})),$("#event-creation-start_dt-timestorage").on("change",(function(){const e=$("#event-creation-start_dt-datestorage").val(),t=$("#event-creation-start_dt-timestorage").val();Y=i()(`${e} ${t}`,"DD/MM/YYYY HH:mm"),E()})),$("#event-creation-end_dt-datestorage").on("change",(function(){const e=$(this).val(),t=$("#event-creation-end_dt-timestorage").val();M=i()(`${e} ${t}`,"DD/MM/YYYY HH:mm"),E()})),$("#event-creation-end_dt-timestorage").on("change",(function(){const e=$("#event-creation-end_dt-datestorage").val(),t=$(this).val();M=i()(`${e} ${t}`,"DD/MM/YYYY HH:mm"),E()})),$("#event-creation-occurrences").on("change",(function(){const e=JSON.parse($(this).val());1===e.length?(x(e[0]),T=!1):T=!0,E()})),$("#event-creation-timezone").on("change",(function(){j=$(this).val(),E()})),$("#event-creation-category").on("change",(function(){O=JSON.parse($(this).val()),E()})),h.add(b).add(y).add(D).on("change",(function(){a.val(String(this.checked))})))}}},n={};function i(e){var t=n[e];if(void 0!==t)return t.exports;var o=n[e]={id:e,loaded:!1,exports:{}};return a[e].call(o.exports,o,o.exports,i),o.loaded=!0,o.exports}i.m=a,e=[],i.O=(t,o,a,n)=>{if(!o){var r=1/0;for(d=0;d<e.length;d++){for(var[o,a,n]=e[d],c=!0,l=0;l<o.length;l++)(!1&n||r>=n)&&Object.keys(i.O).every((e=>i.O[e](o[l])))?o.splice(l--,1):(c=!1,n<r&&(r=n));c&&(e.splice(d--,1),t=a())}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[o,a,n]},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},o=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,i.t=function(e,a){if(1&a&&(e=this(e)),8&a)return e;if("object"==typeof e&&e){if(4&a&&e.__esModule)return e;if(16&a&&"function"==typeof e.then)return e}var n=Object.create(null);i.r(n);var r={};t=t||[null,o({}),o([]),o(o)];for(var c=2&a&&e;"object"==typeof c&&!~t.indexOf(c);c=o(c))Object.getOwnPropertyNames(c).forEach((t=>r[t]=()=>e[t]));return r.default=()=>e,i.d(n,r),n},i.d=(e,t)=>{for(var o in t)i.o(t,o)&&!i.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},i.e=()=>Promise.resolve(),i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),i.j=8749,(()=>{var e={8749:0};i.O.j=t=>0===e[t];var t=(t,o)=>{var a,n,[r,c,l]=o,d=0;for(a in c)i.o(c,a)&&(i.m[a]=c[a]);if(l)var s=l(i);for(t&&t(o);d<r.length;d++)n=r[d],i.o(e,n)&&e[n]&&e[n][0](),e[r[d]]=0;return i.O(s)},o=self.webpackChunk=self.webpackChunk||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var r=i.O(void 0,[8592],(()=>i(42959)));r=i.O(r)})();
//# sourceMappingURL=module_events.creation.ad0a7fcc.bundle.js.map