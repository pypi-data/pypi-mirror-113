(()=>{"use strict";var e,t,n,o={842:(e,t,n)=>{var o=n(85973),a=n.n(o),r=n(37213),c=n.n(r),s=n(55156),i=n(28995);!function(e){const t={};function n(e){void 0===t[e]&&(t[e]=e,$.ajax({url:build_url(Indico.Urls.Categories.info,{category_id:e}),dataType:"json",error(e){e.status&&403!==e.status&&handleAjaxError(e)},success(n){t[e]=n}}))}function o(e,t,n){const o=a()(t)?t.category.id:t,r={category_id:e};$("<div>").categorynavigator({category:t,confirmation:!0,openInDialog:!0,actionButtonText:i.$T.gettext("Move here"),dialogTitle:i.$T.ngettext("Move category","Move categories",e.length),dialogSubtitle:i.$T.ngettext("Select new category parent for the category","Select new category parent for {0} selected categories",e.length).format(e.length),actionOn:{categoriesDescendingFrom:{disabled:!0,ids:e},categories:{disabled:!0,groups:[{ids:[o],message:i.$T.ngettext("The category is already here","The selected categories are already here",e.length)},{ids:e,message:i.$T.ngettext("This is the category you are trying to move","This is one of the categories you are trying to move",e.length)}]}},onAction(e){$.ajax({url:n,type:"POST",data:$.extend({target_category_id:e.id},r),error:handleAjaxError,success(e){e.success&&location.reload()}})}})}function r(e,t,n){const o=a()(e)?e.category.id:e,r=n?n.all_selected?$("#event-management").data("total"):n.event_id.length:1;$("<div>").categorynavigator({category:e,confirmation:!0,openInDialog:!0,actionButtonText:i.$T.gettext("Move here"),dialogTitle:i.$T.ngettext("Move event","Move events",r),dialogSubtitle:i.$T.ngettext("Select category destination for the event","Select category destination for {0} selected events".format(r),r),actionOn:{categoriesWithoutEventCreationRights:{disabled:!0},categories:{disabled:!0,ids:[o],message:i.$T.ngettext("The event is already here","The selected events are already here",r)}},onAction(e){$.ajax({url:t,type:"POST",data:$.extend({target_category_id:e.id},n||{}),error:handleAjaxError,success(e){e.success&&location.reload()}})}})}e.setupCategoryMoveButton=function(e){e&&n(e),$(".js-move-category").on("click",(function(){const n=$(this);o([n.data("categoryId")],t[e],n.data("href"))}))},e.setupCategoryTable=function(e){n(e);const a=$("table.category-management"),r=a.find("tbody"),c=$(".js-bulk-delete-category"),s=$(".js-bulk-move-category"),l="tr[data-category-id]",d="input[name=category_id]";function g(){return r.find(l).map((function(){return $(this).data("category-id")})).toArray()}function u(e){return $.ajax({url:a.data("sort-url"),method:"POST",data:JSON.stringify({categories:e}),dataType:"json",contentType:"application/json",error:handleAjaxError})}function h(e){e?$(".banner .js-delete-category").removeClass("disabled").attr("title",i.$T.gettext("Delete category")):$(".banner .js-delete-category").addClass("disabled").attr("title",i.$T.gettext("This category cannot be deleted because it is not empty."))}function f(){return a.find(l).find(`${d}:checked`).map((function(){return this.value})).toArray()}function y(){return a.find(l).has(`${d}:checked`)}$(".js-sort-categories").on("click",(function(){const e=$(this).data("sort-order"),t=g();!function(e){r.find(l).sort((function(t,n){return e*strnatcmp($(t).data("category-title").toLowerCase(),$(n).data("category-title").toLowerCase())})).detach().appendTo(r)}(e),u(g()),cornerMessage({actionLabel:i.$T.gettext("Undo"),actionCallback:function(){var e;return e=t,$.each(e,(function(e,t){r.find(`[data-category-id=${t}]`).not(".js-move-category").detach().appendTo(r)})),u(t)},feedbackMessage:i.$T.gettext("The category order has been restored."),duration:1e4,message:i.$T.gettext("The category list has been sorted.")})})),s.on("click",(function(n){const a=$(this);n.preventDefault(),a.hasClass("disabled")||o(f(),t[e],a.data("href"))})),a.find(".js-move-category").on("click",(function(){const n=$(this);o([n.data("categoryId")],t[e],n.data("href"))})),a.find(".js-delete-category").on("indico:confirmed",(function(e){e.preventDefault();const t=$(this);$.ajax({url:t.data("href"),method:"POST",error:handleAjaxError,success(e){t.closest(l).remove(),h(e.is_parent_empty)}})})),enableIfChecked(r,d,c,(function(e){return 0===e.filter(":not([data-is-empty=true])").length})),c.on("click",(function(){const e=y();ajaxDialog({url:a.data("bulk-delete-url"),method:"POST",title:i.$T.gettext("Delete categories"),data:{category_id:f()},onClose(t){t&&t.success&&(e.find("input[type=checkbox]").prop("checked",!1),e.remove(),h(t.is_empty))}})})).qtip({suppress:!1,content:{text:function(){const e=y();return e.length?c.hasClass("disabled")?i.$T.gettext("At least one selected category cannot be deleted because it is not empty."):i.$T.ngettext("Delete the selected category","Delete {0} selected categories",e.length).format(e.length):i.$T.gettext("Select the categories to delete first.")}}}),enableIfChecked(r,d,s),s.qtip({suppress:!1,content:{text:function(){const e=y();return e.length?i.$T.ngettext("Move the selected category","Move the {0} selected categories",e.length).format(e.length):i.$T.gettext("Select the categories to move first.")}}}),r.sortable({axis:"y",containment:"parent",cursor:"move",handle:".js-handle",items:"> tr",tolerance:"pointer",update(){u(g())}})},e.setupCategoryEventList=function(e){let o=!1;n(e),enableIfChecked("#event-management","input[name=event_id]",".js-enabled-if-checked"),$(".event-management .js-move-event-to-subcategory").on("click",(function(n){n.preventDefault(),r(t[e],$(this).data("href"))})),$(".js-event-management-toolbar .js-move-events-to-subcategory").on("click",(function(n){if(n.preventDefault(),$(this).hasClass("disabled"))return;const a={};o()?a.all_selected=1:a.event_id=c()($("#event-management input[name=event_id]:checkbox:checked"),(function(e){return e.value})),r(t[e],$(this).data("href"),a)})),o=paginatedSelectAll({containerSelector:"#event-management",checkboxSelector:"input:checkbox[name=event_id]",allSelectedSelector:"input:checkbox[name=all_selected]",selectionMessageSelector:"#selection-message",totalRows:$("#event-management").data("total"),messages:{allSelected:e=>i.$T.ngettext("*","All {0} events in this category are currently selected.").format(e),pageSelected:(e,t)=>i.$T.ngettext("Only {0} out of {1} events is currently selected.","Only {0} out of {1} events are currently selected.",e).format(e,t)}}).isEverythingSelected},e.setupCategoryRolesList=function(){!function(){const e=$("#event-roles");e.on("click",".toggle-members",(function(){const e=$(this).closest("tr").next("tr").find(".slide");e.css("max-height",`${e[0].scrollHeight}px`),e.toggleClass("open close")})),e.on("indico:htmlUpdated",(function(){$(this).find(".slide").each((function(){$(this).css("max-height",`${this.scrollHeight}px`)}))}))}(),$("#event-roles").on("click",".js-add-members",(async e=>{e.stopPropagation();const t=$(e.target),n=await(0,s.E)({withExternalUsers:!0});n.length&&$.ajax({url:t.data("href"),method:t.data("method"),data:JSON.stringify({users:n}),dataType:"json",contentType:"application/json",error:handleAjaxError,complete:IndicoUI.Dialogs.Util.progress(),success(e){updateHtml(t.data("update"),e)}})}))}}(window)}},a={};function r(e){var t=a[e];if(void 0!==t)return t.exports;var n=a[e]={id:e,loaded:!1,exports:{}};return o[e].call(n.exports,n,n.exports,r),n.loaded=!0,n.exports}r.m=o,e=[],r.O=(t,n,o,a)=>{if(!n){var c=1/0;for(l=0;l<e.length;l++){for(var[n,o,a]=e[l],s=!0,i=0;i<n.length;i++)(!1&a||c>=a)&&Object.keys(r.O).every((e=>r.O[e](n[i])))?n.splice(i--,1):(s=!1,a<c&&(c=a));s&&(e.splice(l--,1),t=o())}return t}a=a||0;for(var l=e.length;l>0&&e[l-1][2]>a;l--)e[l]=e[l-1];e[l]=[n,o,a]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,r.t=function(e,o){if(1&o&&(e=this(e)),8&o)return e;if("object"==typeof e&&e){if(4&o&&e.__esModule)return e;if(16&o&&"function"==typeof e.then)return e}var a=Object.create(null);r.r(a);var c={};t=t||[null,n({}),n([]),n(n)];for(var s=2&o&&e;"object"==typeof s&&!~t.indexOf(s);s=n(s))Object.getOwnPropertyNames(s).forEach((t=>c[t]=()=>e[t]));return c.default=()=>e,r.d(a,c),a},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.e=()=>Promise.resolve(),r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),r.j=4676,(()=>{var e={4676:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var o,a,[c,s,i]=n,l=0;for(o in s)r.o(s,o)&&(r.m[o]=s[o]);if(i)var d=i(r);for(t&&t(n);l<c.length;l++)a=c[l],r.o(e,a)&&e[a]&&e[a][0](),e[c[l]]=0;return r.O(d)},n=self.webpackChunk=self.webpackChunk||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var c=r.O(void 0,[5514,3044,8592],(()=>r(842)));c=r.O(c)})();
//# sourceMappingURL=module_categories.management.3972e18c.bundle.js.map