(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0cb51142"],{1148:function(t,e,i){"use strict";var r=i("a691"),a=i("1d80");t.exports="".repeat||function(t){var e=String(a(this)),i="",s=r(t);if(s<0||s==1/0)throw RangeError("Wrong number of repetitions");for(;s>0;(s>>>=1)&&(e+=e))1&s&&(i+=e);return i}},"1bef":function(t,e,i){"use strict";i.r(e);var r=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"cl-memory-detail"},[r("div",{staticClass:"memory-bk"},[r("div",{staticClass:"title-content"},[r("div",{staticClass:"title-text"},[t._v(" "+t._s(t.$t("profiling.memory.memoryDetailLink"))+" ")])]),r("div",{staticClass:"main-content"},[r("div",{staticClass:"top-content",class:t.tableFullScreen?"full-screen":""},[r("div",{staticClass:"title-item"},[t._v(" "+t._s(t.$t("profiling.memory.overView"))+" ")]),r("div",{staticClass:"content-item"},[r("div",{staticClass:"detail-item"},[r("div",{staticClass:"value-item"},[t._v(t._s(t.overViewData.currentCard))]),r("div",{staticClass:"label-item"},[t._v(t._s(t.$t("profiling.memory.currentCard")))])]),r("div",{staticClass:"detail-item"},[r("div",{staticClass:"value-item"},[t._v(t._s(t.overViewData.memoryAssign))]),r("div",{staticClass:"label-item"},[t._v(t._s(t.$t("profiling.memory.memoryAssign")))])]),r("div",{staticClass:"detail-item"},[r("div",{staticClass:"value-item"},[t._v(t._s(t.overViewData.memoryRelease))]),r("div",{staticClass:"label-item"},[t._v(t._s(t.$t("profiling.memory.memoryRelease")))])]),r("div",{staticClass:"detail-item"},[r("div",[r("span",{staticClass:"value-item"},[t._v(" "+t._s(t.formmateUnit(t.overViewData.totalMemory,1))+" ")]),r("span",{staticClass:"unit-item"},[t._v(" "+t._s(t.formmateUnit(t.overViewData.totalMemory,2))+" ")])]),r("div",{staticClass:"label-item"},[t._v(t._s(t.$t("profiling.memory.totalMemory")))])]),r("div",{staticClass:"detail-item"},[r("div",[r("span",{staticClass:"value-item"},[t._v(" "+t._s(t.formmateUnit(t.overViewData.staticMemory,1))+" ")]),r("span",{staticClass:"unit-item"},[t._v(" "+t._s(t.formmateUnit(t.overViewData.staticMemory,2))+" ")])]),r("div",{staticClass:"label-item"},[t._v(t._s(t.$t("profiling.memory.staticMenory")))])]),r("div",{staticClass:"detail-item"},[r("div",[r("span",{staticClass:"value-item"},[t._v(" "+t._s(t.formmateUnit(t.overViewData.memoryPeak,1))+" ")]),r("span",{staticClass:"unit-item"},[t._v(" "+t._s(t.formmateUnit(t.overViewData.memoryPeak,2))+" ")])]),r("div",{staticClass:"label-item"},[t._v(t._s(t.$t("profiling.memory.memoryPeak")))])])])]),r("div",{staticClass:"chart-container",class:t.tableFullScreen?"full-screen":""},[r("div",{staticClass:"title-item"},[t._v(" "+t._s(t.$t("profiling.memory.usedMemory"))+" ")]),r("div",{directives:[{name:"show",rawName:"v-show",value:!t.graphicsInitOver||t.noGraphicsDataFlag,expression:"!graphicsInitOver || noGraphicsDataFlag"}],staticClass:"chart-content"},[r("div",{staticClass:"noData-content"},[r("div",[r("img",{attrs:{src:i("9485")}})]),t.graphicsInitOver&&t.noGraphicsDataFlag?r("div",{staticClass:"noData-text"},[t._v(t._s(t.$t("public.noData")))]):r("div",{staticClass:"noData-text"},[t._v(t._s(t.$t("public.dataLoading")))])])]),r("div",{directives:[{name:"show",rawName:"v-show",value:!t.noGraphicsDataFlag&&t.graphicsInitOver,expression:"!noGraphicsDataFlag && graphicsInitOver"}],ref:"memoryChart",staticClass:"chart-content"})]),r("div",{staticClass:"table-container",class:t.tableFullScreen?"full-screen":""},[r("div",{staticClass:"title-item"},[r("span",[t._v(" "+t._s(t.$t("profiling.memory.operatorMemoryAssign"))+" ")]),r("img",{staticClass:"fullScreen-icon",attrs:{src:i("4da4"),title:t.$t("graph.fullScreen")},on:{click:t.toggleFullScreen}})]),r("div",{staticClass:"table-content"},[r("el-table",{attrs:{data:t.currentBreakdownsData,stripe:"",height:"100%","tooltip-effect":"light","empty-text":t.breakdownsInitOver?t.$t("public.noData"):t.$t("public.dataLoading")}},[r("el-table-column",{attrs:{prop:"name",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[r("div",{staticClass:"cell"},[t._v(t._s(e.row.name))])]}}])},[r("template",{slot:"header"},[r("span",{attrs:{title:t.$t("profiling.memory.tensorName")}},[t._v(" "+t._s(t.$t("profiling.memory.tensorName"))+" ")])])],2),r("el-table-column",{attrs:{prop:"size",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[r("div",{staticClass:"cell"},[t._v(t._s(t.formmateUnit(e.row.size)))])]}}])},[r("template",{slot:"header"},[r("span",{attrs:{title:t.$t("profiling.memory.totalTensorMemoryAssign")}},[t._v(" "+t._s(t.$t("profiling.memory.totalTensorMemoryAssign"))+" ")])])],2),r("el-table-column",{attrs:{prop:"type"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("div",{staticClass:"cell"},[t._v(t._s(e.row.type))])]}}])},[r("template",{slot:"header"},[r("span",{attrs:{title:t.$t("profiling.memory.tensorType")}},[t._v(" "+t._s(t.$t("profiling.memory.tensorType"))+" ")])])],2),r("el-table-column",{attrs:{prop:"dataType"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("div",{staticClass:"cell"},[t._v(t._s(e.row.dataType))])]}}])},[r("template",{slot:"header"},[r("span",{attrs:{title:t.$t("profiling.memory.dataType")}},[t._v(" "+t._s(t.$t("profiling.memory.dataType"))+" ")])])],2),r("el-table-column",{attrs:{prop:"shape"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("div",{staticClass:"cell"},[t._v(t._s(e.row.shape))])]}}])},[r("template",{slot:"header"},[r("span",{attrs:{title:t.$t("profiling.memory.shapes")}},[t._v(" "+t._s(t.$t("profiling.memory.shapes"))+" ")])])],2),r("el-table-column",{attrs:{prop:"format"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("div",{staticClass:"cell"},[t._v(t._s(e.row.format))])]}}])},[r("template",{slot:"header"},[r("span",{attrs:{title:t.$t("profiling.memory.format")}},[t._v(" "+t._s(t.$t("profiling.memory.format"))+" ")])])],2),r("el-table-column",{attrs:{prop:"lifeCycle"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("div",{staticClass:"cell"},[t._v(t._s(e.row.lifeCycle))])]}}])},[r("template",{slot:"header"},[r("span",{attrs:{title:t.$t("profiling.memory.lifeCycle")}},[t._v(" "+t._s(t.$t("profiling.memory.lifeCycle"))+" ")])])],2)],1)],1)])])])])},a=[],s=(i("b64b"),i("159b"),i("99af"),i("b0c0"),i("d3b7"),i("25f0"),i("b680"),i("a9e3"),i("9fac")),n=i("3778"),o={data:function(){return{summaryPath:"",curCardNum:null,overViewData:{currentCard:"-",memoryAssign:"-",memoryRelease:"-",staticMemory:"-",totalMemory:"-",memoryPeak:"-"},overViewInitOver:!1,graphicsInitOver:!1,noGraphicsDataFlag:!1,pageResizeTimer:null,currentGraphicsDic:[],currentBreakdownsData:[],graphicsChart:null,graphicsOption:null,graphicsId:"allocationLine",numberLimit:10,unitBase:1024,unitList:[this.$t("profiling.memory.memoryGiBUnit"),this.$t("profiling.memory.memoryMiBUnit"),this.$t("profiling.memory.memoryKiBUnit"),this.$t("profiling.memory.memoryByteUnit")],chartClickListenerOn:!1,curSelectedPointIndex:0,curGraphId:"",breakdownsInitOver:!1,firstInit:!0,tableFullScreen:!1}},watch:{"$parent.curDashboardInfo.curCardNum":{handler:function(t){isNaN(parseInt(t))||t===this.curCardNum||this.firstInit||(this.curCardNum=t,this.overViewInitOver=!1,this.noGraphicsDataFlag=!1,this.graphicsInitOver=!1,this.breakdownsInitOver=!1,this.overViewData={currentCard:"-",memoryAssign:"-",memoryRelease:"-",staticMemory:"-",totalMemory:"-",memoryPeak:"-"},this.curGraphId="",this.curSelectedPointIndex=0,this.currentBreakdownsData=[],this.init())},deep:!0,immediate:!0}},destroyed:function(){window.removeEventListener("resize",this.resizeCallback),this.pageResizeTimer&&(clearTimeout(this.pageResizeTimer),this.pageResizeTimer=null),this.$bus.$off("collapse"),this.chartClickListenerOn&&this.graphicsChart&&(this.chartClickListenerOn=!1,this.graphicsChart.off("click"))},methods:{init:function(){this.getMemorySummary()},resizeCallback:function(){var t=this;this.pageResizeTimer&&(clearTimeout(this.pageResizeTimer),this.pageResizeTimer=null),this.pageResizeTimer=setTimeout((function(){t.graphicsChart&&t.graphicsChart.resize()}),300)},getMemorySummary:function(){var t=this;if(!this.summaryPath||isNaN(this.curCardNum))return this.overViewInitOver=!0,this.noGraphicsDataFlag=!0,this.graphicsInitOver=!0,void(this.breakdownsInitOver=!0);var e={dir:this.summaryPath,device_id:this.curCardNum};n["a"].queryMemorySummary(e).then((function(i){if(t.overViewInitOver=!0,i&&i.data&&i.data.summary){var r=i.data.summary;t.overViewData={currentCard:e.device_id,memoryAssign:r.allocations||"-",memoryRelease:r.deallocations||"-",staticMemory:isNaN(r.static_mem)?"-":r.static_mem,totalMemory:isNaN(r.capacity)?"-":r.capacity,memoryPeak:isNaN(r.peak_mem)?"-":r.peak_mem}}else t.overViewData={currentCard:"-",memoryAssign:"-",memoryRelease:"-",staticMemory:"-",totalMemory:"-",memoryPeak:"-"}}),(function(){t.overViewInitOver=!0})).then((function(){t.getMemoryGraphics()}))},getMemoryGraphics:function(){var t=this,e={dir:this.summaryPath,device_id:this.curCardNum};n["a"].queryMemoryGraphics(e).then((function(e){if(t.graphicsInitOver=!0,!e||!e.data||!Object.keys(e.data).length)return t.noGraphicsDataFlag=!0,void(t.breakdownsInitOver=!0);t.noGraphicsDataFlag=!1;var i=e.data[Object.keys(e.data)[0]];t.curGraphId=i.graph_id,t.currentGraphicsDic=i,t.graphicsOption=t.formatGraphicsOption(),t.drawGraphics(),t.$nextTick((function(){t.formatBreakdowns()}))}),(function(){t.graphicsInitOver=!0,t.noGraphicsDataFlag=!0,t.breakdownsInitOver=!0}))},formatBreakdowns:function(){var t=this;if(this.breakdownsInitOver=!1,this.currentBreakdownsData=[],!this.currentGraphicsDic.nodes)return this.currentBreakdownsData=[],void(this.breakdownsInitOver=!0);var e=this.currentGraphicsDic.nodes[this.curSelectedPointIndex];if(!e)return this.currentBreakdownsData=[],void(this.breakdownsInitOver=!0);var i={dir:this.summaryPath,device_id:this.curCardNum,graph_id:this.curGraphId,node_id:e.node_id},r=this.curSelectedPointIndex;n["a"].queryMemoryBreakdowns(i).then((function(e){if(r===t.curSelectedPointIndex)if(t.breakdownsInitOver=!0,e&&e.data&&e.data.breakdowns){var i=e.data.breakdowns,a=[];i.forEach((function(t){a.push({name:t.tensor_name,size:t.size,type:t.type,dataType:t.data_type,shape:t.shape,format:t.format,lifeCycle:"[".concat(t.life_start,", ").concat(t.life_end,"]")})})),t.currentBreakdownsData=a}else t.currentBreakdownsData=[]}),(function(){t.breakdownsInitOver=!0}))},formatGraphicsOption:function(){var t=this;if(!this.currentGraphicsDic)return{};var e=this,i=[],r=[],a=[],s=[],n=-1,o=-1;this.currentGraphicsDic.nodes.forEach((function(e,c){e.node_id===t.currentGraphicsDic.fp_start?n=c:e.node_id===t.currentGraphicsDic.bp_end&&(o=c),i.push([e.node_id,t.currentGraphicsDic.lines[c]]),r.push([e.node_id,t.overViewData.totalMemory]),a.push([e.node_id,t.currentGraphicsDic.static_mem]);var l=[];e.outputs.forEach((function(t){l.push([t.life_start,t.life_end])})),s.push(l)}));var c={id:this.graphicsId,name:this.$t("profiling.memory.curMemorySize"),data:i,type:"line",showSymbol:!1,lineStyle:{color:"#00a5a7"},color:"#00a5a7",markLine:{lineStyle:{color:"#00a5a7"},label:{formatter:function(t){var i="";return i=t.dataIndex?"".concat(e.$t("profiling.memory.bpEnd")).concat(e.$t("symbols.colon")).concat(o):"".concat(e.$t("profiling.memory.fpStart")).concat(e.$t("symbols.colon")).concat(n),i}},symbol:["none","none"],data:[{xAxis:n},{xAxis:o}]},markPoint:{symbol:"emptyCircle",symbolSize:8,itemStyle:{color:"#f45c5e"},data:[{coord:i[this.curSelectedPointIndex]}]}},l={data:r,name:this.$t("profiling.memory.totalMemory"),type:"line",smooth:0,symbol:"none",lineStyle:{color:"#fdca5a"},color:"#fdca5a"},m={data:a,name:this.$t("profiling.memory.staticMenory"),type:"line",smooth:0,symbol:"none",lineStyle:{color:"#3d58a6"},color:"#3d58a6"},d=[c,m],u={};u[this.$t("profiling.memory.curMemorySize")]=!0,u[this.$t("profiling.memory.staticMenory")]=!0;var h=[this.$t("profiling.memory.curMemorySize"),this.$t("profiling.memory.staticMenory")];isNaN(this.overViewData.totalMemory)||(d.push(l),h.unshift(this.$t("profiling.memory.totalMemory")),u[this.$t("profiling.memory.totalMemory")]=!1);var p={legend:{show:!0,icon:"circle",data:h,selected:u},grid:{top:60,bottom:60},xAxis:{name:this.$t("profiling.memory.chartXaxisUnit"),type:"value",show:!0},yAxis:{name:this.$t("profiling.memory.chartYaxisUnit"),scale:!0,nameGap:24},tooltip:{trigger:"axis",axisPointer:{type:"line"},backgroundColor:"rgba(50, 50, 50, 0.7)",borderWidth:0,textStyle:{color:"#fff"},formatter:function(t){var i="";return t.forEach((function(t){if(t.seriesId===e.graphicsId){var r=t.dataIndex,a=e.currentGraphicsDic.nodes[r];a&&(i="<div>".concat(e.$t("profiling.memory.curOperaterId"))+"".concat(e.$t("symbols.colon")).concat(a.node_id,"</div>")+"<div>".concat(e.$t("profiling.memory.curOperator"))+"".concat(e.$t("symbols.colon")).concat(a.name,"</div>")+"<div>".concat(e.$t("profiling.memory.curOperatorMemorySize"))+"".concat(e.$t("symbols.colon")).concat(e.formmateNummber(a.size),"</div>")+"<div>".concat(e.$t("profiling.memory.curMemorySize"))+"".concat(e.$t("symbols.colon")).concat(e.formmateNummber(e.currentGraphicsDic.lines[r]),"</div>")+"<div>".concat(e.$t("profiling.memory.memoryChanged"))+"".concat(e.$t("symbols.colon")).concat(e.formmateNummber(a.allocated),"</div>"))}})),i}},dataZoom:[{type:"inside",filterMode:"empty",orient:"horizontal",xAxisIndex:0},{type:"slider",filterMode:"empty",orient:"horizontal",xAxisIndex:0,bottom:10}],series:d};return p},drawGraphics:function(){var t=this;this.graphicsOption&&this.$nextTick((function(){t.graphicsChart||(t.graphicsChart=s["a"].init(t.$refs.memoryChart,null)),t.graphicsChart.setOption(t.graphicsOption),t.chartClickListenerOn||(t.chartClickListenerOn=!0,t.graphicsChart.on("click",{seriesName:t.$t("profiling.memory.curMemorySize")},(function(e){t.pointChanged(e)}))),t.graphicsChart.resize()}))},pointChanged:function(t){if(t){var e=0;if("markLine"===t.componentType)e=t.value;else{if("series"!==t.componentType)return;e=t.dataIndex}var i=this.graphicsOption.series[0];i&&(i.markPoint.data[0].coord=i.data[e],this.drawGraphics(),this.curSelectedPointIndex=e,this.formatBreakdowns())}},formmateNummber:function(t){var e=10,i=1;return!isNaN(t)&&t.toString().length>this.numberLimit?t>i&&t<e?t.toFixed(4):t.toExponential(4):t},formmateUnit:function(t,e){var i="-";if(t===i)return i;for(var r=this.unitList.length-1,a=2,s=t,n=r,o="",c=0;c<r;c++){if(s>=1){n=c;break}s*=this.unitBase}return o=1===e?"".concat(Number(s.toFixed(a))):2===e?"".concat(this.unitList[n]):"".concat(Number(s.toFixed(a))," ").concat(this.unitList[n]),o},toggleFullScreen:function(){var t=this;this.tableFullScreen=!this.tableFullScreen,this.tableFullScreen||this.$nextTick((function(){t.resizeCallback()}))}},mounted:function(){this.train_id?document.title="".concat(decodeURIComponent(this.train_id),"-").concat(this.$t("profiling.memory.memoryDetailLink"),"-MindInsight"):document.title="".concat(this.$t("profiling.memory.memoryDetailLink"),"-MindInsight"),window.addEventListener("resize",this.resizeCallback,!1),this.$bus.$on("collapse",this.resizeCallback),this.$route.query&&this.$route.query.path&&!isNaN(this.$route.query.cardNum)&&(this.summaryPath=this.$route.query.path,this.curCardNum=this.$route.query.cardNum,this.init()),this.firstInit=!1}},c=o,l=(i("8c58"),i("2877")),m=Object(l["a"])(c,r,a,!1,null,null,null);e["default"]=m.exports},"408a":function(t,e,i){var r=i("c6b6");t.exports=function(t){if("number"!=typeof t&&"Number"!=r(t))throw TypeError("Incorrect invocation");return+t}},"4da4":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAAXNSR0IArs4c6QAAARdJREFUKBW1UTFqAlEQnflZ1xCEFAHB3lR7hECC5xBsUltELPZ3dmsheodAzhEIeAQr7QXFQlhEV91x3scRL5CB3T//vTezs2+420uFNJh4+RDL+2Q4XOBu8ZWmzXPBf0LSAOaMECnzE/PW7nYCA2d3h84kMifmVzrIr/f+xciQKxY41UDrMAY9ujcVzfRJdgV3rOCaJ4FTDbSRzazdPiCocPxjBciPVNBTLN9Zlm0UXxv3fydba/ygjTQaDVbA+/1B/ShF+24kiuAzrMvhBkmCmTUmeEFcSjnOD/TZ9b4ViTxHWArBZ9iqTqEbxAjkEGua0L6cntnVXNggxNhFlVtXN0JByBWzPUF72zRrNT4ZlHcvYOAMugDhu439cG89uAAAAABJRU5ErkJggg=="},5635:function(t,e,i){},"8c58":function(t,e,i){"use strict";i("5635")},9485:function(t,e,i){t.exports=i.p+"static/img/nodata.8290bed9.png"},b0c0:function(t,e,i){var r=i("83ab"),a=i("9bf2").f,s=Function.prototype,n=s.toString,o=/^\s*function ([^ (]*)/,c="name";r&&!(c in s)&&a(s,c,{configurable:!0,get:function(){try{return n.call(this).match(o)[1]}catch(t){return""}}})},b64b:function(t,e,i){var r=i("23e7"),a=i("7b0b"),s=i("df75"),n=i("d039"),o=n((function(){s(1)}));r({target:"Object",stat:!0,forced:o},{keys:function(t){return s(a(t))}})},b680:function(t,e,i){"use strict";var r=i("23e7"),a=i("a691"),s=i("408a"),n=i("1148"),o=i("d039"),c=1..toFixed,l=Math.floor,m=function(t,e,i){return 0===e?i:e%2===1?m(t,e-1,i*t):m(t*t,e/2,i)},d=function(t){var e=0,i=t;while(i>=4096)e+=12,i/=4096;while(i>=2)e+=1,i/=2;return e},u=c&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!o((function(){c.call({})}));r({target:"Number",proto:!0,forced:u},{toFixed:function(t){var e,i,r,o,c=s(this),u=a(t),h=[0,0,0,0,0,0],p="",f="0",y=function(t,e){var i=-1,r=e;while(++i<6)r+=t*h[i],h[i]=r%1e7,r=l(r/1e7)},v=function(t){var e=6,i=0;while(--e>=0)i+=h[e],h[e]=l(i/t),i=i%t*1e7},g=function(){var t=6,e="";while(--t>=0)if(""!==e||0===t||0!==h[t]){var i=String(h[t]);e=""===e?i:e+n.call("0",7-i.length)+i}return e};if(u<0||u>20)throw RangeError("Incorrect fraction digits");if(c!=c)return"NaN";if(c<=-1e21||c>=1e21)return String(c);if(c<0&&(p="-",c=-c),c>1e-21)if(e=d(c*m(2,69,1))-69,i=e<0?c*m(2,-e,1):c/m(2,e,1),i*=4503599627370496,e=52-e,e>0){y(0,i),r=u;while(r>=7)y(1e7,0),r-=7;y(m(10,r,1),0),r=e-1;while(r>=23)v(1<<23),r-=23;v(1<<r),y(1,1),v(2),f=g()}else y(0,i),y(1<<-e,0),f=g()+n.call("0",u);return u>0?(o=f.length,f=p+(o<=u?"0."+n.call("0",u-o)+f:f.slice(0,o-u)+"."+f.slice(o-u))):f=p+f,f}})}}]);