(self.webpackChunk=self.webpackChunk||[]).push([["app_views_performance_transactionSummary_tagExplorer_tsx"],{"./app/utils/performance/segmentExplorer/segmentExplorerQuery.tsx":function(e,r,t){"use strict";t("../node_modules/core-js/modules/es.object.keys.js"),t("../node_modules/core-js/modules/es.symbol.js"),t("../node_modules/core-js/modules/es.array.filter.js"),t("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),t("../node_modules/core-js/modules/web.dom-collections.for-each.js"),t("../node_modules/core-js/modules/es.object.get-own-property-descriptors.js");var n=t("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=(t("../node_modules/core-js/modules/es.array.sort.js"),t("../node_modules/react/index.js"),t("./app/utils/discover/genericDiscoverQuery.tsx")),a=t("./app/utils/withApi.tsx"),s=t("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function i(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function l(e,r){return e.aggregateColumn!==r.aggregateColumn||e.sort!==r.sort||e.allTagKeys!==r.allTagKeys||e.tagKey!==r.tagKey}function u(e){return(0,s.tZ)(o.Z,function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?i(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}({route:"events-facets-performance",getRequestPayload:(r=e,t=r.aggregateColumn,function(e){var n=e.eventView.getEventsAPIPayload(e.location);return n.aggregateColumn=t,n.sort=r.sort?r.sort:n.sort,r.allTagKeys&&(n.allTagKeys=r.allTagKeys),r.tagKey&&(n.tagKey=r.tagKey),n}),shouldRefetchData:l},e));var r,t}u.displayName="SegmentExplorerQuery",r.Z=(0,a.Z)(u)},"./app/views/performance/transactionSummary/tagExplorer.tsx":function(e,r,t){"use strict";t.d(r,{e2:function(){return F},xS:function(){return H},D_:function(){return $}}),t("../node_modules/core-js/modules/es.object.keys.js"),t("../node_modules/core-js/modules/es.symbol.js"),t("../node_modules/core-js/modules/es.array.filter.js"),t("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),t("../node_modules/core-js/modules/web.dom-collections.for-each.js"),t("../node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),t("../node_modules/core-js/modules/es.reflect.construct.js");var n,o=t("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),a=t("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),s=t("../node_modules/@babel/runtime/helpers/esm/createClass.js"),i=t("../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),l=t("../node_modules/@babel/runtime/helpers/esm/inherits.js"),u=t("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),c=t("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),d=t("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),m=t("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),p=(t("../node_modules/core-js/modules/es.array.map.js"),t("../node_modules/core-js/modules/es.array.find.js"),t("../node_modules/core-js/modules/es.function.name.js"),t("../node_modules/core-js/modules/es.array.concat.js"),t("../node_modules/core-js/modules/es.number.constructor.js"),t("../node_modules/core-js/modules/es.string.trim.js"),t("../node_modules/core-js/modules/es.array.sort.js"),t("../node_modules/react/index.js")),g=t("../node_modules/react-router/es/index.js"),y=t("./app/components/acl/feature.tsx"),f=t("./app/components/assistant/guideAnchor.tsx"),v=t("./app/components/button.tsx"),h=t("./app/components/charts/styles.tsx"),j=t("./app/components/featureBadge.tsx"),b=t("./app/components/gridEditable/index.tsx"),Z=t("./app/components/gridEditable/sortLink.tsx"),_=t("./app/components/links/link.tsx"),w=t("./app/components/pagination/index.tsx"),k=t("./app/locale.tsx"),x=t("./app/styles/space.tsx"),C=t("./app/utils/analytics.tsx"),O=t("./app/utils/discover/eventView.tsx"),S=t("./app/utils/discover/fields.tsx"),P=t("./app/utils/formatters.tsx"),T=t("./app/utils/performance/segmentExplorer/segmentExplorerQuery.tsx"),q=t("./app/utils/queryString.tsx"),z=t("./app/utils/tokenizeSearch.tsx"),E=t("./app/views/eventsV2/table/cellAction.tsx"),D=t("./app/views/performance/utils.tsx"),V=t("./app/views/performance/transactionSummary/transactionTags/utils.tsx"),K=t("./app/views/performance/transactionSummary/filter.tsx"),N=t("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function A(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function R(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?A(Object(t),!0).forEach((function(r){(0,d.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):A(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var B="tags_cursor",I=[{key:"key",field:"key",name:"Tag Key",width:-1,column:{kind:"field"}},{key:"tagValue",field:"tagValue",name:"Tag Values",width:-1,column:{kind:"field"}},{key:"aggregate",field:"aggregate",name:"Avg Duration",width:-1,column:{kind:"field"},canSort:!0},{key:"frequency",field:"frequency",name:"Frequency",width:-1,column:{kind:"field"},canSort:!0},{key:"comparison",field:"comparison",name:"Compared To Avg",width:-1,column:{kind:"field"},canSort:!0},{key:"sumdelta",field:"sumdelta",name:"Total Time Lost",width:-1,column:{kind:"field"},canSort:!0}],L=(n={},(0,d.Z)(n,K.f1.Browser,"spans.browser"),(0,d.Z)(n,K.f1.Http,"spans.http"),(0,d.Z)(n,K.f1.Db,"spans.db"),(0,d.Z)(n,K.f1.Resource,"spans.resource"),n),F=function(e,r,t){return L[e]||((0,D.C$)(r,t)===D.iy.FRONTEND?"measurements.lcp":"transaction.duration")};function H(e){return(0,N.tZ)("div",{className:"truncate",children:e.row.tags_value})}H.displayName="TagValue";var X=function(e){(0,l.Z)(m,e);var r,t,n=(r=m,t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,c.Z)(r);if(t){var o=(0,c.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,u.Z)(this,e)});function m(){var e;(0,a.Z)(this,m);for(var r=arguments.length,t=new Array(r),s=0;s<r;s++)t[s]=arguments[s];return e=n.call.apply(n,[this].concat(t)),(0,d.Z)((0,i.Z)(e),"state",{widths:[]}),(0,d.Z)((0,i.Z)(e),"handleResizeColumn",(function(r,t){var n=(0,o.Z)(e.state.widths);n[r]=t.width?Number(t.width):b.z7,e.setState({widths:n})})),(0,d.Z)((0,i.Z)(e),"getColumnOrder",(function(r){var t=e.state.widths;return r.map((function(e,r){return"number"==typeof t[r]?R(R({},e),{},{width:t[r]}):e}))})),(0,d.Z)((0,i.Z)(e),"renderHeadCellWithMeta",(function(r,t,n){return function(o,a){return e.renderHeadCell(r,t,o,n[a])}})),(0,d.Z)((0,i.Z)(e),"handleTagValueClick",(function(r,t,n){var o=e.props.organization;(0,C.ec)({eventKey:"performance_views.summary.tag_explorer.tag_value",eventName:"Performance Views: Tag Explorer Value Clicked",organization_id:parseInt(o.id,10)});var a=(0,q.ro)(r.query.query),s=(0,z.aI)(a||"");s.addTagValues(t,[n]);var i=s.formatString();g.browserHistory.push({pathname:r.pathname,query:R(R({},r.query),{},{query:String(i).trim()})})})),(0,d.Z)((0,i.Z)(e),"handleCellAction",(function(r,t,n){return function(o){var a,s=e.props,i=s.eventView,l=s.location,u=s.organization;(0,C.ec)({eventKey:"performance_views.summary.tag_explorer.cell_action",eventName:"Performance Views: Tag Explorer Cell Action Clicked",organization_id:parseInt(u.id,10)});var c=(0,z.aI)(i.query);c.removeTag("event.type"),(0,E.rh)(c,o,R(R({},r),{},{name:n.id}),t),g.browserHistory.push({pathname:l.pathname,query:R(R({},l.query),{},(a={},(0,d.Z)(a,B,void 0),(0,d.Z)(a,"query",c.formatString()),a))})}})),(0,d.Z)((0,i.Z)(e),"renderBodyCell",(function(r,t,n){var o=n[t.key],a=r.location,s=r.organization,i=r.transactionName;if("key"===t.key){var l=(0,V.vG)({orgSlug:s.slug,transaction:i,projectID:(0,q.ro)(a.query.project),query:R(R({},a.query),{},{tagKey:n.tags_key})});return(0,N.tZ)(y.Z,{features:["performance-tag-page"],organization:s,children:function(r){return r.hasFeature?(0,N.tZ)(_.Z,{to:l,onClick:function(){return e.onTagKeyClick()},children:n.tags_key}):n.tags_key}})}var u=[E.eX.ADD,E.eX.EXCLUDE];if("tagValue"===t.key){var c=R(R({},n),{},{id:n.tags_key});return(0,N.tZ)(E.ZP,{column:t,dataRow:c,handleCellAction:e.handleCellAction(t,n.tags_value,c),allowActions:u,children:(0,N.tZ)(y.Z,{features:["performance-tag-page"],organization:s,children:function(r){return r.hasFeature?(0,N.tZ)("div",{className:"truncate",children:n.tags_value}):(0,N.tZ)(_.Z,{to:"",onClick:function(){return e.handleTagValueClick(a,n.tags_key,n.tags_value)},children:(0,N.tZ)(H,{row:n})})}})})}if("frequency"===t.key)return(0,N.tZ)(W,{children:(0,P.rl)(n.frequency,0)});if("comparison"===t.key){var d=n.comparison,m=(0,P.rl)(d-1,0);return(0,N.tZ)(W,{children:d>1?(0,k.t)("+%s slower",m):(0,k.t)("%s faster",m)})}return"aggregate"===t.key?(0,N.tZ)(W,{children:(0,N.tZ)(D.Xr,{abbreviation:!0,milliseconds:n.aggregate})}):"sumdelta"===t.key?(0,N.tZ)(W,{children:(0,N.tZ)(D.Xr,{abbreviation:!0,milliseconds:n.sumdelta})}):o})),(0,d.Z)((0,i.Z)(e),"renderBodyCellWithData",(function(r){return function(t,n){return e.renderBodyCell(r,t,n)}})),e}return(0,s.Z)(m,[{key:"onSortClick",value:function(e,r){var t=this.props.organization;(0,C.ec)({eventKey:"performance_views.summary.tag_explorer.sort",eventName:"Performance Views: Tag Explorer Sorted",organization_id:parseInt(t.id,10),field:r,direction:e})}},{key:"renderHeadCell",value:function(e,r,t,n){var o=this,a=this.props.location,s=(0,S.qG)(t.key,t.type,r),i={field:t.key,width:t.width},l=e.sortForField(i,r),u=(0,O.M3)(i,r),c=l?l.kind:void 0,m=l?l.field:void 0;return(0,N.tZ)(Z.Z,{align:s,title:n.name,direction:c,canSort:u,generateSortLink:function(){var t;if(r){var n=e.sortOnField(i,r).generateQueryStringObject().sort;return R(R({},a),{},{query:R(R({},a.query),{},(t={},(0,d.Z)(t,B,void 0),(0,d.Z)(t,"tagSort",n),t))})}},onClick:function(){return o.onSortClick(c,m)}})}},{key:"onTagKeyClick",value:function(){var e=this.props.organization;(0,C.ec)({eventKey:"performance_views.summary.tag_explorer.visit_tag_key",eventName:"Performance Views: Tag Explorer - Visit Tag Key",organization_id:parseInt(e.id,10)})}},{key:"render",value:function(){var e,r,t=this,n=this.props,o=n.eventView,a=n.organization,s=n.location,i=n.currentFilter,l=n.projects,u=n.transactionName,c=(0,q.ro)(null===(e=s.query)||void 0===e?void 0:e.tagSort),d=(0,q.ro)(null===(r=s.query)||void 0===r?void 0:r.tags_cursor),m=o.clone();m.fields=I;var g=(0,O.vp)(c),y=m.withSorts(g.length?g:[{field:"sumdelta",kind:"desc"}]),v=F(i,l,y),h=function(e,r,t){var n=I.map((function(e){return R({},e)})),o=n.find((function(e){return"aggregate"===e.key}));return o?L[e]?(o.name="Avg Span Duration",n):(0,D.C$)(r,t)===D.iy.FRONTEND?(o.name="Avg LCP",n):n:n}(i,l,y),j=this.getColumnOrder(h),Z=y.getSorts();return(0,N.tZ)(T.Z,{eventView:y,orgSlug:a.slug,location:s,aggregateColumn:v,limit:5,cursor:d,children:function(e){var r=e.isLoading,n=e.tableData,o=e.pageLinks;return(0,N.BX)(p.Fragment,{children:[(0,N.tZ)(f.n,{target:"tag_explorer",children:(0,N.tZ)(Q,{transactionName:u,location:s,organization:a,pageLinks:o})}),(0,N.tZ)(b.ZP,{isLoading:r,data:n&&n.data?n.data:[],columnOrder:j,columnSortBy:Z,grid:{renderHeadCell:t.renderHeadCellWithMeta(y,(null==n?void 0:n.meta)||{},h),renderBodyCell:t.renderBodyCellWithData(t.props),onResizeColumn:t.handleResizeColumn},location:s})]})}})}}]),m}(p.Component);function Q(e){var r=e.pageLinks,t=e.organization,n=e.location,o=e.transactionName,a=(0,V.vG)({orgSlug:t.slug,transaction:o,projectID:(0,q.ro)(n.query.project),query:R({},n.query)});return(0,N.BX)(G,{children:[(0,N.BX)("div",{children:[(0,N.tZ)(h.OT,{children:(0,k.t)("Suspect Tags")}),(0,N.tZ)(j.Z,{type:"beta"})]}),(0,N.tZ)(y.Z,{features:["performance-tag-page"],organization:t,children:(0,N.tZ)(v.ZP,{onClick:function(){(0,C.ec)({eventKey:"performance_views.summary.tag_explorer.change_page",eventName:"Performance Views: Tag Explorer Change Page",organization_id:parseInt(t.id,10)})},to:a,size:"small","data-test-id":"tags-explorer-open-tags",children:(0,k.t)("View All Tags")})}),(0,N.tZ)(M,{pageLinks:r,onCursor:function(e,r,n){(0,C.ec)({eventKey:"performance_views.summary.tag_explorer.change_page",eventName:"Performance Views: Tag Explorer Change Page",organization_id:parseInt(t.id,10)}),g.browserHistory.push({pathname:r,query:R(R({},n),{},(0,d.Z)({},B,e))})},size:"small"})]})}X.displayName="_TagExplorer",Q.displayName="TagsHeader";var W=(0,m.Z)("div",{target:"euaybo32"})({name:"2qga7i",styles:"text-align:right"}),G=(0,m.Z)("div",{target:"euaybo31"})("display:grid;grid-template-columns:1fr auto auto;margin-bottom:",(0,x.Z)(1),";"),M=(0,m.Z)(w.Z,{target:"euaybo30"})("margin:0 0 0 ",(0,x.Z)(1),";"),$=X}}]);
//# sourceMappingURL=../sourcemaps/app_views_performance_transactionSummary_tagExplorer_tsx.89dc59866c9007087c8ce1d6aad2a475.js.map