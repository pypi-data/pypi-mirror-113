{"version":3,"sources":["webpack:///./app/components/links/linkWithConfirmation.tsx","webpack:///./app/components/resultGrid.tsx","webpack:///./app/views/admin/adminRelays.tsx"],"names":["LinkWithConfirmation","this","props","className","disabled","title","children","otherProps","href","classNames","React","Filter","getCurrentLabel","getDefaultItem","options","map","value","label","filterQuery","queryKey","query","location","isActive","to","pathname","path","selected","find","item","name","cursor","length","getSelector","SortBy","getCurrentSortLabel","sortBy","getSortBySelector","ResultGrid","defaultState","e","state","targetQueryParams","preventDefault","browserHistory","evt","setState","target","fetchData","queryParams","defaultSort","filters","pageLinks","loading","error","rows","defaultParams","api","request","endpoint","method","data","success","_","jqXHR","getResponseHeader","colSpan","columns","row","columnsForRow","keyForRow","hasSearch","onSubmit","onSearch","type","placeholder","style","width","autoComplete","onChange","onQueryChange","size","sortOptions","Object","keys","filterKey","renderLoading","renderError","renderNoResults","renderResults","hasPagination","id","per_page","withApi","prettyDate","x","moment","format","AdminRelays","key","relayId","publicKey","textAlign","firstSeen","lastSeen","message","t","onConfirm","onDelete","getRow","Component"],"mappings":"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","file":"chunks/app_views_admin_adminRelays_tsx.xxxxxxxxxxxxxxxxxxxx.js","sourcesContent":["import * as React from 'react';\nimport classNames from 'classnames';\n\nimport Button from 'app/components/button';\nimport Confirm from 'app/components/confirm';\n\ntype Props = {\n  message: React.ReactNode;\n  title: string;\n  onConfirm: () => void;\n  disabled?: boolean;\n  className?: string;\n  priority?: React.ComponentProps<typeof Button>['priority'];\n};\n\n/**\n * <Confirm> is a more generic version of this component\n */\nclass LinkWithConfirmation extends React.PureComponent<Props> {\n  render() {\n    const {className, disabled, title, children, ...otherProps} = this.props;\n    return (\n      <Confirm {...otherProps} disabled={disabled}>\n        <a href=\"#\" className={classNames(className || '', {disabled})} title={title}>\n          {children}\n        </a>\n      </Confirm>\n    );\n  }\n}\n\nexport default LinkWithConfirmation;\n","import * as React from 'react';\nimport {browserHistory} from 'react-router';\nimport {Location} from 'history';\n\nimport {Client, RequestOptions} from 'app/api';\nimport DropdownLink from 'app/components/dropdownLink';\nimport MenuItem from 'app/components/menuItem';\nimport Pagination from 'app/components/pagination';\nimport {IconSearch} from 'app/icons';\nimport withApi from 'app/utils/withApi';\n\ntype Option = [value: string, label: string];\n\ntype FilterProps = {\n  name: string;\n  queryKey: string;\n  options: Option[];\n  path: string;\n  value: string;\n  location: Location;\n};\n\nclass Filter extends React.Component<FilterProps> {\n  getCurrentLabel() {\n    const selected = this.props.options.find(\n      item => item[0] === (this.props.value ?? '')\n    );\n    if (selected) {\n      return this.props.name + ': ' + selected[1];\n    }\n    return this.props.name + ': ' + 'Any';\n  }\n\n  getDefaultItem() {\n    const query = {...this.props.location.query, cursor: ''};\n    delete query[this.props.queryKey];\n\n    return (\n      <MenuItem\n        key=\"\"\n        isActive={this.props.value === '' || !this.props.value}\n        to={{pathname: this.props.path, query}}\n      >\n        Any\n      </MenuItem>\n    );\n  }\n\n  getSelector = () => (\n    <DropdownLink title={this.getCurrentLabel()}>\n      {this.getDefaultItem()}\n      {this.props.options.map(([value, label]) => {\n        const filterQuery = {\n          [this.props.queryKey]: value,\n          cursor: '',\n        };\n\n        const query = {...this.props.location.query, ...filterQuery};\n        return (\n          <MenuItem\n            key={value}\n            isActive={this.props.value === value}\n            to={{pathname: this.props.path, query}}\n          >\n            {label}\n          </MenuItem>\n        );\n      })}\n    </DropdownLink>\n  );\n\n  render() {\n    return (\n      <div className=\"filter-options\">\n        {this.props.options.length === 1 ? (\n          <strong>{this.getCurrentLabel()}</strong>\n        ) : (\n          this.getSelector()\n        )}\n      </div>\n    );\n  }\n}\n\ntype SortByProps = {\n  options: Option[];\n  path: string;\n  location: Location;\n  value: string;\n};\n\nclass SortBy extends React.Component<SortByProps> {\n  getCurrentSortLabel() {\n    return this.props.options.find(([value]) => value === this.props.value)?.[1];\n  }\n\n  getSortBySelector() {\n    return (\n      <DropdownLink title={this.getCurrentSortLabel()} className=\"sorted-by\">\n        {this.props.options.map(([value, label]) => {\n          const query = {...this.props.location.query, sortBy: value, cursor: ''};\n          return (\n            <MenuItem\n              isActive={this.props.value === value}\n              key={value}\n              to={{pathname: this.props.path, query}}\n            >\n              {label}\n            </MenuItem>\n          );\n        })}\n      </DropdownLink>\n    );\n  }\n\n  render() {\n    if (this.props.options.length === 0) {\n      return null;\n    }\n\n    return (\n      <div className=\"sort-options\">\n        Showing results sorted by\n        {this.props.options.length === 1 ? (\n          <strong className=\"sorted-by\">{this.getCurrentSortLabel()}</strong>\n        ) : (\n          this.getSortBySelector()\n        )}\n      </div>\n    );\n  }\n}\n\ntype FilterConfig = {\n  name: string;\n  options: Option[];\n};\n\n// XXX(ts): Using Partial here on the DefaultProps is not really correct, since\n// defaultProps guarantees they'll be set. But because this component is\n// wrapped with a HoC, we lose the defaultProps, and users of the component\ntype Props = {\n  api: Client;\n  location: Location;\n} & Partial<DefaultProps>;\n\ntype DefaultProps = {\n  columns: React.ReactNode[];\n  columnsForRow: (row: any) => React.ReactNode[];\n  defaultSort: string;\n  defaultParams: Record<string, any>;\n  filters: Record<string, FilterConfig>;\n  endpoint: string;\n  hasPagination: boolean;\n  hasSearch: boolean;\n  keyForRow: (row: any) => string;\n  method: RequestOptions['method'];\n  path: string;\n  sortOptions: Option[];\n};\n\ntype State = {\n  rows: any[];\n  loading: boolean;\n  error: string | boolean;\n  pageLinks: null | string;\n  query: string;\n  sortBy: string;\n  filters: Record<string, string>;\n};\n\nclass ResultGrid extends React.Component<Props, State> {\n  static defaultProps: DefaultProps = {\n    path: '',\n    endpoint: '',\n    method: 'GET',\n    columns: [],\n    sortOptions: [],\n    filters: {},\n    defaultSort: '',\n    keyForRow: row => row.id,\n    columnsForRow: () => [],\n    defaultParams: {\n      per_page: 50,\n    },\n    hasPagination: true,\n    hasSearch: false,\n  };\n\n  state: State = this.defaultState;\n\n  componentWillMount() {\n    this.fetchData();\n  }\n\n  componentWillReceiveProps() {\n    const queryParams = this.query;\n    this.setState(\n      {\n        query: queryParams.query ?? '',\n        sortBy: queryParams.sortBy ?? this.props.defaultSort,\n        filters: {...queryParams},\n        pageLinks: null,\n        loading: true,\n        error: false,\n      },\n      this.fetchData\n    );\n  }\n\n  get defaultState() {\n    const queryParams = this.query;\n\n    return {\n      rows: [],\n      loading: true,\n      error: false,\n      pageLinks: null,\n      query: queryParams.query ?? '',\n      sortBy: queryParams.sortBy ?? this.props.defaultSort,\n      filters: {...queryParams},\n    } as State;\n  }\n\n  get query() {\n    return ((this.props.location ?? {}).query ?? {}) as {[k: string]: string};\n  }\n\n  remountComponent() {\n    this.setState(this.defaultState, this.fetchData);\n  }\n\n  refresh() {\n    this.setState({loading: true}, this.fetchData);\n  }\n\n  fetchData() {\n    // TODO(dcramer): this should explicitly allow filters/sortBy/cursor/perPage\n    const queryParams = {\n      ...this.props.defaultParams,\n      sortBy: this.state.sortBy,\n      ...this.query,\n    };\n\n    this.props.api.request(this.props.endpoint!, {\n      method: this.props.method,\n      data: queryParams,\n      success: (data, _, jqXHR) => {\n        this.setState({\n          loading: false,\n          error: false,\n          rows: data,\n          pageLinks: jqXHR?.getResponseHeader('Link') ?? null,\n        });\n      },\n      error: () => {\n        this.setState({\n          loading: false,\n          error: true,\n        });\n      },\n    });\n  }\n\n  onSearch = (e: React.FormEvent<HTMLFormElement>) => {\n    const location = this.props.location ?? {};\n    const {query} = this.state;\n    const targetQueryParams = {...(location.query ?? {}), query, cursor: ''};\n\n    e.preventDefault();\n\n    browserHistory.push({\n      pathname: this.props.path,\n      query: targetQueryParams,\n    });\n  };\n\n  onQueryChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n    this.setState({query: evt.target.value});\n  };\n\n  renderLoading() {\n    return (\n      <tr>\n        <td colSpan={this.props.columns!.length}>\n          <div className=\"loading\">\n            <div className=\"loading-indicator\" />\n            <div className=\"loading-message\">Hold on to your butts!</div>\n          </div>\n        </td>\n      </tr>\n    );\n  }\n\n  renderError() {\n    return (\n      <tr>\n        <td colSpan={this.props.columns!.length}>\n          <div className=\"alert-block alert-error\">Something bad happened :(</div>\n        </td>\n      </tr>\n    );\n  }\n\n  renderNoResults() {\n    return (\n      <tr>\n        <td colSpan={this.props.columns!.length}>No results found.</td>\n      </tr>\n    );\n  }\n\n  renderResults() {\n    return this.state.rows.map(row => (\n      <tr key={this.props.keyForRow?.(row)}>{this.props.columnsForRow?.(row)}</tr>\n    ));\n  }\n\n  render() {\n    const {filters} = this.props;\n    return (\n      <div className=\"result-grid\">\n        <div className=\"table-options\">\n          {this.props.hasSearch && (\n            <div className=\"result-grid-search\">\n              <form onSubmit={this.onSearch}>\n                <div className=\"form-group\">\n                  <input\n                    type=\"text\"\n                    className=\"form-control input-search\"\n                    placeholder=\"search\"\n                    style={{width: 300}}\n                    name=\"query\"\n                    autoComplete=\"off\"\n                    value={this.state.query}\n                    onChange={this.onQueryChange}\n                  />\n                  <button type=\"submit\" className=\"btn btn-sm btn-primary\">\n                    <IconSearch size=\"xs\" />\n                  </button>\n                </div>\n              </form>\n            </div>\n          )}\n          <SortBy\n            options={this.props.sortOptions ?? []}\n            value={this.state.sortBy}\n            path={this.props.path ?? ''}\n            location={this.props.location}\n          />\n          {Object.keys(filters ?? {}).map(filterKey => (\n            <Filter\n              key={filterKey}\n              queryKey={filterKey}\n              value={this.state.filters[filterKey]}\n              path={this.props.path ?? ''}\n              location={this.props.location}\n              {...(filters?.[filterKey] as FilterConfig)}\n            />\n          ))}\n        </div>\n\n        <table className=\"table table-grid\">\n          <thead>\n            <tr>{this.props.columns}</tr>\n          </thead>\n          <tbody>\n            {this.state.loading\n              ? this.renderLoading()\n              : this.state.error\n              ? this.renderError()\n              : this.state.rows.length === 0\n              ? this.renderNoResults()\n              : this.renderResults()}\n          </tbody>\n        </table>\n        {this.props.hasPagination && this.state.pageLinks && (\n          <Pagination pageLinks={this.state.pageLinks} />\n        )}\n      </div>\n    );\n  }\n}\n\nexport {ResultGrid};\n\nexport default withApi(ResultGrid);\n","import {Component} from 'react';\nimport {RouteComponentProps} from 'react-router';\nimport moment from 'moment';\n\nimport {Client} from 'app/api';\nimport LinkWithConfirmation from 'app/components/links/linkWithConfirmation';\nimport ResultGrid from 'app/components/resultGrid';\nimport {t} from 'app/locale';\nimport withApi from 'app/utils/withApi';\n\nconst prettyDate = (x: string) => moment(x).format('ll LTS');\n\ntype Props = RouteComponentProps<{}, {}> & {api: Client};\n\ntype State = {\n  loading: boolean;\n};\n\ntype RelayRow = {\n  id: string;\n  relayId: string;\n  publicKey: string;\n  firstSeen: string;\n  lastSeen: string;\n};\n\nclass AdminRelays extends Component<Props, State> {\n  state: State = {\n    loading: false,\n  };\n\n  onDelete(key: string) {\n    this.setState({loading: true});\n    this.props.api.request(`/relays/${key}/`, {\n      method: 'DELETE',\n      success: () => this.setState({loading: false}),\n      error: () => this.setState({loading: false}),\n    });\n  }\n\n  getRow(row: RelayRow) {\n    return [\n      <td key=\"id\">\n        <strong>{row.relayId}</strong>\n      </td>,\n      <td key=\"key\">{row.publicKey}</td>,\n      <td key=\"firstSeen\" style={{textAlign: 'right'}}>\n        {prettyDate(row.firstSeen)}\n      </td>,\n      <td key=\"lastSeen\" style={{textAlign: 'right'}}>\n        {prettyDate(row.lastSeen)}\n      </td>,\n      <td key=\"tools\" style={{textAlign: 'right'}}>\n        <span className=\"editor-tools\">\n          <LinkWithConfirmation\n            className=\"danger\"\n            title=\"Remove\"\n            message={t('Are you sure you wish to delete this relay?')}\n            onConfirm={() => this.onDelete(row.id)}\n          >\n            {t('Remove')}\n          </LinkWithConfirmation>\n        </span>\n      </td>,\n    ];\n  }\n\n  render() {\n    const columns = [\n      <th key=\"id\" style={{width: 350, textAlign: 'left'}}>\n        Relay\n      </th>,\n      <th key=\"key\">Public Key</th>,\n      <th key=\"firstSeen\" style={{width: 150, textAlign: 'right'}}>\n        First seen\n      </th>,\n      <th key=\"lastSeen\" style={{width: 150, textAlign: 'right'}}>\n        Last seen\n      </th>,\n      <th key=\"tools\" />,\n    ];\n\n    return (\n      <div>\n        <h3>{t('Relays')}</h3>\n        <ResultGrid\n          path=\"/manage/relays/\"\n          endpoint=\"/relays/\"\n          method=\"GET\"\n          columns={columns}\n          columnsForRow={this.getRow}\n          hasSearch={false}\n          sortOptions={[\n            ['firstSeen', 'First seen'],\n            ['lastSeen', 'Last seen'],\n            ['relayId', 'Relay ID'],\n          ]}\n          defaultSort=\"firstSeen\"\n          {...this.props}\n        />\n      </div>\n    );\n  }\n}\n\nexport {AdminRelays};\n\nexport default withApi(AdminRelays);\n"],"sourceRoot":""}