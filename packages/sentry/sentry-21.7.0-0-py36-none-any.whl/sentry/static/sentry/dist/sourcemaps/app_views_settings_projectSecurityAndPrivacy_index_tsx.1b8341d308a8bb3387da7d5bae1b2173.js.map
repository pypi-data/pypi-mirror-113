{"version":3,"sources":["webpack:///./app/data/forms/projectSecurityAndPrivacyGroups.tsx","webpack:///./app/views/settings/projectSecurityAndPrivacy/index.tsx"],"names":["route","ORG_DISABLED_REASON","t","hasOrgOverride","organization","name","title","fields","type","label","help","tct","organizationSettingsLink","to","slug","visible","features","has","placeholder","value","organizationValue","formatStoreCrashReports","storeCrashReports","choices","getStoreCrashReportsValues","SettingScope","map","disabled","disabledReason","setValue","val","props","confirm","false","multiline","autosize","maxRows","rows","getValue","extractMultilineFields","convertMultilineFieldValue","ProjectSecurityAndPrivacy","data","ProjectActions","this","project","initialData","projectSlug","endpoint","access","Set","relayPiiConfig","Fragment","saveOnBlur","allowUndo","apiMethod","apiEndpoint","onSubmitSuccess","handleUpdateProject","onSubmitError","addErrorMessage","additionalFieldProps","forms","projectSecurityAndPrivacyGroups","additionalContext","linkToOrganizationSecurityAndPrivacy","projectId","id","Component"],"mappings":"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","file":"chunks/app_views_settings_projectSecurityAndPrivacy_index_tsx.xxxxxxxxxxxxxxxxxxxx.js","sourcesContent":["import Link from 'app/components/links/link';\nimport {t, tct} from 'app/locale';\nimport {convertMultilineFieldValue, extractMultilineFields} from 'app/utils';\nimport {\n  formatStoreCrashReports,\n  getStoreCrashReportsValues,\n  SettingScope,\n} from 'app/utils/crashReports';\nimport {JsonFormObject} from 'app/views/settings/components/forms/type';\n\n// Export route to make these forms searchable by label/help\nexport const route = '/settings/:orgId/projects/:projectId/security-and-privacy/';\n\nconst ORG_DISABLED_REASON = t(\n  \"This option is enforced by your organization's settings and cannot be customized per-project.\"\n);\n\n// Check if a field has been set AND IS TRUTHY at the organization level.\nconst hasOrgOverride = ({organization, name}) => organization[name];\n\nexport default [\n  {\n    title: t('Security & Privacy'),\n    fields: [\n      {\n        name: 'storeCrashReports',\n        type: 'select',\n        label: t('Store Native Crash Reports'),\n        help: ({organization}) =>\n          tct(\n            'Store native crash reports such as Minidumps for improved processing and download in issue details. Overrides [organizationSettingsLink: organization settings].',\n            {\n              organizationSettingsLink: (\n                <Link to={`/settings/${organization.slug}/security-and-privacy/`} />\n              ),\n            }\n          ),\n        visible: ({features}) => features.has('event-attachments'),\n        placeholder: ({organization, value}) => {\n          // empty value means that this project should inherit organization settings\n          if (value === '') {\n            return tct('Inherit organization settings ([organizationValue])', {\n              organizationValue: formatStoreCrashReports(organization.storeCrashReports),\n            });\n          }\n\n          // HACK: some organization can have limit of stored crash reports a number that's not in the options (legacy reasons),\n          // we therefore display it in a placeholder\n          return formatStoreCrashReports(value);\n        },\n        choices: ({organization}) =>\n          getStoreCrashReportsValues(SettingScope.Project).map(value => [\n            value,\n            formatStoreCrashReports(value, organization.storeCrashReports),\n          ]),\n      },\n    ],\n  },\n  {\n    title: t('Data Scrubbing'),\n    fields: [\n      {\n        name: 'dataScrubber',\n        type: 'boolean',\n        label: t('Data Scrubber'),\n        disabled: hasOrgOverride,\n        disabledReason: ORG_DISABLED_REASON,\n        help: t('Enable server-side data scrubbing'),\n        // `props` are the props given to FormField\n        setValue: (val, props) =>\n          (props.organization && props.organization[props.name]) || val,\n        confirm: {\n          false: t('Are you sure you want to disable server-side data scrubbing?'),\n        },\n      },\n      {\n        name: 'dataScrubberDefaults',\n        type: 'boolean',\n        disabled: hasOrgOverride,\n        disabledReason: ORG_DISABLED_REASON,\n        label: t('Use Default Scrubbers'),\n        help: t(\n          'Apply default scrubbers to prevent things like passwords and credit cards from being stored'\n        ),\n        // `props` are the props given to FormField\n        setValue: (val, props) =>\n          (props.organization && props.organization[props.name]) || val,\n        confirm: {\n          false: t('Are you sure you want to disable using default scrubbers?'),\n        },\n      },\n      {\n        name: 'scrubIPAddresses',\n        type: 'boolean',\n        disabled: hasOrgOverride,\n        disabledReason: ORG_DISABLED_REASON,\n        // `props` are the props given to FormField\n        setValue: (val, props) =>\n          (props.organization && props.organization[props.name]) || val,\n        label: t('Prevent Storing of IP Addresses'),\n        help: t('Preventing IP addresses from being stored for new events'),\n        confirm: {\n          false: t('Are you sure you want to disable scrubbing IP addresses?'),\n        },\n      },\n      {\n        name: 'sensitiveFields',\n        type: 'string',\n        multiline: true,\n        autosize: true,\n        maxRows: 10,\n        rows: 1,\n        placeholder: t('email'),\n        label: t('Additional Sensitive Fields'),\n        help: t(\n          'Additional field names to match against when scrubbing data. Separate multiple entries with a newline'\n        ),\n        getValue: val => extractMultilineFields(val),\n        setValue: val => convertMultilineFieldValue(val),\n      },\n      {\n        name: 'safeFields',\n        type: 'string',\n        multiline: true,\n        autosize: true,\n        maxRows: 10,\n        rows: 1,\n        placeholder: t('business-email'),\n        label: t('Safe Fields'),\n        help: t(\n          'Field names which data scrubbers should ignore. Separate multiple entries with a newline'\n        ),\n        getValue: val => extractMultilineFields(val),\n        setValue: val => convertMultilineFieldValue(val),\n      },\n    ],\n  },\n] as JsonFormObject[];\n","import {Component, Fragment} from 'react';\nimport {RouteComponentProps} from 'react-router';\n\nimport {addErrorMessage} from 'app/actionCreators/indicator';\nimport ProjectActions from 'app/actions/projectActions';\nimport Link from 'app/components/links/link';\nimport SentryDocumentTitle from 'app/components/sentryDocumentTitle';\nimport projectSecurityAndPrivacyGroups from 'app/data/forms/projectSecurityAndPrivacyGroups';\nimport {t, tct} from 'app/locale';\nimport {Organization, Project} from 'app/types';\nimport Form from 'app/views/settings/components/forms/form';\nimport JsonForm from 'app/views/settings/components/forms/jsonForm';\nimport SettingsPageHeader from 'app/views/settings/components/settingsPageHeader';\n\nimport DataScrubbing from '../components/dataScrubbing';\n\nexport type ProjectSecurityAndPrivacyProps = RouteComponentProps<\n  {orgId: string; projectId: string},\n  {}\n> & {\n  organization: Organization;\n  project: Project;\n};\n\nclass ProjectSecurityAndPrivacy extends Component<ProjectSecurityAndPrivacyProps> {\n  handleUpdateProject = (data: Project) => {\n    // This will update our project global state\n    ProjectActions.updateSuccess(data);\n  };\n\n  render() {\n    const {organization, project} = this.props;\n    const initialData = project;\n    const projectSlug = project.slug;\n    const endpoint = `/projects/${organization.slug}/${projectSlug}/`;\n    const access = new Set(organization.access);\n    const features = new Set(organization.features);\n    const relayPiiConfig = project.relayPiiConfig;\n    const apiMethod = 'PUT';\n    const title = t('Security & Privacy');\n\n    return (\n      <Fragment>\n        <SentryDocumentTitle title={title} projectSlug={projectSlug} />\n        <SettingsPageHeader title={title} />\n        <Form\n          saveOnBlur\n          allowUndo\n          initialData={initialData}\n          apiMethod={apiMethod}\n          apiEndpoint={endpoint}\n          onSubmitSuccess={this.handleUpdateProject}\n          onSubmitError={() => addErrorMessage('Unable to save change')}\n        >\n          <JsonForm\n            additionalFieldProps={{organization}}\n            features={features}\n            disabled={!access.has('project:write')}\n            forms={projectSecurityAndPrivacyGroups}\n          />\n        </Form>\n        <DataScrubbing\n          additionalContext={\n            <span>\n              {tct(\n                'These rules can be configured at the organization level in [linkToOrganizationSecurityAndPrivacy].',\n                {\n                  linkToOrganizationSecurityAndPrivacy: (\n                    <Link to={`/settings/${organization.slug}/security-and-privacy/`}>\n                      {title}\n                    </Link>\n                  ),\n                }\n              )}\n            </span>\n          }\n          endpoint={endpoint}\n          relayPiiConfig={relayPiiConfig}\n          disabled={!access.has('project:write')}\n          organization={organization}\n          projectId={project.id}\n          onSubmitSuccess={this.handleUpdateProject}\n        />\n      </Fragment>\n    );\n  }\n}\n\nexport default ProjectSecurityAndPrivacy;\n"],"sourceRoot":""}