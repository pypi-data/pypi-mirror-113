(()=>{"use strict";var e,t,r,n={37077:(e,t,r)=>{var n,a=r(63025),o=r(32735),i=r(12788),l=r(89178),s=r(28995);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){(0,l.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}(n=window).setupCategoryDisplaySubcatList=function(){const e=$(".category-list").data("subcat-info-url");void 0!==e&&$.ajax({url:e,dataType:"json",success(e){Object.entries(e.event_counts).forEach((e=>{let[t,r]=e;const n=r.value?s.$T.ngettext("{0} event","{0} events",r.value).format(r.pretty):s.$T.gettext("empty");$(`#category-event-count-${t}`).text(n)}))}})},n.setupCategoryDisplayEventList=function(e,t,r,n){const a=$(".event-list"),o=a.find(".future-events"),i=a.find(".past-events");function l(e,t){const r=$(e),a=r.find(".events");function o(e){r.find(".js-hide-message").toggle(e),r.find(".js-show-message").toggle(!e)}function i(e){r.find(".js-toggle-list").toggle(!e),r.find(".js-spinner").toggle(e)}o(!a.is(":empty")),i(!1),r.find(".js-toggle-list").on("click",(function(e,r){let l;e.preventDefault(),a.is(":empty")?(l=!0,i(!0),$.ajax({url:a.data("event-list-url"),data:u({before:a.data("event-list-before"),after:a.data("event-list-after")},n),error:handleAjaxError,success(e){a.html(e.html),a.show(),o(!0),i(!1)}})):a.is(":visible")?(l=!1,a.hide(),o(!1)):(l=!0,a.show(),o(!0)),!r&&t&&t(l)}))}r&&(n.flat=1),l(o,(function(e){r||$.ajax({url:a.data("show-future-events-url"),method:e?"PUT":"DELETE",error:handleAjaxError})})),l(i,(function(e){r||$.ajax({url:a.data("show-past-events-url"),method:e?"PUT":"DELETE",error:handleAjaxError})})),e&&!r&&o.find(".js-toggle-list").first().trigger("click",!0),t&&!r&&i.find(".js-toggle-list").first().trigger("click",!0)},n.setupCategoryDisplay=function(){$(".fav-button").on("click",(function(){const e=$(this),t=e.hasClass("enabled");e.prop("disabled",!0),$.ajax({url:e.data("href"),method:t?"DELETE":"PUT",error:handleAjaxError,success(){e.toggleClass("enabled",!t)},complete(){e.prop("disabled",!1)}})})).qtip({hide:{fixed:!0,delay:500},content:{text(){const e=$(this);return e.hasClass("enabled")?s.$T.gettext("Remove from your favorites"):"<h3>{0}</h3><p>{1}</p>".format(s.$T.gettext("Add to your favorites"),s.$T.gettext('This will make events in this category visible on your <a href="{0}">Dashboard</a>.').format(e.data("favorites-href")))}}})};var d=r(72865),m=r(19306);document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector("#category-calendar-link");if(!e)return;const t=e.dataset.categoryId;i.render(o.createElement(d.Os,{endpoint:"categories.export_ical",params:{category_id:t},renderButton:e=>o.createElement(d.Lp,{icon:"calendar",classes:e}),options:[{key:"category",text:m.vN.string("Category"),extraParams:{}}]}),e)}));var f=r(50340),g=r(6350),p=r(53806),y=r.n(p),v=r(60216),b=r.n(v),h=r(3047),E=r(41612),_=r(34598),j=r(19855),O=r(53130),x=r(25899),Z=r(4925),D=r(43146);const w=o.createContext(null),C=a.ZP.bind(null,{endpoint:"categories.statistics_json",rules:[{args:["category_id"],converters:{category_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"statistics.json",isDynamic:!1}]}]},"/");function N(e){let{categoryId:t}=e;const{data:r,loading:n}=(0,D.K3)({url:C({category_id:t}),camelize:!0,trigger:t});return n?o.createElement(E.Z,{size:"massive",active:!0}):r?o.createElement(P,{data:r}):null}function P(e){let{data:t}=e;const r=(0,o.useContext)(w).replace("_","-"),n=y().utc(t.updated).local().format("LLL"),a=new Intl.NumberFormat(r),i=a.format(t.totalEvents),l=a.format(t.totalContributions),s=a.format(t.files),c=a.format(t.users),{eventGraph:u,contributionsGraph:d,series:f,axes:g,tooltip:p}=(0,o.useMemo)((()=>function(e){const t=t=>{const r=parseInt(Object.keys(t).reverse().find((t=>t<=e.maxYear+3)),10);return[[y()(e.minYear-1,"YYYY"),null],...Object.entries(t).filter((t=>{let[n]=t;return n<=r&&n>=e.minYear})).map((e=>{let[t,r]=e;return[y()(t,"YYYY"),r]})),[y()(r+1,"YYYY"),null]]};return{eventGraph:[{label:m.vN.string("Events"),data:t(e.events)}],contributionsGraph:[{label:m.vN.string("Contributions"),data:t(e.contributions)}],series:{type:"bar"},axes:[{primary:!0,type:"time",position:"bottom"},{type:"linear",position:"left"}],tooltip:{align:"left",anchor:"left"}}}(t)),[t]);return o.createElement(_.Z,null,o.createElement(j.Z.Group,{horizontal:!0},o.createElement(j.Z,null,o.createElement(O.Z,{as:"h2"},o.createElement(O.Z.Content,null,o.createElement(m.vN,null,"Number of events"),o.createElement(O.Z.Subheader,null,o.createElement(m.vN,null,"The year is the one of the start date of the event.")))),o.createElement(j.Z,{basic:!0},0===u[0].data.length?o.createElement(x.Z,{info:!0},o.createElement(m.vN,null,"No data available")):o.createElement("div",{className:"categories-client-js-components-___CategoryStatistics-module__chart-container___k7Hc3"},o.createElement(h.Chart,{className:"categories-client-js-components-___CategoryStatistics-module__chart___33CDu",data:u,series:f,axes:g,tooltip:p})))),o.createElement(j.Z,null,o.createElement(O.Z,{as:"h2"},o.createElement(O.Z.Content,null,o.createElement(m.vN,null,"Number of contributions"),o.createElement(O.Z.Subheader,null,o.createElement(m.vN,null,"The year is the one of the start date of the contribution.")))),o.createElement(j.Z,{basic:!0},0===d[0].data.length?o.createElement(x.Z,{info:!0},o.createElement(m.vN,null,"No data available")):o.createElement("div",{className:"categories-client-js-components-___CategoryStatistics-module__chart-container___k7Hc3"},o.createElement(h.Chart,{className:"categories-client-js-components-___CategoryStatistics-module__chart___33CDu",data:d,series:f,axes:g,tooltip:p}))))),o.createElement(j.Z.Group,{horizontal:!0},o.createElement(j.Z,{inverted:!0,color:"blue",textAlign:"center"},o.createElement(Z.Z,{inverted:!0},o.createElement(Z.Z.Value,null,i),o.createElement(Z.Z.Label,null,o.createElement(m.vN,null,"Total number of events")))),o.createElement(j.Z,{inverted:!0,color:"blue",textAlign:"center"},o.createElement(Z.Z,{inverted:!0},o.createElement(Z.Z.Value,null,l),o.createElement(Z.Z.Label,null,o.createElement(m.vN,null,"Total number of contributions")))),o.createElement(j.Z,{inverted:!0,color:"blue",textAlign:"center"},o.createElement(Z.Z,{inverted:!0},o.createElement(Z.Z.Value,null,s),o.createElement(Z.Z.Label,null,o.createElement(m.vN,null,"Number of attachments")))),void 0!==t.users&&o.createElement(j.Z,{inverted:!0,color:"blue",textAlign:"center"},o.createElement(Z.Z,{inverted:!0},o.createElement(Z.Z.Value,null,c),o.createElement(Z.Z.Label,null,o.createElement(m.vN,null,"Number of users"))))),o.createElement(m.vN,null,"Last updated on: ",o.createElement(m.dO,{name:"time",value:n})))}N.propTypes={categoryId:b().number.isRequired},P.propTypes={data:b().shape({contributions:b().object.isRequired,events:b().object.isRequired,files:b().number.isRequired,updated:b().string.isRequired,users:b().number,totalEvents:b().number.isRequired,totalContributions:b().number.isRequired,minYear:b().number.isRequired,maxYear:b().number.isRequired}).isRequired};const T=a.ZP.bind(null,{endpoint:"search.category_search",rules:[{args:["category_id"],converters:{category_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"search",isDynamic:!1}]}]},"/"),L=a.ZP.bind(null,{endpoint:"search.search",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"search",isDynamic:!1},{data:"/",isDynamic:!1}]}]},"/");!function(e){document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector("#search-box");if(e){const t=JSON.parse(e.dataset.category),r=void 0!==e.dataset.isAdmin;i.render(o.createElement(f.Z,{onSearch:(e,n,a)=>{const o={q:e};r&&a&&(o.admin_override_enabled=!0),n?window.location=L(o):(o.category_id=t.id,window.location=T(o))},category:t,isAdmin:r}),e)}})),e.setupCategoryStats=function(){document.addEventListener("DOMContentLoaded",(async()=>{const e=document.querySelector("#category-stats-root");if(!e)return;const t=parseInt(e.dataset.categoryId,10),r=e.dataset.lang;await(0,g.z3)(r),i.render(o.createElement(w.Provider,{value:r},o.createElement(N,{categoryId:t})),e)}))}}(window)}},a={};function o(e){var t=a[e];if(void 0!==t)return t.exports;var r=a[e]={id:e,loaded:!1,exports:{}};return n[e].call(r.exports,r,r.exports,o),r.loaded=!0,r.exports}o.m=n,e=[],o.O=(t,r,n,a)=>{if(!r){var i=1/0;for(c=0;c<e.length;c++){for(var[r,n,a]=e[c],l=!0,s=0;s<r.length;s++)(!1&a||i>=a)&&Object.keys(o.O).every((e=>o.O[e](r[s])))?r.splice(s--,1):(l=!1,a<i&&(i=a));l&&(e.splice(c--,1),t=n())}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[r,n,a]},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},r=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,o.t=function(e,n){if(1&n&&(e=this(e)),8&n)return e;if("object"==typeof e&&e){if(4&n&&e.__esModule)return e;if(16&n&&"function"==typeof e.then)return e}var a=Object.create(null);o.r(a);var i={};t=t||[null,r({}),r([]),r(r)];for(var l=2&n&&e;"object"==typeof l&&!~t.indexOf(l);l=r(l))Object.getOwnPropertyNames(l).forEach((t=>i[t]=()=>e[t]));return i.default=()=>e,o.d(a,i),a},o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.e=()=>Promise.resolve(),o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),o.j=944,(()=>{var e={944:0};o.O.j=t=>0===e[t];var t=(t,r)=>{var n,a,[i,l,s]=r,c=0;for(n in l)o.o(l,n)&&(o.m[n]=l[n]);if(s)var u=s(o);for(t&&t(r);c<i.length;c++)a=i[c],o.o(e,a)&&e[a]&&e[a][0](),e[i[c]]=0;return o.O(u)},r=self.webpackChunk=self.webpackChunk||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var i=o.O(void 0,[5514,3044,8592],(()=>o(37077)));i=o.O(i)})();
//# sourceMappingURL=module_categories.bcd93c07.bundle.js.map